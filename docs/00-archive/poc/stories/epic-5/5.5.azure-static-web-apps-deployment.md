# Story 5.5: Azure Static Web Apps ç”Ÿç”¢éƒ¨ç½²

**Epic**: Epic 5 - Polish & Deployment
**Story ID**: 5.5
**Story åç¨±**: Azure Static Web Apps ç”Ÿç”¢éƒ¨ç½²
**å„ªå…ˆé †åº**: High
**é ä¼°æ™‚é–“**: 6 å°æ™‚
**ç‹€æ…‹**: Draft

---

## ğŸ“‹ Story æè¿°

### User Story
**As a** Product Owner
**I want** æ‡‰ç”¨ç¨‹å¼éƒ¨ç½²åˆ° Azure Static Web Apps ç”Ÿç”¢ç’°å¢ƒ
**So that** ä½¿ç”¨è€…å¯ä»¥é€éå…¬é–‹ URL å­˜å–æ‡‰ç”¨ç¨‹å¼ï¼Œä¸¦äº«æœ‰ Azure çš„å…¨çƒ CDN åŠ é€Ÿ

### Business Value
- **å…¨çƒå¯ç”¨æ€§**: Azure CDN æä¾›å…¨çƒä½å»¶é²å­˜å–ï¼ˆ<100msï¼‰
- **è‡ªå‹•åŒ–éƒ¨ç½²**: GitHub Actions CI/CD è‡ªå‹•éƒ¨ç½²ï¼Œç„¡éœ€æ‰‹å‹•æ“ä½œ
- **æˆæœ¬æ•ˆç›Š**: Static Web Apps Free tier è¶³å¤  POC ä½¿ç”¨ï¼ˆ100GB bandwidth/æœˆï¼‰
- **HTTPS æ”¯æ´**: è‡ªå‹•æä¾›å…è²» SSL æ†‘è­‰
- **Custom Domain**: æ”¯æ´è‡ªè¨‚ç¶²åŸŸï¼ˆæœªä¾†æ“´å±•ï¼‰

### Technical Context
- **Platform**: Azure Static Web Apps
- **Framework**: Next.js 14 (Static Export)
- **CI/CD**: GitHub Actions
- **CDN**: Azure å…¨çƒ CDN
- **API**: Azure Functions (Serverless, TTS API proxy)

---

## âœ… Acceptance Criteria

### Functional Requirements
1. **Azure Static Web Apps å»ºç«‹**:
   - [ ] åœ¨ Azure Portal å»ºç«‹ Static Web Apps è³‡æº
   - [ ] é¸æ“‡ Free tier
   - [ ] é€£çµ GitHub repository
   - [ ] è¨­å®š build configuration (Next.js)

2. **CI/CD Pipeline**:
   - [ ] GitHub Actions workflow è‡ªå‹•éƒ¨ç½²
   - [ ] Push to `main` è§¸ç™¼éƒ¨ç½²
   - [ ] Build æˆåŠŸå¾Œè‡ªå‹•ç™¼ä½ˆ
   - [ ] Preview URL é¡¯ç¤ºéƒ¨ç½²ç‹€æ…‹

3. **Environment Variables**:
   - [ ] Azure TTS API Key è¨­å®šåœ¨ Azure Portal
   - [ ] Next.js ç’°å¢ƒè®Šæ•¸æ­£ç¢ºè¼‰å…¥
   - [ ] ç”Ÿç”¢ç’°å¢ƒèˆ‡é–‹ç™¼ç’°å¢ƒåˆ†é›¢

4. **Production URL å¯å­˜å–**:
   - [ ] æ‡‰ç”¨ç¨‹å¼é€é Azure URL æ­£å¸¸é‹ä½œ
   - [ ] æ‰€æœ‰åŠŸèƒ½æ­£å¸¸ï¼ˆ3D Avatar, TTS, Lip Syncï¼‰
   - [ ] HTTPS æ­£å¸¸å•Ÿç”¨
   - [ ] å…¨çƒ CDN åŠ é€Ÿç”Ÿæ•ˆ

### Non-Functional Requirements
1. **éƒ¨ç½²é€Ÿåº¦**: Build + Deploy â‰¤ 5 åˆ†é˜
2. **å¯ç”¨æ€§**: Uptime â‰¥ 99.9%
3. **æ•ˆèƒ½**: Global latency â‰¤ 100ms
4. **æˆæœ¬**: Free tier ç¯„åœå…§ï¼ˆPOC éšæ®µï¼‰

---

## ğŸ—ï¸ Technical Design

### Azure Static Web Apps Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  GitHub Repository                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Push to main branch                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                       â”‚                                  â”‚
â”‚                       â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  GitHub Actions Workflow                          â”‚  â”‚
â”‚  â”‚  1. Checkout code                                 â”‚  â”‚
â”‚  â”‚  2. Install dependencies (npm install)            â”‚  â”‚
â”‚  â”‚  3. Build Next.js (npm run build)                 â”‚  â”‚
â”‚  â”‚  4. Deploy to Azure Static Web Apps               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Azure Static Web Apps                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Static Content (HTML, CSS, JS)                   â”‚  â”‚
â”‚  â”‚  - Next.js static export                          â”‚  â”‚
â”‚  â”‚  - Optimized bundles                              â”‚  â”‚
â”‚  â”‚  - Cached on Azure CDN                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Azure Functions (Optional)                       â”‚  â”‚
â”‚  â”‚  - TTS API proxy (hide API key)                   â”‚  â”‚
â”‚  â”‚  - Server-side logic                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Environment Variables                            â”‚  â”‚
â”‚  â”‚  - AZURE_TTS_API_KEY (secret)                     â”‚  â”‚
â”‚  â”‚  - NEXT_PUBLIC_API_URL                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Azure Global CDN                            â”‚
â”‚  - Edge locations worldwide                              â”‚
â”‚  - Automatic SSL/TLS                                     â”‚
â”‚  - <100ms latency globally                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
                   ğŸŒ End Users
```

### Next.js Static Export Configuration

```typescript
// next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: 'export', // Enable static export
  images: {
    unoptimized: true, // Required for static export
  },
  trailingSlash: true, // Better for static hosting
};

module.exports = nextConfig;
```

### GitHub Actions Workflow Structure

```yaml
name: Azure Static Web Apps CI/CD

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    steps:
      - Checkout code
      - Setup Node.js
      - Install dependencies
      - Build Next.js
      - Deploy to Azure
```

---

## ğŸ“ Tasks

### Task 1: è¨­å®š Next.js éœæ…‹åŒ¯å‡º

**æè¿°**: è¨­å®š Next.js ç‚ºéœæ…‹åŒ¯å‡ºæ¨¡å¼ï¼Œé©é… Azure Static Web Apps

**æª”æ¡ˆ**: `next.config.js`, `package.json`

**ç¨‹å¼ç¢¼å¯¦ä½œ (next.config.js)**:
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: 'export', // Enable static HTML export

  images: {
    unoptimized: true, // Disable Image Optimization API (not supported in static export)
  },

  trailingSlash: true, // Add trailing slash to all paths (better for static hosting)

  // Environment variables (client-side only with NEXT_PUBLIC_ prefix)
  env: {
    NEXT_PUBLIC_AZURE_TTS_REGION: process.env.NEXT_PUBLIC_AZURE_TTS_REGION || 'eastus',
  },

  // Disable server-side features not supported in static export
  reactStrictMode: true,
  swcMinify: true,
};

module.exports = nextConfig;
```

**ç¨‹å¼ç¢¼å¯¦ä½œ (package.json scripts)**:
```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "export": "next build && next export",
    "test": "jest",
    "test:e2e": "playwright test"
  }
}
```

**é©—è­‰éœæ…‹åŒ¯å‡º**:
```bash
# Build static export
npm run build

# Check output directory
ls -la out/

# Should see:
# - index.html
# - _next/ (static assets)
# - Static HTML pages
```

**é©—è­‰æ–¹å¼**:
- [ ] `npm run build` æˆåŠŸåŸ·è¡Œ
- [ ] `out/` ç›®éŒ„åŒ…å«éœæ…‹æª”æ¡ˆ
- [ ] ä½¿ç”¨ `npx serve out` æœ¬åœ°æ¸¬è©¦æ­£å¸¸
- [ ] æ‰€æœ‰é é¢å¯æ­£å¸¸å­˜å–

---

### Task 2: åœ¨ Azure Portal å»ºç«‹ Static Web Apps

**æè¿°**: åœ¨ Azure Portal å»ºç«‹ Static Web Apps è³‡æºä¸¦é€£çµ GitHub

**æ­¥é©Ÿ**:

1. **ç™»å…¥ Azure Portal**:
   - URL: https://portal.azure.com
   - ä½¿ç”¨ Microsoft å¸³è™Ÿç™»å…¥

2. **å»ºç«‹ Static Web Apps**:
   - é»æ“Šã€ŒCreate a resourceã€
   - æœå°‹ã€ŒStatic Web Appsã€
   - é»æ“Šã€ŒCreateã€

3. **åŸºæœ¬è¨­å®š**:
   ```
   Subscription: [Your Azure Subscription]
   Resource Group: smart-ai-avatar-rg (æ–°å»º)
   Name: smart-ai-avatar-app
   Plan Type: Free
   Region: East Asia (æˆ–å°±è¿‘å€åŸŸ)
   ```

4. **éƒ¨ç½²ç´°ç¯€**:
   ```
   Source: GitHub
   Organization: [Your GitHub Username]
   Repository: smart-ai-avatar-agent
   Branch: main
   Build Presets: Next.js
   ```

5. **Build è¨­å®š**:
   ```
   App location: /
   Api location: (ç•™ç©ºï¼Œæš«ä¸ä½¿ç”¨ Azure Functions)
   Output location: out
   ```

6. **é»æ“Šã€ŒReview + Createã€â†’ã€ŒCreateã€**

7. **ç­‰å¾…éƒ¨ç½²å®Œæˆ** (ç´„ 2-3 åˆ†é˜)

**é æœŸçµæœ**:
- Static Web Apps è³‡æºå»ºç«‹æˆåŠŸ
- GitHub repository è‡ªå‹•æ–°å¢ `.github/workflows/azure-static-web-apps-*.yml`
- é¡¯ç¤º Production URL (ä¾‹å¦‚: `https://gentle-sea-0a1b2c3d4.5.azurestaticapps.net`)

**é©—è­‰æ–¹å¼**:
- [ ] Azure Portal é¡¯ç¤º Static Web Apps è³‡æº
- [ ] GitHub repository å‡ºç¾ workflow æª”æ¡ˆ
- [ ] Production URL å¯å­˜å–ï¼ˆåˆæ¬¡éƒ¨ç½²å¯èƒ½éœ€ç­‰å¾…ï¼‰

---

### Task 3: è¨­å®š GitHub Actions Workflow

**æè¿°**: æª¢æŸ¥ä¸¦å„ªåŒ–è‡ªå‹•ç”Ÿæˆçš„ GitHub Actions workflow

**æª”æ¡ˆ**: `.github/workflows/azure-static-web-apps-<random-id>.yml`

**ç¨‹å¼ç¢¼å¯¦ä½œ**:
```yaml
name: Azure Static Web Apps CI/CD

on:
  push:
    branches:
      - main
  pull_request:
    types: [opened, synchronize, reopened, closed]
    branches:
      - main

jobs:
  build_and_deploy_job:
    if: github.event_name == 'push' || (github.event_name == 'pull_request' && github.event.action != 'closed')
    runs-on: ubuntu-latest
    name: Build and Deploy Job
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          submodules: true

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Run tests
        run: npm run test
        continue-on-error: false

      - name: Build Next.js
        run: npm run build
        env:
          NEXT_PUBLIC_AZURE_TTS_REGION: ${{ secrets.AZURE_TTS_REGION }}

      - name: Deploy to Azure Static Web Apps
        id: builddeploy
        uses: Azure/static-web-apps-deploy@v1
        with:
          azure_static_web_apps_api_token: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN }}
          repo_token: ${{ secrets.GITHUB_TOKEN }}
          action: "upload"
          app_location: "/"
          api_location: "" # Optional: Azure Functions location
          output_location: "out"

  close_pull_request_job:
    if: github.event_name == 'pull_request' && github.event.action == 'closed'
    runs-on: ubuntu-latest
    name: Close Pull Request Job
    steps:
      - name: Close Pull Request
        id: closepullrequest
        uses: Azure/static-web-apps-deploy@v1
        with:
          azure_static_web_apps_api_token: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN }}
          action: "close"
```

**å„ªåŒ–è¦é»**:
1. **æ–°å¢ Node.js ç‰ˆæœ¬æŒ‡å®š** (18.x)
2. **æ–°å¢ npm cache** (åŠ é€Ÿ build)
3. **æ–°å¢æ¸¬è©¦æ­¥é©Ÿ** (ç¢ºä¿å“è³ª)
4. **æ–°å¢ç’°å¢ƒè®Šæ•¸å‚³é** (NEXT_PUBLIC_*)

**é©—è­‰æ–¹å¼**:
- [ ] Push to main è§¸ç™¼ workflow
- [ ] Build æ­¥é©ŸæˆåŠŸ
- [ ] Deploy æ­¥é©ŸæˆåŠŸ
- [ ] Production URL æ›´æ–°

---

### Task 4: è¨­å®š Azure Environment Variables

**æè¿°**: åœ¨ Azure Portal è¨­å®šç’°å¢ƒè®Šæ•¸ï¼ˆAPI Keys, Secretsï¼‰

**æ­¥é©Ÿ**:

1. **å‰å¾€ Static Web Apps è³‡æº**:
   - Azure Portal â†’ Resource Groups â†’ smart-ai-avatar-rg
   - é»æ“Š smart-ai-avatar-app

2. **è¨­å®š Environment Variables**:
   - å·¦å´é¸å–® â†’ Configuration
   - é»æ“Šã€ŒApplication settingsã€
   - æ–°å¢ä»¥ä¸‹è®Šæ•¸:

   ```
   Name: AZURE_TTS_API_KEY
   Value: [Your Azure Speech Service Key]

   Name: NEXT_PUBLIC_AZURE_TTS_REGION
   Value: eastus (æˆ–æ‚¨çš„å€åŸŸ)
   ```

3. **å„²å­˜è¨­å®š**:
   - é»æ“Šã€ŒSaveã€
   - ç­‰å¾…è¨­å®šå¥—ç”¨

4. **é‡æ–°éƒ¨ç½²**:
   - è¿”å› GitHub repository
   - è§¸ç™¼é‡æ–°éƒ¨ç½²ï¼ˆæ¨é€ commit æˆ–æ‰‹å‹• triggerï¼‰

**å®‰å…¨æ€§æ³¨æ„äº‹é …**:
- âš ï¸ **ä¸è¦** å°‡ API Key å¯«å…¥ç¨‹å¼ç¢¼
- âš ï¸ **ä¸è¦** å°‡ Secrets æäº¤åˆ° GitHub
- âœ… ä½¿ç”¨ `NEXT_PUBLIC_` prefix çš„è®Šæ•¸æœƒæ‰“åŒ…åˆ°å‰ç«¯ï¼ˆåƒ…ç”¨æ–¼éæ•æ„Ÿè³‡è¨Šï¼‰
- âœ… ç„¡ `NEXT_PUBLIC_` prefix çš„è®Šæ•¸åƒ…åœ¨ build time å¯ç”¨

**API Key å®‰å…¨æ–¹æ¡ˆ** (POC vs Production):

**POC éšæ®µ** (ç›®å‰):
```typescript
// ç›´æ¥åœ¨å‰ç«¯å‘¼å« Azure TTS API (API Key æš´éœ²é¢¨éšª)
const response = await fetch(
  `https://${region}.tts.speech.microsoft.com/cognitiveservices/v1`,
  {
    headers: {
      'Ocp-Apim-Subscription-Key': process.env.NEXT_PUBLIC_AZURE_TTS_API_KEY,
    },
  }
);
```

**Production éšæ®µ** (å»ºè­°):
```typescript
// é€é Azure Functions proxy éš±è— API Key
const response = await fetch('/api/tts', {
  method: 'POST',
  body: JSON.stringify({ text: 'Hello' }),
});

// Azure Functions (api/tts.ts) åœ¨ server-side å‘¼å« Azure TTS
// API Key å„²å­˜åœ¨ Azure Functions App Settingsï¼Œä¸æš´éœ²çµ¦å‰ç«¯
```

**é©—è­‰æ–¹å¼**:
- [ ] Environment variables æ­£ç¢ºè¨­å®š
- [ ] æ‡‰ç”¨ç¨‹å¼å¯å­˜å–ç’°å¢ƒè®Šæ•¸
- [ ] TTS API æ­£å¸¸é‹ä½œ
- [ ] ç„¡ API Key æš´éœ²åœ¨å‰ç«¯ bundleï¼ˆæª¢æŸ¥ Network tabï¼‰

---

### Task 5: é©—è­‰ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²

**æè¿°**: å®Œæ•´æ¸¬è©¦ç”Ÿç”¢ç’°å¢ƒåŠŸèƒ½

**æ¸¬è©¦æ¸…å–®**:

1. **å­˜å– Production URL**:
   ```
   URL: https://<your-app>.azurestaticapps.net
   ```

2. **åŠŸèƒ½æ¸¬è©¦**:
   - [ ] é¦–é æ­£å¸¸è¼‰å…¥
   - [ ] 3D Avatar æ­£å¸¸æ¸²æŸ“
   - [ ] TTS èªéŸ³ç”Ÿæˆæ­£å¸¸
   - [ ] Lip Sync å‹•ç•«åŒæ­¥
   - [ ] èŠå¤©ä»‹é¢äº’å‹•æ­£å¸¸
   - [ ] éŒ¯èª¤è™•ç†æ­£å¸¸ï¼ˆNetwork offline, API failï¼‰

3. **æ•ˆèƒ½æ¸¬è©¦**:
   - [ ] Lighthouse Score:
     - Performance: â‰¥80
     - Accessibility: â‰¥90
     - Best Practices: â‰¥90
     - SEO: â‰¥80
   - [ ] FPS â‰¥30 (3D scene)
   - [ ] First Contentful Paint â‰¤1.5s
   - [ ] Largest Contentful Paint â‰¤2.5s

4. **è·¨ç€è¦½å™¨æ¸¬è©¦**:
   - [ ] Chrome (Desktop + Mobile)
   - [ ] Safari (Desktop + iOS)
   - [ ] Edge
   - [ ] Firefox

5. **HTTPS é©—è­‰**:
   - [ ] HTTPS æ­£å¸¸å•Ÿç”¨
   - [ ] SSL æ†‘è­‰æœ‰æ•ˆ
   - [ ] ç„¡ Mixed Content è­¦å‘Š

6. **CDN é©—è­‰**:
   - [ ] æª¢æŸ¥ Response Headers:
     ```
     x-azure-ref: [CDN reference]
     x-cache: HIT (CDN cache ç”Ÿæ•ˆ)
     ```
   - [ ] å…¨çƒå»¶é² â‰¤100ms (ä½¿ç”¨ pingdom.com æ¸¬è©¦)

**é©—è­‰å·¥å…·**:
```bash
# Lighthouse CI
npm install -g @lhci/cli
lhci autorun --collect.url=https://<your-app>.azurestaticapps.net

# Check HTTPS
curl -I https://<your-app>.azurestaticapps.net

# Check CDN headers
curl -I https://<your-app>.azurestaticapps.net | grep x-azure
```

**é©—è­‰æ–¹å¼**:
- [ ] æ‰€æœ‰åŠŸèƒ½æ¸¬è©¦é€šé
- [ ] Lighthouse Score é”æ¨™
- [ ] è·¨ç€è¦½å™¨æ¸¬è©¦é€šé
- [ ] HTTPS èˆ‡ CDN æ­£å¸¸é‹ä½œ

---

### Task 6: è¨­å®š Custom Domain (Optional)

**æè¿°**: è¨­å®šè‡ªè¨‚ç¶²åŸŸï¼ˆå¦‚ avatar.example.comï¼‰

**æ­¥é©Ÿ**:

1. **è³¼è²·ç¶²åŸŸ** (å¦‚æœå°šæœªæ“æœ‰):
   - ä½¿ç”¨ Namecheap, GoDaddy, Google Domains ç­‰

2. **åœ¨ Azure Portal æ–°å¢ Custom Domain**:
   - Static Web Apps â†’ Custom domains
   - é»æ“Šã€ŒAddã€
   - è¼¸å…¥ç¶²åŸŸåç¨±: `avatar.example.com`
   - é¸æ“‡é©—è­‰æ–¹å¼: CNAME or TXT record

3. **è¨­å®š DNS Records**:
   ```
   Type: CNAME
   Name: avatar
   Value: <your-app>.azurestaticapps.net
   TTL: 3600
   ```

4. **é©—è­‰ç¶²åŸŸ**:
   - è¿”å› Azure Portal
   - é»æ“Šã€ŒValidateã€
   - ç­‰å¾… DNS propagation (æœ€å¤š 48 å°æ™‚)

5. **å•Ÿç”¨ HTTPS**:
   - Azure è‡ªå‹•æä¾›å…è²» SSL æ†‘è­‰
   - ç­‰å¾…æ†‘è­‰é…ç½®å®Œæˆ (ç´„ 5-10 åˆ†é˜)

**é©—è­‰æ–¹å¼**:
- [ ] Custom domain æ­£å¸¸è§£æ
- [ ] HTTPS æ­£å¸¸å•Ÿç”¨
- [ ] æ‡‰ç”¨ç¨‹å¼é€é custom domain å¯å­˜å–

---

### Task 7: å»ºç«‹éƒ¨ç½²æ–‡ä»¶

**æè¿°**: æ’°å¯«éƒ¨ç½²æµç¨‹æ–‡ä»¶ï¼Œä¾›åœ˜éšŠåƒè€ƒ

**æª”æ¡ˆ**: `docs/deployment/azure-static-web-apps.md`

**ç¨‹å¼ç¢¼å¯¦ä½œ**:
```markdown
# Azure Static Web Apps éƒ¨ç½²æŒ‡å—

## å‰ç½®éœ€æ±‚

- Azure å¸³è™Ÿï¼ˆå…è²»è©¦ç”¨æˆ–ä»˜è²»ï¼‰
- GitHub å¸³è™Ÿ
- Node.js 18+
- Azure CLI (optional)

---

## é¦–æ¬¡éƒ¨ç½²æµç¨‹

### 1. è¨­å®š Next.js éœæ…‹åŒ¯å‡º

ç·¨è¼¯ `next.config.js`:
\`\`\`javascript
const nextConfig = {
  output: 'export',
  images: { unoptimized: true },
  trailingSlash: true,
};
module.exports = nextConfig;
\`\`\`

### 2. åœ¨ Azure Portal å»ºç«‹ Static Web Apps

1. å‰å¾€ https://portal.azure.com
2. å»ºç«‹ Static Web Apps è³‡æº:
   - Name: smart-ai-avatar-app
   - Plan: Free
   - Region: East Asia
   - Source: GitHub
   - Repository: smart-ai-avatar-agent
   - Branch: main
   - Build Preset: Next.js
   - Output location: out

3. é»æ“Šã€ŒCreateã€ä¸¦ç­‰å¾…éƒ¨ç½²å®Œæˆ

### 3. è¨­å®š Environment Variables

1. Azure Portal â†’ Static Web Apps â†’ Configuration
2. æ–°å¢ Application settings:
   \`\`\`
   AZURE_TTS_API_KEY: [Your Azure Speech Key]
   NEXT_PUBLIC_AZURE_TTS_REGION: eastus
   \`\`\`

### 4. é©—è­‰éƒ¨ç½²

1. å–å¾— Production URL (ä¾‹å¦‚: `https://gentle-sea-xyz.azurestaticapps.net`)
2. æ¸¬è©¦æ‰€æœ‰åŠŸèƒ½:
   - 3D Avatar æ¸²æŸ“
   - TTS èªéŸ³ç”Ÿæˆ
   - Lip Sync å‹•ç•«
3. åŸ·è¡Œ Lighthouse æ¸¬è©¦

---

## æ—¥å¸¸éƒ¨ç½²æµç¨‹

### è‡ªå‹•éƒ¨ç½² (æ¨è–¦)

Push to `main` branch è‡ªå‹•è§¸ç™¼éƒ¨ç½²:
\`\`\`bash
git add .
git commit -m "feat: add new feature"
git push origin main
\`\`\`

GitHub Actions è‡ªå‹•åŸ·è¡Œ:
1. Install dependencies
2. Run tests
3. Build Next.js
4. Deploy to Azure

### æ‰‹å‹•éƒ¨ç½²

ä½¿ç”¨ Azure CLI:
\`\`\`bash
# å®‰è£ Azure CLI
npm install -g @azure/static-web-apps-cli

# ç™»å…¥
az login

# éƒ¨ç½²
swa deploy --app-name smart-ai-avatar-app
\`\`\`

---

## ç’°å¢ƒç®¡ç†

### Production Environment
- Branch: `main`
- URL: https://<app-name>.azurestaticapps.net
- Auto-deploy: Enabled

### Staging Environment (Optional)
- Branch: `develop`
- URL: https://<app-name>-staging.azurestaticapps.net
- Auto-deploy: Enabled

### Preview Environments
- Pull Requests è‡ªå‹•å»ºç«‹ preview URLs
- URL æ ¼å¼: `https://<app-name>-<pr-number>.azurestaticapps.net`

---

## ç›£æ§èˆ‡é™¤éŒ¯

### æŸ¥çœ‹éƒ¨ç½²æ—¥èªŒ

1. GitHub â†’ Actions â†’ æœ€æ–° workflow run
2. å±•é–‹ "Build and Deploy Job"
3. æª¢æŸ¥å„æ­¥é©Ÿæ—¥èªŒ

### æŸ¥çœ‹æ‡‰ç”¨ç¨‹å¼æ—¥èªŒ

Azure Portal â†’ Static Web Apps â†’ Logs (Application Insights)

### å¸¸è¦‹å•é¡Œ

**Q: Build å¤±æ•—ï¼Œé¡¯ç¤º "Module not found"**
A: æª¢æŸ¥ `package.json` dependencies æ˜¯å¦å®Œæ•´ï¼ŒåŸ·è¡Œ `npm ci` ç¢ºä¿æœ¬åœ°å¯ build

**Q: éƒ¨ç½²æˆåŠŸä½†é é¢ç©ºç™½**
A: æª¢æŸ¥ `output_location` æ˜¯å¦è¨­å®šç‚º `out`ï¼Œç¢ºèª `next.config.js` æœ‰ `output: 'export'`

**Q: TTS API ç„¡æ³•å‘¼å«**
A: æª¢æŸ¥ Azure Portal â†’ Configuration â†’ Application settingsï¼Œç¢ºèª `AZURE_TTS_API_KEY` å·²è¨­å®š

**Q: CORS éŒ¯èª¤**
A: Azure Static Web Apps é è¨­æ”¯æ´ CORSï¼Œæª¢æŸ¥ API endpoint æ˜¯å¦æ­£ç¢º

---

## æˆæœ¬ä¼°ç®—

### Free Tier é™åˆ¶
- 100 GB bandwidth/æœˆ
- 2 custom domains
- Staging environments: 3

### é ä¼°æˆæœ¬ (POC éšæ®µ)
- Static Web Apps: NT$ 0 (Free tier)
- Azure TTS API: ~NT$ 100/æœˆ (ä»¥ 10,000 requests è¨ˆ)
- **Total: ~NT$ 100/æœˆ**

### å‡ç´šè‡³ Standard (ç”Ÿç”¢ç’°å¢ƒ)
- Static Web Apps Standard: NT$ 270/æœˆ
- ç„¡ bandwidth é™åˆ¶
- Unlimited custom domains
- æ›´å¤š staging environments

---

## å®‰å…¨æ€§æœ€ä½³å¯¦è¸

1. **API Key ç®¡ç†**:
   - âš ï¸ ä¸è¦å°‡ API Key å¯«å…¥ç¨‹å¼ç¢¼
   - âœ… ä½¿ç”¨ Azure Portal Application settings
   - âœ… ä½¿ç”¨ GitHub Secrets for CI/CD

2. **HTTPS**:
   - âœ… Azure è‡ªå‹•å•Ÿç”¨ HTTPS
   - âœ… å®šæœŸæª¢æŸ¥ SSL æ†‘è­‰æœ‰æ•ˆæœŸ

3. **å­˜å–æ§åˆ¶**:
   - âœ… è¨­å®š Azure RBAC (Role-Based Access Control)
   - âœ… é™åˆ¶ GitHub repository å­˜å–æ¬Šé™

---

## å›æ»¾ (Rollback)

### æ–¹æ³• 1: GitHub Revert
\`\`\`bash
# Revert æœ€æ–° commit
git revert HEAD
git push origin main
\`\`\`

### æ–¹æ³• 2: Azure Portal
1. Static Web Apps â†’ Deployments
2. é¸æ“‡å…ˆå‰çš„æˆåŠŸéƒ¨ç½²
3. é»æ“Šã€ŒActivateã€

---

## åƒè€ƒè³‡æ–™

- [Azure Static Web Apps å®˜æ–¹æ–‡ä»¶](https://learn.microsoft.com/azure/static-web-apps/)
- [Next.js Static Export](https://nextjs.org/docs/app/building-your-application/deploying/static-exports)
- [GitHub Actions for Azure](https://github.com/Azure/actions)
```

**é©—è­‰æ–¹å¼**:
- [ ] æ–‡ä»¶å…§å®¹å®Œæ•´æ¸…æ™°
- [ ] æ­¥é©Ÿå¯é‡ç¾åŸ·è¡Œ
- [ ] åŒ…å«æ•…éšœæ’é™¤æŒ‡å—
- [ ] åœ˜éšŠæˆå“¡å¯ä¾æ–‡ä»¶éƒ¨ç½²

---

### Task 8: è¨­å®š Monitoring èˆ‡ Alerts (Optional)

**æè¿°**: è¨­å®š Azure Application Insights ç›£æ§æ‡‰ç”¨ç¨‹å¼å¥åº·åº¦

**æ­¥é©Ÿ**:

1. **å•Ÿç”¨ Application Insights**:
   - Azure Portal â†’ Static Web Apps â†’ Application Insights
   - é»æ“Šã€ŒEnableã€
   - é¸æ“‡æˆ–å»ºç«‹ Application Insights resource

2. **è¨­å®š Alerts**:
   - Application Insights â†’ Alerts
   - å»ºç«‹ Alert rule:
     ```
     Condition: Failed requests > 10 in 5 minutes
     Action: Send email to admin
     ```

3. **æŸ¥çœ‹ Metrics**:
   - Application Insights â†’ Metrics
   - å¯æŸ¥çœ‹:
     - Request count
     - Response time
     - Failed requests
     - Availability

4. **è¨­å®š Availability Test**:
   - Application Insights â†’ Availability
   - å»ºç«‹ URL ping test:
     ```
     Test name: Homepage availability
     URL: https://<your-app>.azurestaticapps.net
     Frequency: 5 minutes
     Locations: 5 global locations
     ```

**é©—è­‰æ–¹å¼**:
- [ ] Application Insights æ­£å¸¸æ”¶é›†è³‡æ–™
- [ ] Alerts å¯æ­£å¸¸è§¸ç™¼
- [ ] Availability test æ­£å¸¸åŸ·è¡Œ
- [ ] Metrics dashboard é¡¯ç¤ºæ­£å¸¸

---

## ğŸ“Š Dev Notes

### Static Export Limitations

**ä¸æ”¯æ´çš„ Next.js åŠŸèƒ½**:
- âŒ Server-Side Rendering (SSR)
- âŒ API Routes (`pages/api/*`)
- âŒ Image Optimization API
- âŒ Incremental Static Regeneration (ISR)
- âŒ Dynamic routes with `getServerSideProps`

**æ”¯æ´çš„åŠŸèƒ½**:
- âœ… Static Site Generation (SSG)
- âœ… Client-Side Rendering (CSR)
- âœ… Dynamic routes with `getStaticPaths`
- âœ… Client-side data fetching
- âœ… All React features

**æœ¬å°ˆæ¡ˆä½¿ç”¨**:
- âœ… Static pages (SSG)
- âœ… Client-side data fetching (TTS API)
- âœ… Client-side 3D rendering (Three.js)

### Azure Static Web Apps vs Vercel

| Feature | Azure SWA | Vercel |
|---------|-----------|--------|
| **Pricing (Free)** | 100GB/æœˆ | 100GB/æœˆ |
| **Build Minutes** | Unlimited | 6000 min/æœˆ |
| **Custom Domains** | 2 (Free) | Unlimited |
| **SSR Support** | Limited (Functions) | âœ… Full |
| **Global CDN** | âœ… Azure CDN | âœ… Vercel Edge |
| **CI/CD** | GitHub Actions | Built-in |
| **Learning Curve** | Medium | Easy |

**ç‚ºä½•é¸æ“‡ Azure**:
- âœ… Azure ecosystem integration (TTS API åŒå¹³å°)
- âœ… Free tier è¶³å¤  POC
- âœ… ä¼æ¥­ç´šå®‰å…¨æ€§èˆ‡åˆè¦æ€§
- âœ… GitHub Actions éˆæ´»æ€§é«˜

**ä½•æ™‚é¸æ“‡ Vercel**:
- éœ€è¦ SSR/ISR
- æ›´ç°¡å–®çš„éƒ¨ç½²æµç¨‹
- ä¸éœ€è¦ Azure æ•´åˆ

### Environment Variables Best Practices

**å‰ç«¯å¯è¦‹è®Šæ•¸** (NEXT_PUBLIC_*):
```typescript
// âœ… å¯ä»¥æš´éœ²çµ¦å‰ç«¯
NEXT_PUBLIC_API_URL=https://api.example.com
NEXT_PUBLIC_REGION=eastus

// ä½¿ç”¨
const apiUrl = process.env.NEXT_PUBLIC_API_URL;
```

**å¾Œç«¯å°ˆç”¨è®Šæ•¸**:
```typescript
// âš ï¸ ä¸æ‡‰æš´éœ²çµ¦å‰ç«¯
AZURE_TTS_API_KEY=xxx
DATABASE_CONNECTION_STRING=xxx

// åƒ…åœ¨ build time å¯ç”¨ (ä¸æœƒæ‰“åŒ…åˆ°å‰ç«¯)
const apiKey = process.env.AZURE_TTS_API_KEY;
```

**å®‰å…¨æ–¹æ¡ˆæ¼”é€²**:

**POC éšæ®µ** (å¯æ¥å—æš´éœ² API Key):
- API Key ä½¿ç”¨ `NEXT_PUBLIC_*` prefix
- è¨­å®š Azure TTS API å­˜å–é™åˆ¶ (IP whitelist)
- ç›£æ§ API ä½¿ç”¨é‡

**Production éšæ®µ** (å»ºè­°):
- å»ºç«‹ Azure Functions proxy
- API Key å„²å­˜åœ¨ Azure Functions App Settings
- å‰ç«¯åƒ…å‘¼å« `/api/tts` endpoint

### CI/CD Optimization

**åŠ é€Ÿ Build æŠ€å·§**:

1. **npm cache**:
   ```yaml
   - uses: actions/setup-node@v3
     with:
       cache: 'npm'
   ```

2. **Dependency caching**:
   ```yaml
   - uses: actions/cache@v3
     with:
       path: ~/.npm
       key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
   ```

3. **Parallel testing**:
   ```yaml
   - run: npm run test -- --maxWorkers=2
   ```

4. **Skip redundant steps**:
   ```yaml
   - run: npm run build
     if: github.event_name == 'push'
   ```

**é æœŸæ•ˆæœ**:
- Build time: 5 min â†’ 3 min (-40%)
- Deploy time: 2 min â†’ 1.5 min (-25%)

---

## ğŸ§ª Testing Strategy

### Pre-Deployment Testing

**Local Testing**:
```bash
# Build static export
npm run build

# Test with local server
npx serve out

# Open http://localhost:3000
# Test all features
```

**Staging Testing**:
```bash
# Create staging branch
git checkout -b staging

# Push to staging (creates preview URL)
git push origin staging

# Test on preview URL
```

### Post-Deployment Testing

**Smoke Tests** (å¿«é€Ÿé©—è­‰):
- [ ] Homepage loads
- [ ] 3D Avatar renders
- [ ] TTS API responds
- [ ] No console errors

**Full Regression Tests**:
- [ ] Execute Playwright E2E tests against production URL
```bash
PLAYWRIGHT_BASE_URL=https://<your-app>.azurestaticapps.net npm run test:e2e
```

**Performance Tests**:
```bash
# Lighthouse CI
lhci autorun --collect.url=https://<your-app>.azurestaticapps.net

# Expected scores:
# Performance: â‰¥80
# Accessibility: â‰¥90
# Best Practices: â‰¥90
# SEO: â‰¥80
```

---

## ğŸ“ˆ Success Metrics

### é‡åŒ–æŒ‡æ¨™

1. **éƒ¨ç½²æˆåŠŸç‡**: â‰¥95% (è‡ªå‹•éƒ¨ç½²)
2. **Build æ™‚é–“**: â‰¤5 åˆ†é˜
3. **Uptime**: â‰¥99.9%
4. **Global Latency**: â‰¤100ms (CDN)
5. **Lighthouse Performance**: â‰¥80

### è³ªåŒ–æŒ‡æ¨™

1. **é–‹ç™¼è€…é«”é©—**: "Push to deploy æµç¨‹é †æš¢"
2. **ä½¿ç”¨è€…é«”é©—**: "å…¨çƒå­˜å–é€Ÿåº¦å¿«ï¼Œç„¡å»¶é²"
3. **ç¶­è­·æ€§**: "å›æ»¾èˆ‡ç›£æ§æ©Ÿåˆ¶å®Œå–„"

---

## ğŸ”— Dependencies

### Epic Dependencies
- **Depends on**:
  - All Epic 2-4 Stories (å®Œæ•´åŠŸèƒ½æ‰å¯éƒ¨ç½²)
  - Story 5.1 (Performance optimization)
  - Story 5.4 (Browser compatibility)

### Story Dependencies
- **Must Complete Before**:
  - Story 5.6 (Technical Validation) - ç”Ÿç”¢ç’°å¢ƒæ¸¬è©¦çµæœ
  - Story 5.7 (Documentation) - éƒ¨ç½²æ–‡ä»¶

### External Dependencies
- Azure account with active subscription
- GitHub repository with Actions enabled
- Azure Speech Service API Key
- Node.js 18+

---

## ğŸ“¦ Deliverables

1. **Configuration**:
   - `next.config.js` (static export) âœ…
   - `.github/workflows/azure-static-web-apps-*.yml` âœ…

2. **Azure Resources**:
   - Static Web Apps resource (smart-ai-avatar-app) âœ…
   - Application Insights (optional) âœ…

3. **Documentation**:
   - `docs/deployment/azure-static-web-apps.md` âœ…
   - Environment variables documentation âœ…

4. **Production URL**:
   - https://<your-app>.azurestaticapps.net âœ…

---

## âœ… Definition of Done

- [ ] Next.js è¨­å®šç‚ºéœæ…‹åŒ¯å‡ºæ¨¡å¼
- [ ] Azure Static Web Apps è³‡æºå»ºç«‹æˆåŠŸ
- [ ] GitHub Actions workflow æ­£å¸¸é‹ä½œ
- [ ] Environment variables æ­£ç¢ºè¨­å®š
- [ ] Production URL å¯å­˜å–ä¸”æ‰€æœ‰åŠŸèƒ½æ­£å¸¸
- [ ] HTTPS æ­£å¸¸å•Ÿç”¨
- [ ] Global CDN ç”Ÿæ•ˆï¼ˆx-azure-ref header å­˜åœ¨ï¼‰
- [ ] Lighthouse Performance score â‰¥80
- [ ] è·¨ç€è¦½å™¨æ¸¬è©¦é€šéï¼ˆChrome, Safari, Edge, Firefoxï¼‰
- [ ] Playwright E2E tests é€šéï¼ˆproduction URLï¼‰
- [ ] éƒ¨ç½²æ–‡ä»¶å®Œæ•´é½Šå…¨
- [ ] Monitoring è¨­å®šå®Œæˆï¼ˆApplication Insightsï¼‰
- [ ] Code review é€šé

---

## ğŸ“š References

- [Azure Static Web Apps Documentation](https://learn.microsoft.com/azure/static-web-apps/)
- [Next.js Static Export](https://nextjs.org/docs/app/building-your-application/deploying/static-exports)
- [GitHub Actions for Azure](https://github.com/Azure/static-web-apps-deploy)
- [Azure Static Web Apps CLI](https://azure.github.io/static-web-apps-cli/)
- [Application Insights](https://learn.microsoft.com/azure/azure-monitor/app/app-insights-overview)

---

**Story å»ºç«‹æ—¥æœŸ**: 2025-10-14
**æœ€å¾Œæ›´æ–°**: 2025-10-14
**INVEST Score**: â­â­â­â­â­â­ (6/6)
- âœ… Independent: å¯ç¨ç«‹é–‹ç™¼èˆ‡éƒ¨ç½²
- âœ… Negotiable: éƒ¨ç½²å¹³å°ã€Custom domain å¯é¸
- âœ… Valuable: å¯¦ç¾æ‡‰ç”¨ç¨‹å¼å…¬é–‹å­˜å–ï¼Œå±•ç¤º POC æˆæœ
- âœ… Estimable: 6 å°æ™‚é ä¼°æ™‚é–“åˆç†
- âœ… Small: ç¯„åœæ˜ç¢ºï¼Œå¯åœ¨ä¸€å€‹ Sprint å…§å®Œæˆ
- âœ… Testable: å¯é€é Production URL é©—è­‰æ‰€æœ‰åŠŸèƒ½
