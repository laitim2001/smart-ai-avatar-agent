# Story 5.3: UI/UX 細節打磨

**Epic**: Epic 5 - Polish & Deployment
**Story ID**: 5.3
**Story 名稱**: UI/UX 細節打磨
**優先順序**: Medium
**預估時間**: 7 小時
**狀態**: Draft

---

## 📋 Story 描述

### User Story
**As a** 使用者
**I want** 介面美觀、動畫流暢、互動細節完善
**So that** 我能享受專業級的應用程式體驗，而非半成品感覺

### Business Value
- **專業形象**: 精緻的 UI/UX 提升產品專業度，增強使用者信任
- **使用體驗**: 流暢的動畫與過渡效果讓應用程式感覺更快、更自然
- **細節完善**: 聚焦狀態、Hover 效果、過渡動畫等細節讓應用程式更精緻
- **品牌一致性**: 統一的設計語言與視覺風格建立品牌識別度

### Technical Context
- **CSS Transitions**: 使用 CSS transition 實現流暢的狀態過渡
- **Framer Motion**: 進階動畫庫，提供聲明式動畫 API
- **Responsive Design**: 適配 Desktop/Tablet/Mobile 三種裝置
- **Accessibility**: 確保動畫不影響鍵盤導航、screen reader

---

## ✅ Acceptance Criteria

### Functional Requirements
1. **聊天介面動畫**:
   - [ ] 訊息送出時有 Fade-in + Slide-up 動畫
   - [ ] 輸入框聚焦時有微妙的放大動畫（scale 1.02）
   - [ ] 送出按鈕 Hover 時顏色過渡流暢（300ms）
   - [ ] 訊息清單滾動平滑（smooth scroll behavior）

2. **Avatar 互動細節**:
   - [ ] Avatar 閒置時有微妙的呼吸動畫（Y 軸上下 0.02 單位）
   - [ ] Avatar 說話時有 Bounce 動畫
   - [ ] 3D 場景背景顏色可自訂（淺色/深色模式）
   - [ ] OrbitControls 阻尼效果（damping enabled）

3. **響應式設計**:
   - [ ] Desktop (≥1024px): 左右分欄佈局（Avatar 左側，Chat 右側）
   - [ ] Tablet (768-1023px): 上下佈局（Avatar 上方，Chat 下方）
   - [ ] Mobile (≤767px): 全螢幕 Avatar，Chat 浮動在底部
   - [ ] 所有斷點過渡流暢（無突然跳動）

4. **Accessibility**:
   - [ ] 所有互動元素聚焦時有明顯的 focus ring
   - [ ] 支援 `prefers-reduced-motion` 媒體查詢（動畫簡化）
   - [ ] 顏色對比度符合 WCAG AA 標準（≥4.5:1）
   - [ ] 鍵盤導航順序合理（Tab order）

### Non-Functional Requirements
1. **效能**: 動畫不影響 FPS，維持 ≥ 30 FPS
2. **流暢度**: 所有過渡動畫在 60 FPS 下播放
3. **載入時間**: UI 資源（CSS, fonts）≤ 50KB
4. **相容性**: 支援 Chrome, Edge, Safari, Firefox 最新版本

---

## 🏗️ Technical Design

### Animation Strategy

```
Animation Types:
┌─────────────────────────────────────────────────────┐
│ 1. Micro-Interactions (CSS Transitions)            │
│    - Button hover effects                          │
│    - Input focus states                            │
│    - Link underlines                               │
│    Duration: 200-300ms                             │
│    Easing: ease-in-out                             │
├─────────────────────────────────────────────────────┤
│ 2. UI Animations (Framer Motion)                   │
│    - Message fade-in/slide-up                      │
│    - Modal enter/exit                              │
│    - Toast notifications                           │
│    Duration: 300-500ms                             │
│    Easing: spring, easeOut                         │
├─────────────────────────────────────────────────────┤
│ 3. 3D Animations (Three.js useFrame)               │
│    - Avatar breathing animation                    │
│    - Avatar bounce on speech                       │
│    - Camera smooth follow                          │
│    Duration: Continuous loop                       │
│    Easing: Sine wave, damping                      │
└─────────────────────────────────────────────────────┘
```

### Responsive Breakpoints

```typescript
export const BREAKPOINTS = {
  mobile: 0,      // 0-767px
  tablet: 768,    // 768-1023px
  desktop: 1024,  // 1024px+
} as const;

// Tailwind CSS config
module.exports = {
  theme: {
    screens: {
      'sm': '640px',
      'md': '768px',
      'lg': '1024px',
      'xl': '1280px',
    },
  },
};
```

### Layout Patterns

**Desktop (≥1024px)**:
```
┌─────────────────────────────────────────────────┐
│                  Header                         │
├──────────────────────┬──────────────────────────┤
│                      │                          │
│   Avatar Canvas      │    Chat Interface        │
│   (50% width)        │    (50% width)           │
│                      │                          │
│   3D Scene           │    Messages              │
│   OrbitControls      │    Input Field           │
│                      │    Send Button           │
│                      │                          │
└──────────────────────┴──────────────────────────┘
```

**Mobile (≤767px)**:
```
┌─────────────────────────────────────────────────┐
│              Avatar Canvas                      │
│              (Full screen)                      │
│                                                 │
│              3D Scene                           │
│                                                 │
│                                                 │
├─────────────────────────────────────────────────┤
│    Chat Interface (Fixed bottom overlay)        │
│    Input Field | Send Button                    │
└─────────────────────────────────────────────────┘
```

---

## 📝 Tasks

### Task 1: 建立全域 CSS Variables 與 Design Tokens

**描述**: 定義設計系統的核心變數（顏色、間距、字型、過渡時間）

**檔案**: `src/styles/design-tokens.css`, `tailwind.config.ts`

**程式碼實作 (CSS Variables)**:
```css
/* src/styles/design-tokens.css */
:root {
  /* Colors - Primary */
  --color-primary: #007bff;
  --color-primary-hover: #0056b3;
  --color-primary-active: #004085;

  /* Colors - Neutral */
  --color-background: #ffffff;
  --color-surface: #f8f9fa;
  --color-border: #dee2e6;
  --color-text-primary: #212529;
  --color-text-secondary: #6c757d;

  /* Colors - Semantic */
  --color-success: #28a745;
  --color-error: #dc3545;
  --color-warning: #ffc107;
  --color-info: #17a2b8;

  /* Spacing */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;
  --spacing-2xl: 48px;

  /* Typography */
  --font-family-base: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-size-xs: 12px;
  --font-size-sm: 14px;
  --font-size-md: 16px;
  --font-size-lg: 18px;
  --font-size-xl: 24px;
  --font-weight-regular: 400;
  --font-weight-medium: 500;
  --font-weight-bold: 700;

  /* Border Radius */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  /* Shadows */
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
  --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.15);

  /* Transitions */
  --transition-fast: 150ms ease-in-out;
  --transition-base: 300ms ease-in-out;
  --transition-slow: 500ms ease-in-out;

  /* Z-Index */
  --z-dropdown: 1000;
  --z-sticky: 1020;
  --z-fixed: 1030;
  --z-modal-backdrop: 1040;
  --z-modal: 1050;
  --z-tooltip: 1070;
  --z-toast: 9999;
}

/* Dark Mode (optional for MVP, included for future) */
[data-theme='dark'] {
  --color-background: #1a1a1a;
  --color-surface: #2a2a2a;
  --color-border: #3a3a3a;
  --color-text-primary: #ffffff;
  --color-text-secondary: #aaaaaa;
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Global Styles */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: var(--font-family-base);
  font-size: var(--font-size-md);
  line-height: 1.5;
  color: var(--color-text-primary);
  background-color: var(--color-background);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Focus Styles */
:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

button:focus-visible,
input:focus-visible,
textarea:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* Smooth Scroll */
html {
  scroll-behavior: smooth;
}
```

**Tailwind Config**:
```typescript
// tailwind.config.ts
import type { Config } from 'tailwindcss';

const config: Config = {
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
    './src/app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          DEFAULT: 'var(--color-primary)',
          hover: 'var(--color-primary-hover)',
          active: 'var(--color-primary-active)',
        },
        neutral: {
          background: 'var(--color-background)',
          surface: 'var(--color-surface)',
          border: 'var(--color-border)',
        },
        text: {
          primary: 'var(--color-text-primary)',
          secondary: 'var(--color-text-secondary)',
        },
      },
      spacing: {
        xs: 'var(--spacing-xs)',
        sm: 'var(--spacing-sm)',
        md: 'var(--spacing-md)',
        lg: 'var(--spacing-lg)',
        xl: 'var(--spacing-xl)',
        '2xl': 'var(--spacing-2xl)',
      },
      borderRadius: {
        sm: 'var(--radius-sm)',
        md: 'var(--radius-md)',
        lg: 'var(--radius-lg)',
        full: 'var(--radius-full)',
      },
      boxShadow: {
        sm: 'var(--shadow-sm)',
        md: 'var(--shadow-md)',
        lg: 'var(--shadow-lg)',
        xl: 'var(--shadow-xl)',
      },
      transitionDuration: {
        fast: '150ms',
        base: '300ms',
        slow: '500ms',
      },
    },
  },
  plugins: [],
};

export default config;
```

**Import in Layout**:
```typescript
// src/app/layout.tsx
import '@/styles/design-tokens.css';
import '@/styles/globals.css';
```

**驗證方式**:
- [ ] CSS variables 正確載入（Chrome DevTools → Styles）
- [ ] Tailwind utilities 可正常使用（例如 `bg-primary`, `text-primary`）
- [ ] Dark mode 變數定義完整（未來擴展）
- [ ] Focus styles 在所有互動元素正確顯示

---

### Task 2: 聊天介面動畫（Framer Motion）

**描述**: 為 ChatInterface 加入訊息 Fade-in/Slide-up 動畫、輸入框 Focus 動畫

**檔案**: `src/components/chat/ChatInterface.tsx`

**安裝依賴**:
```bash
npm install framer-motion
```

**程式碼實作**:
```typescript
'use client';

import React, { useState, useRef, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

interface Message {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: number;
}

export function ChatInterface() {
  const [messages, setMessages] = useState<Message[]>([]);
  const [input, setInput] = useState('');
  const [isSending, setIsSending] = useState(false);
  const messagesEndRef = useRef<HTMLDivElement>(null);

  // Auto-scroll to bottom when new message
  useEffect(() => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  }, [messages]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!input.trim() || isSending) return;

    const userMessage: Message = {
      id: `user-${Date.now()}`,
      role: 'user',
      content: input,
      timestamp: Date.now(),
    };

    setMessages((prev) => [...prev, userMessage]);
    setInput('');
    setIsSending(true);

    // Simulate assistant response (replace with actual TTS logic)
    setTimeout(() => {
      const assistantMessage: Message = {
        id: `assistant-${Date.now()}`,
        role: 'assistant',
        content: `收到您的訊息: "${input}"`,
        timestamp: Date.now(),
      };
      setMessages((prev) => [...prev, assistantMessage]);
      setIsSending(false);
    }, 1500);
  };

  return (
    <div className="fixed bottom-0 right-0 w-full md:w-1/2 lg:w-1/2 h-screen md:h-auto lg:h-screen flex flex-col bg-white">
      {/* Messages Container */}
      <div className="flex-1 overflow-y-auto p-4 space-y-4">
        <AnimatePresence initial={false}>
          {messages.map((message) => (
            <motion.div
              key={message.id}
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -20 }}
              transition={{ duration: 0.3, ease: 'easeOut' }}
              className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}
            >
              <div
                className={`max-w-[70%] px-4 py-3 rounded-lg ${
                  message.role === 'user'
                    ? 'bg-primary text-white'
                    : 'bg-neutral-surface text-text-primary'
                }`}
                style={{
                  boxShadow: 'var(--shadow-sm)',
                }}
              >
                <p className="text-sm">{message.content}</p>
                <span className="text-xs opacity-70 mt-1 block">
                  {new Date(message.timestamp).toLocaleTimeString('zh-TW', {
                    hour: '2-digit',
                    minute: '2-digit',
                  })}
                </span>
              </div>
            </motion.div>
          ))}
        </AnimatePresence>
        <div ref={messagesEndRef} />
      </div>

      {/* Input Container */}
      <motion.div
        className="p-4 border-t border-neutral-border bg-white"
        initial={{ y: 100 }}
        animate={{ y: 0 }}
        transition={{ duration: 0.5, ease: 'easeOut' }}
      >
        <form onSubmit={handleSubmit} className="flex gap-3">
          <motion.input
            type="text"
            value={input}
            onChange={(e) => setInput(e.target.value)}
            placeholder="輸入訊息..."
            disabled={isSending}
            className="flex-1 px-4 py-3 text-md border border-neutral-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"
            whileFocus={{ scale: 1.02 }}
            transition={{ duration: 0.2 }}
          />
          <motion.button
            type="submit"
            disabled={isSending || !input.trim()}
            className="px-6 py-3 bg-primary text-white rounded-lg font-medium disabled:bg-neutral-border disabled:cursor-not-allowed"
            whileHover={{ scale: 1.05 }}
            whileTap={{ scale: 0.95 }}
            transition={{ duration: 0.2 }}
          >
            {isSending ? (
              <span className="flex items-center gap-2">
                <motion.div
                  className="w-4 h-4 border-2 border-white border-t-transparent rounded-full"
                  animate={{ rotate: 360 }}
                  transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}
                />
                送出中
              </span>
            ) : (
              '送出'
            )}
          </motion.button>
        </form>
      </motion.div>
    </div>
  );
}
```

**驗證方式**:
- [ ] 新訊息出現時有 Fade-in + Slide-up 動畫（300ms）
- [ ] 輸入框聚焦時有微妙的放大效果（scale 1.02）
- [ ] 送出按鈕 Hover 時有放大效果（scale 1.05）
- [ ] 送出按鈕點擊時有按下效果（scale 0.95）
- [ ] 訊息清單自動滾動到底部（smooth scroll）
- [ ] 支援 prefers-reduced-motion（動畫簡化）

---

### Task 3: Avatar 閒置呼吸動畫

**描述**: 在 Avatar 閒置時加入微妙的上下浮動呼吸動畫

**檔案**: `src/components/avatar/AvatarModel.tsx`

**程式碼實作**:
```typescript
'use client';

import React, { useRef, useEffect } from 'react';
import { useFrame } from '@react-three/fiber';
import { Group } from 'three';

interface AvatarModelProps {
  isIdle?: boolean; // 是否閒置（無對話）
  isSpeaking?: boolean; // 是否正在說話
}

export function AvatarModel({ isIdle = true, isSpeaking = false }: AvatarModelProps) {
  const avatarRef = useRef<Group>(null);
  const timeRef = useRef(0);

  useFrame((state, delta) => {
    if (!avatarRef.current) return;

    timeRef.current += delta;

    if (isSpeaking) {
      // Speaking animation: Bounce effect
      const bounceIntensity = 0.05;
      const bounceSpeed = 10;
      const bounce = Math.sin(timeRef.current * bounceSpeed) * bounceIntensity;
      avatarRef.current.position.y = bounce;
    } else if (isIdle) {
      // Idle animation: Breathing effect (slow up-down)
      const breathingIntensity = 0.02;
      const breathingSpeed = 1.5; // Slow breathing
      const breathing = Math.sin(timeRef.current * breathingSpeed) * breathingIntensity;
      avatarRef.current.position.y = breathing;
    } else {
      // No animation
      avatarRef.current.position.y = 0;
    }
  });

  return (
    <group ref={avatarRef}>
      {/* Avatar mesh will be loaded here */}
      <mesh>
        <boxGeometry args={[1, 2, 1]} />
        <meshStandardMaterial color="#7b68ee" />
      </mesh>
    </group>
  );
}
```

**進階版（Blendshape + 眨眼動畫）**:
```typescript
'use client';

import React, { useRef, useEffect } from 'react';
import { useFrame } from '@react-three/fiber';
import { Group, Mesh, SkinnedMesh } from 'three';

interface AvatarModelProps {
  isIdle?: boolean;
  isSpeaking?: boolean;
  avatarMesh?: SkinnedMesh; // VRM model's mesh with blendshapes
}

export function AvatarModel({ isIdle = true, isSpeaking = false, avatarMesh }: AvatarModelProps) {
  const avatarRef = useRef<Group>(null);
  const timeRef = useRef(0);
  const blinkTimeRef = useRef(0);

  useFrame((state, delta) => {
    if (!avatarRef.current) return;

    timeRef.current += delta;
    blinkTimeRef.current += delta;

    // Position animation (breathing/bounce)
    if (isSpeaking) {
      const bounceIntensity = 0.05;
      const bounceSpeed = 10;
      const bounce = Math.sin(timeRef.current * bounceSpeed) * bounceIntensity;
      avatarRef.current.position.y = bounce;
    } else if (isIdle) {
      const breathingIntensity = 0.02;
      const breathingSpeed = 1.5;
      const breathing = Math.sin(timeRef.current * breathingSpeed) * breathingIntensity;
      avatarRef.current.position.y = breathing;
    }

    // Blinking animation (if avatar has blendshapes)
    if (avatarMesh && avatarMesh.morphTargetDictionary) {
      const blinkIndex = avatarMesh.morphTargetDictionary['blink'];
      if (blinkIndex !== undefined && avatarMesh.morphTargetInfluences) {
        // Blink every 3-5 seconds
        const blinkInterval = 4; // seconds
        const blinkDuration = 0.15; // seconds

        if (blinkTimeRef.current >= blinkInterval) {
          // Start blink
          const blinkProgress = (blinkTimeRef.current - blinkInterval) / blinkDuration;
          if (blinkProgress <= 1) {
            // Close eyes (0 → 1 → 0)
            avatarMesh.morphTargetInfluences[blinkIndex] =
              Math.sin(blinkProgress * Math.PI);
          } else {
            // Reset blink timer
            blinkTimeRef.current = 0;
            avatarMesh.morphTargetInfluences[blinkIndex] = 0;
          }
        }
      }
    }
  });

  return (
    <group ref={avatarRef}>
      {/* Avatar mesh will be loaded here */}
      <primitive object={avatarMesh} />
    </group>
  );
}
```

**驗證方式**:
- [ ] 閒置時 Avatar 有微妙的上下呼吸動畫（0.02 單位）
- [ ] 說話時 Avatar 有明顯的 Bounce 動畫（0.05 單位）
- [ ] 呼吸動畫速度緩慢（1.5 rad/s）
- [ ] 眨眼動畫每 3-5 秒觸發一次（進階版）
- [ ] 動畫流暢不卡頓（30 FPS+）

---

### Task 4: 響應式佈局（Desktop/Tablet/Mobile）

**描述**: 實作適配三種裝置的響應式佈局

**檔案**: `src/app/page.tsx`

**程式碼實作**:
```typescript
'use client';

import React from 'react';
import { AvatarCanvas } from '@/components/avatar/AvatarCanvas';
import { ChatInterface } from '@/components/chat/ChatInterface';

export default function HomePage() {
  return (
    <div className="flex flex-col lg:flex-row h-screen overflow-hidden">
      {/* Avatar Section */}
      <div className="w-full lg:w-1/2 h-1/2 lg:h-full relative">
        <AvatarCanvas />

        {/* Mobile: Show avatar info overlay */}
        <div className="lg:hidden absolute bottom-4 left-4 right-4 p-4 bg-white/90 backdrop-blur-sm rounded-lg shadow-lg">
          <h2 className="text-lg font-bold text-text-primary">AI Avatar</h2>
          <p className="text-sm text-text-secondary">您的智能對話夥伴</p>
        </div>
      </div>

      {/* Chat Section */}
      <div className="w-full lg:w-1/2 h-1/2 lg:h-full flex flex-col">
        <ChatInterface />
      </div>
    </div>
  );
}
```

**Responsive Styles (Tailwind)**:
```typescript
// Alternative implementation with custom CSS
'use client';

import React from 'react';
import { AvatarCanvas } from '@/components/avatar/AvatarCanvas';
import { ChatInterface } from '@/components/chat/ChatInterface';
import styles from './page.module.css';

export default function HomePage() {
  return (
    <div className={styles.container}>
      <div className={styles.avatarSection}>
        <AvatarCanvas />
      </div>
      <div className={styles.chatSection}>
        <ChatInterface />
      </div>
    </div>
  );
}
```

```css
/* src/app/page.module.css */
.container {
  display: flex;
  height: 100vh;
  overflow: hidden;
}

.avatarSection {
  width: 100%;
  height: 50%;
  position: relative;
}

.chatSection {
  width: 100%;
  height: 50%;
  display: flex;
  flex-direction: column;
}

/* Tablet (≥768px) */
@media (min-width: 768px) {
  .container {
    flex-direction: column;
  }

  .avatarSection {
    height: 60%;
  }

  .chatSection {
    height: 40%;
  }
}

/* Desktop (≥1024px) */
@media (min-width: 1024px) {
  .container {
    flex-direction: row;
  }

  .avatarSection {
    width: 50%;
    height: 100%;
  }

  .chatSection {
    width: 50%;
    height: 100%;
  }
}
```

**驗證方式**:
- [ ] Desktop: 左右分欄佈局（50/50）
- [ ] Tablet: 上下佈局（60/40）
- [ ] Mobile: 上下佈局（50/50），Avatar 有 info overlay
- [ ] 瀏覽器視窗 resize 時過渡流暢
- [ ] 所有斷點文字清晰可讀

---

### Task 5: Focus Styles 與 Accessibility

**描述**: 確保所有互動元素有明顯的 Focus ring，支援鍵盤導航

**檔案**: `src/styles/accessibility.css`

**程式碼實作**:
```css
/* src/styles/accessibility.css */

/* Focus Styles for Interactive Elements */
button:focus-visible,
input:focus-visible,
textarea:focus-visible,
select:focus-visible,
a:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
  border-radius: var(--radius-sm);
}

/* High Contrast Focus for Keyboard Users */
@media (prefers-contrast: high) {
  button:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  a:focus-visible {
    outline-width: 3px;
    outline-color: #000000;
  }
}

/* Skip to Content Link (for screen readers and keyboard users) */
.skip-to-content {
  position: absolute;
  top: -100px;
  left: 0;
  background-color: var(--color-primary);
  color: white;
  padding: 12px 24px;
  text-decoration: none;
  border-radius: var(--radius-md);
  z-index: var(--z-tooltip);
  transition: top var(--transition-base);
}

.skip-to-content:focus {
  top: 10px;
}

/* Remove default focus outline for mouse users (not keyboard) */
*:focus:not(:focus-visible) {
  outline: none;
}

/* Ensure sufficient color contrast */
.text-low-contrast {
  color: var(--color-text-secondary);
}

/* WCAG AA: 4.5:1 for normal text, 3:1 for large text */
.text-high-contrast {
  color: var(--color-text-primary);
}

/* Loading State Accessibility */
[aria-busy='true'] {
  cursor: progress;
}

/* Disabled State Accessibility */
[aria-disabled='true'],
:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  pointer-events: none;
}

/* Screen Reader Only */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
```

**Skip to Content Component**:
```typescript
// src/components/SkipToContent.tsx
'use client';

import React from 'react';

export function SkipToContent() {
  return (
    <a href="#main-content" className="skip-to-content">
      跳到主要內容
    </a>
  );
}
```

**使用範例**:
```typescript
// src/app/layout.tsx
import { SkipToContent } from '@/components/SkipToContent';

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="zh-TW">
      <body>
        <SkipToContent />
        <main id="main-content">
          {children}
        </main>
      </body>
    </html>
  );
}
```

**驗證方式**:
- [ ] 所有按鈕、輸入框、連結有 focus ring
- [ ] Tab 鍵可依序導航所有互動元素
- [ ] Skip to Content 連結在 Tab 時顯示
- [ ] Screen reader 可正確讀出所有內容
- [ ] 支援 prefers-reduced-motion

---

### Task 6: Hover Effects 與 Micro-Interactions

**描述**: 為按鈕、連結、卡片加入 Hover 效果

**檔案**: `src/components/ui/Button.tsx`

**程式碼實作 (Button Component)**:
```typescript
'use client';

import React from 'react';
import { motion, HTMLMotionProps } from 'framer-motion';

interface ButtonProps extends HTMLMotionProps<'button'> {
  variant?: 'primary' | 'secondary' | 'ghost';
  size?: 'sm' | 'md' | 'lg';
  isLoading?: boolean;
  children: React.ReactNode;
}

export function Button({
  variant = 'primary',
  size = 'md',
  isLoading = false,
  children,
  disabled,
  ...props
}: ButtonProps) {
  const variantStyles = {
    primary: 'bg-primary text-white hover:bg-primary-hover',
    secondary: 'bg-neutral-surface text-text-primary hover:bg-neutral-border',
    ghost: 'bg-transparent text-primary hover:bg-primary/10',
  };

  const sizeStyles = {
    sm: 'px-3 py-1.5 text-sm',
    md: 'px-4 py-2 text-md',
    lg: 'px-6 py-3 text-lg',
  };

  return (
    <motion.button
      className={`
        ${variantStyles[variant]}
        ${sizeStyles[size]}
        rounded-md font-medium
        transition-colors duration-300
        focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2
        disabled:opacity-50 disabled:cursor-not-allowed
      `}
      whileHover={{ scale: disabled || isLoading ? 1 : 1.05 }}
      whileTap={{ scale: disabled || isLoading ? 1 : 0.95 }}
      transition={{ duration: 0.2 }}
      disabled={disabled || isLoading}
      {...props}
    >
      {isLoading ? (
        <span className="flex items-center gap-2">
          <motion.div
            className="w-4 h-4 border-2 border-current border-t-transparent rounded-full"
            animate={{ rotate: 360 }}
            transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}
          />
          載入中...
        </span>
      ) : (
        children
      )}
    </motion.button>
  );
}
```

**Card Component with Hover Effect**:
```typescript
'use client';

import React from 'react';
import { motion } from 'framer-motion';

interface CardProps {
  children: React.ReactNode;
  hover?: boolean; // Enable hover effect
  onClick?: () => void;
}

export function Card({ children, hover = false, onClick }: CardProps) {
  return (
    <motion.div
      className="bg-white rounded-lg shadow-md p-6 border border-neutral-border"
      whileHover={hover ? { scale: 1.02, boxShadow: 'var(--shadow-lg)' } : undefined}
      transition={{ duration: 0.2 }}
      onClick={onClick}
      style={{ cursor: onClick ? 'pointer' : 'default' }}
    >
      {children}
    </motion.div>
  );
}
```

**Link Component with Underline Animation**:
```typescript
'use client';

import React from 'react';
import Link from 'next/link';
import { motion } from 'framer-motion';

interface AnimatedLinkProps {
  href: string;
  children: React.ReactNode;
}

export function AnimatedLink({ href, children }: AnimatedLinkProps) {
  return (
    <Link href={href} className="relative inline-block text-primary font-medium">
      {children}
      <motion.span
        className="absolute left-0 bottom-0 w-full h-0.5 bg-primary"
        initial={{ scaleX: 0 }}
        whileHover={{ scaleX: 1 }}
        transition={{ duration: 0.3 }}
        style={{ transformOrigin: 'left' }}
      />
    </Link>
  );
}
```

**驗證方式**:
- [ ] Button Hover 時有放大效果（scale 1.05）
- [ ] Button 點擊時有按下效果（scale 0.95）
- [ ] Card Hover 時有放大與陰影變化
- [ ] Link Hover 時有底線動畫（scaleX 0 → 1）
- [ ] Loading 狀態按鈕不可點擊，顯示 spinner
- [ ] 所有過渡動畫流暢（300ms）

---

### Task 7: 顏色對比度驗證 (WCAG AA)

**描述**: 驗證所有文字與背景的顏色對比度符合 WCAG AA 標準

**檔案**: `docs/testing/color-contrast-report.md`

**工具**: [WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/)

**程式碼實作 (Contrast Checker Script)**:
```typescript
// scripts/check-contrast.ts
/**
 * Color Contrast Checker (WCAG AA Standard)
 * Normal text: 4.5:1
 * Large text (≥18pt or 14pt bold): 3:1
 */

interface Color {
  r: number;
  g: number;
  b: number;
}

function hexToRgb(hex: string): Color {
  const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
  return result
    ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16),
      }
    : { r: 0, g: 0, b: 0 };
}

function getLuminance(color: Color): number {
  const { r, g, b } = color;
  const [rs, gs, bs] = [r, g, b].map((c) => {
    c = c / 255;
    return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
  });
  return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
}

function getContrastRatio(color1: string, color2: string): number {
  const lum1 = getLuminance(hexToRgb(color1));
  const lum2 = getLuminance(hexToRgb(color2));
  const lighter = Math.max(lum1, lum2);
  const darker = Math.min(lum1, lum2);
  return (lighter + 0.05) / (darker + 0.05);
}

function checkWCAG(foreground: string, background: string): {
  ratio: number;
  normalText: boolean;
  largeText: boolean;
} {
  const ratio = getContrastRatio(foreground, background);
  return {
    ratio: Math.round(ratio * 100) / 100,
    normalText: ratio >= 4.5,
    largeText: ratio >= 3.0,
  };
}

// Test Design Tokens
const tests = [
  { name: 'Primary text on white', fg: '#212529', bg: '#ffffff' },
  { name: 'Secondary text on white', fg: '#6c757d', bg: '#ffffff' },
  { name: 'Primary button text', fg: '#ffffff', bg: '#007bff' },
  { name: 'Success text', fg: '#28a745', bg: '#ffffff' },
  { name: 'Error text', fg: '#dc3545', bg: '#ffffff' },
  { name: 'Text on surface', fg: '#212529', bg: '#f8f9fa' },
];

console.log('=== WCAG AA Color Contrast Report ===\n');

tests.forEach((test) => {
  const result = checkWCAG(test.fg, test.bg);
  const status = result.normalText ? '✅ PASS' : '❌ FAIL';
  console.log(`${status} ${test.name}`);
  console.log(`  Contrast Ratio: ${result.ratio}:1`);
  console.log(`  Normal Text (≥4.5:1): ${result.normalText ? '✅' : '❌'}`);
  console.log(`  Large Text (≥3:1): ${result.largeText ? '✅' : '❌'}`);
  console.log('');
});
```

**執行**:
```bash
npx ts-node scripts/check-contrast.ts
```

**預期輸出**:
```
=== WCAG AA Color Contrast Report ===

✅ PASS Primary text on white
  Contrast Ratio: 16.89:1
  Normal Text (≥4.5:1): ✅
  Large Text (≥3:1): ✅

✅ PASS Secondary text on white
  Contrast Ratio: 4.68:1
  Normal Text (≥4.5:1): ✅
  Large Text (≥3:1): ✅

✅ PASS Primary button text
  Contrast Ratio: 5.91:1
  Normal Text (≥4.5:1): ✅
  Large Text (≥3:1): ✅
```

**驗證方式**:
- [ ] 所有測試項目通過 WCAG AA 標準
- [ ] Normal text 對比度 ≥ 4.5:1
- [ ] Large text 對比度 ≥ 3:1
- [ ] 記錄結果到文件

---

### Task 8: UI/UX 細節檢查清單

**描述**: 建立完整的 UI/UX 檢查清單，確保所有細節完善

**檔案**: `docs/testing/ui-ux-checklist.md`

**程式碼實作**:
```markdown
# UI/UX Polish Checklist

## ✅ Visual Design

### Typography
- [ ] 字體載入正常（Inter, 無 FOUT/FOIT）
- [ ] 行高適中（1.5 for body text）
- [ ] 標題層級清晰（h1-h6）
- [ ] 字重使用一致（400, 500, 700）

### Colors
- [ ] 顏色對比度符合 WCAG AA (≥4.5:1)
- [ ] Primary color 使用一致
- [ ] Semantic colors 正確（success, error, warning, info）
- [ ] Dark mode 變數定義完整（未來擴展）

### Spacing
- [ ] 元素間距一致（使用 design tokens）
- [ ] Padding/Margin 使用 4px 倍數
- [ ] 佈局對齊（左對齊、置中、右對齊清晰）
- [ ] 無異常空白或擁擠

### Borders & Shadows
- [ ] Border radius 一致（4px, 8px, 12px）
- [ ] 陰影層級清晰（sm, md, lg, xl）
- [ ] Border 顏色一致（neutral-border）

---

## ✅ Animations & Transitions

### Micro-Interactions
- [ ] Button hover 有顏色過渡（300ms）
- [ ] Input focus 有 scale 動畫（200ms）
- [ ] Link hover 有底線動畫（300ms）
- [ ] Card hover 有放大與陰影變化（200ms）

### UI Animations
- [ ] 訊息 Fade-in/Slide-up 流暢（300ms）
- [ ] Modal enter/exit 流暢（400ms）
- [ ] Toast slide-in 流暢（300ms）
- [ ] Loading spinner 持續旋轉

### 3D Animations
- [ ] Avatar 閒置呼吸動畫（slow, 0.02 units）
- [ ] Avatar 說話 Bounce 動畫（0.05 units）
- [ ] Avatar 眨眼動畫（每 3-5 秒）

### Performance
- [ ] 所有動畫維持 ≥30 FPS
- [ ] 無卡頓或掉幀
- [ ] 支援 prefers-reduced-motion

---

## ✅ Responsive Design

### Breakpoints
- [ ] Desktop (≥1024px): 左右分欄佈局
- [ ] Tablet (768-1023px): 上下佈局（60/40）
- [ ] Mobile (≤767px): 上下佈局（50/50）

### Layout
- [ ] 所有斷點文字清晰可讀
- [ ] 圖片/Icon 不失真
- [ ] 按鈕大小足夠（≥44×44px for touch）
- [ ] 橫向滾動無異常

### Touch Targets
- [ ] 所有按鈕 ≥44×44px（iOS/Android 標準）
- [ ] 連結間距足夠（避免誤觸）
- [ ] Swipe gesture 支援（未來擴展）

---

## ✅ Accessibility

### Keyboard Navigation
- [ ] Tab 鍵可依序導航所有互動元素
- [ ] Enter/Space 可觸發按鈕
- [ ] Escape 可關閉 Modal
- [ ] Arrow keys 可導航選單（未來擴展）

### Focus Management
- [ ] 所有互動元素有 focus ring
- [ ] Focus ring 明顯（2px solid primary）
- [ ] Modal 開啟時 focus 移至內容
- [ ] Modal 關閉時 focus 回到觸發元素

### Screen Reader
- [ ] 所有圖片有 alt text
- [ ] 所有按鈕有 aria-label（圖示按鈕）
- [ ] Toast 使用 aria-live region
- [ ] Loading 狀態使用 aria-busy
- [ ] Skip to Content 連結存在

### Color Contrast
- [ ] 所有文字對比度 ≥4.5:1
- [ ] Large text 對比度 ≥3:1
- [ ] Focus ring 對比度 ≥3:1
- [ ] Disabled 狀態清晰（opacity 0.6）

### Motion
- [ ] 支援 prefers-reduced-motion
- [ ] 動畫可選擇性關閉（未來擴展）

---

## ✅ Performance

### Loading Performance
- [ ] 首屏載入 ≤3 秒
- [ ] FCP (First Contentful Paint) ≤1.5 秒
- [ ] LCP (Largest Contentful Paint) ≤2.5 秒
- [ ] CLS (Cumulative Layout Shift) ≤0.1

### Runtime Performance
- [ ] FPS ≥30（3D 場景）
- [ ] 動畫流暢無掉幀
- [ ] 記憶體使用 ≤500MB
- [ ] CPU 使用 ≤50%

### Asset Optimization
- [ ] 圖片壓縮（WebP format）
- [ ] 字體子集化（Latin + CJK）
- [ ] CSS/JS minify
- [ ] Bundle size ≤500KB (initial)

---

## ✅ User Experience

### Feedback
- [ ] 點擊按鈕有視覺回饋（ripple/scale）
- [ ] Loading 狀態清晰（spinner/progress bar）
- [ ] 成功操作有 Toast 通知
- [ ] 錯誤操作有友善訊息

### Error Handling
- [ ] 錯誤訊息友善易懂
- [ ] 提供重試選項
- [ ] 無白屏崩潰
- [ ] Network offline 警告

### Empty States
- [ ] 無訊息時顯示引導文字
- [ ] Loading 時顯示 Skeleton
- [ ] Error 時顯示友善圖示與訊息

### Consistency
- [ ] 按鈕樣式一致
- [ ] Icon 大小一致
- [ ] 間距使用一致
- [ ] 術語使用一致

---

## ✅ Browser Compatibility

### Desktop
- [ ] Chrome (latest)
- [ ] Edge (latest)
- [ ] Safari (latest)
- [ ] Firefox (latest)

### Mobile
- [ ] iOS Safari (latest)
- [ ] Android Chrome (latest)

### Features
- [ ] CSS Grid/Flexbox support
- [ ] CSS Variables support
- [ ] WebGL support (3D scene)
- [ ] Web Audio API support

---

## ✅ Final Polish

### Visual Consistency
- [ ] 所有頁面使用相同 design system
- [ ] Icon 風格一致（outline vs solid）
- [ ] 陰影深度一致
- [ ] 動畫速度一致

### Code Quality
- [ ] CSS 無重複定義
- [ ] Unused styles 移除
- [ ] Components 可重複使用
- [ ] Naming conventions 一致

### Documentation
- [ ] Design tokens 文件化
- [ ] Component usage 範例
- [ ] Animation guidelines
- [ ] Accessibility guidelines

---

## 驗收標準

**通過條件**: 所有項目勾選完成 ✅

**測試設備**:
- Desktop: 1920×1080, Windows/Mac
- Tablet: iPad Pro 11" (1668×2388)
- Mobile: iPhone 14 (390×844)

**測試瀏覽器**:
- Chrome 120+
- Edge 120+
- Safari 17+
- Firefox 121+
```

**驗證方式**:
- [ ] 所有 Checklist 項目完成
- [ ] 截圖記錄測試結果
- [ ] 在多種設備與瀏覽器測試
- [ ] PO/Designer 審核通過

---

## 📊 Dev Notes

### Animation Performance Optimization

**避免動畫卡頓的關鍵**:

1. **只動畫 transform 和 opacity**:
   - ✅ `transform: translateY(10px)` (GPU accelerated)
   - ❌ `top: 10px` (triggers layout, slow)

2. **使用 will-change 提示瀏覽器**:
   ```css
   .animated-element {
     will-change: transform, opacity;
   }
   ```

3. **避免在動畫中觸發 Layout/Reflow**:
   - ❌ 修改 width/height/margin/padding
   - ✅ 使用 transform: scale()

4. **使用 requestAnimationFrame**:
   ```typescript
   useFrame(() => {
     // Three.js animations run at 60 FPS automatically
   });
   ```

### Framer Motion Best Practices

**常用動畫變體**:
```typescript
const variants = {
  hidden: { opacity: 0, y: 20 },
  visible: { opacity: 1, y: 0, transition: { duration: 0.3 } },
  exit: { opacity: 0, y: -20, transition: { duration: 0.2 } },
};

<motion.div
  variants={variants}
  initial="hidden"
  animate="visible"
  exit="exit"
/>
```

**Spring Animation** (自然彈性):
```typescript
<motion.div
  animate={{ scale: 1.1 }}
  transition={{ type: 'spring', stiffness: 300, damping: 20 }}
/>
```

**Stagger Children** (逐個出現):
```typescript
const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1, // Each child delays 0.1s
    },
  },
};

const itemVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: { opacity: 1, y: 0 },
};

<motion.ul variants={containerVariants} initial="hidden" animate="visible">
  {items.map((item) => (
    <motion.li key={item.id} variants={itemVariants}>
      {item.name}
    </motion.li>
  ))}
</motion.ul>
```

### Responsive Design Strategies

**Mobile-First vs Desktop-First**:

**Mobile-First** (本專案採用):
```css
/* Base styles for mobile */
.container {
  flex-direction: column;
}

/* Tablet and up */
@media (min-width: 768px) {
  .container {
    flex-direction: row;
  }
}
```

**優點**:
- 從最小螢幕開始設計，確保核心功能可用
- 漸進式增強（Progressive Enhancement）
- 行動優先符合現代 web 趨勢

**Fluid Typography** (未來擴展):
```css
:root {
  /* Responsive font size using clamp() */
  --font-size-md: clamp(14px, 2vw, 16px);
  --font-size-lg: clamp(16px, 3vw, 24px);
}
```

### Accessibility Checklist

**POUR Principles**:

1. **Perceivable** (可感知):
   - ✅ 文字與背景對比度 ≥4.5:1
   - ✅ 所有非文字內容有替代文字
   - ✅ 顏色不是唯一的資訊傳達方式

2. **Operable** (可操作):
   - ✅ 所有功能可通過鍵盤操作
   - ✅ Focus 順序合理
   - ✅ 無鍵盤陷阱（keyboard trap）

3. **Understandable** (可理解):
   - ✅ 錯誤訊息清楚易懂
   - ✅ 表單標籤明確
   - ✅ 操作結果可預測

4. **Robust** (堅固):
   - ✅ 支援輔助技術（screen reader）
   - ✅ 語義化 HTML（semantic HTML）
   - ✅ ARIA attributes 正確使用

**ARIA Best Practices**:
```typescript
// Button with icon only
<button aria-label="關閉對話框">
  <XIcon />
</button>

// Loading state
<div aria-busy="true" aria-live="polite">
  載入中...
</div>

// Modal
<div role="dialog" aria-labelledby="modal-title" aria-modal="true">
  <h2 id="modal-title">對話框標題</h2>
</div>
```

### Dark Mode Implementation (未來擴展)

**CSS Variables Strategy**:
```css
:root {
  --color-background: #ffffff;
  --color-text-primary: #212529;
}

[data-theme='dark'] {
  --color-background: #1a1a1a;
  --color-text-primary: #ffffff;
}
```

**React Hook**:
```typescript
function useDarkMode() {
  const [theme, setTheme] = useState<'light' | 'dark'>('light');

  useEffect(() => {
    const stored = localStorage.getItem('theme');
    if (stored) {
      setTheme(stored as 'light' | 'dark');
      document.documentElement.setAttribute('data-theme', stored);
    }
  }, []);

  const toggleTheme = () => {
    const newTheme = theme === 'light' ? 'dark' : 'light';
    setTheme(newTheme);
    localStorage.setItem('theme', newTheme);
    document.documentElement.setAttribute('data-theme', newTheme);
  };

  return { theme, toggleTheme };
}
```

---

## 🧪 Testing Strategy

### Visual Regression Testing

**工具**: Percy, Chromatic, BackstopJS

**測試流程**:
1. 建立 baseline screenshots（各種狀態與斷點）
2. 程式碼變更後自動跑測試
3. 比對差異，人工審核
4. 批准變更或修正 bug

**範例 (Chromatic)**:
```bash
npm install --save-dev chromatic
npx chromatic --project-token=<token>
```

### Manual Testing

**測試清單**: 參考 Task 8 的完整 Checklist

**測試重點**:
- [ ] 所有動畫流暢（30 FPS+）
- [ ] 響應式佈局正確
- [ ] 所有互動元素有 Hover/Focus 效果
- [ ] 鍵盤導航順序合理
- [ ] 顏色對比度符合 WCAG AA

### User Testing

**測試對象**: 5-10 位使用者（多元背景）

**測試任務**:
1. 開啟應用程式，描述第一印象
2. 嘗試與 Avatar 對話
3. 觀察動畫與過渡效果
4. 使用不同裝置（Desktop/Mobile）
5. 回饋整體使用體驗

**評分標準**:
- 視覺吸引力: 1-5 分
- 動畫流暢度: 1-5 分
- 互動回饋: 1-5 分
- 整體專業度: 1-5 分

**目標**: 平均 ≥4.0/5.0

---

## 📈 Success Metrics

### 量化指標

1. **視覺品質**: Lighthouse Accessibility Score ≥90
2. **動畫效能**: FPS ≥30 (3D scene)
3. **載入速度**: FCP ≤1.5s, LCP ≤2.5s
4. **對比度**: 100% text passes WCAG AA
5. **響應式**: 3 breakpoints tested on real devices

### 質化指標

1. **使用者回饋**: "介面專業美觀，動畫流暢自然"
2. **開發者體驗**: "Design system 完整，元件易重複使用"
3. **品牌印象**: "產品具備專業級質感"

---

## 🔗 Dependencies

### Epic Dependencies
- **Depends on**:
  - Epic 2 (Avatar Canvas 需要 UI polish)
  - Epic 3 (Chat Interface 需要 UI polish)
  - Story 5.2 (Toast 系統可重複使用)

### Story Dependencies
- **Must Complete Before**:
  - Story 5.4 (瀏覽器相容性測試) - 需要完整 UI 進行測試
  - Story 5.6 (技術驗證報告) - 需要 UI/UX 測試結果

### External Dependencies
- `framer-motion@11.x`: Animation library
- `tailwindcss@3.x`: Utility-first CSS framework
- `next@14.x`: App Router, client components
- `@react-three/fiber@8.x`: Three.js React renderer

---

## 📦 Deliverables

1. **Styles**:
   - `src/styles/design-tokens.css` ✅
   - `src/styles/accessibility.css` ✅
   - `tailwind.config.ts` ✅

2. **Components**:
   - `src/components/ui/Button.tsx` ✅
   - `src/components/ui/Card.tsx` ✅
   - `src/components/ui/AnimatedLink.tsx` ✅
   - `src/components/SkipToContent.tsx` ✅

3. **Enhanced Components**:
   - `src/components/chat/ChatInterface.tsx` (with animations) ✅
   - `src/components/avatar/AvatarModel.tsx` (with idle animation) ✅

4. **Scripts**:
   - `scripts/check-contrast.ts` ✅

5. **Documentation**:
   - `docs/testing/ui-ux-checklist.md` ✅
   - `docs/testing/color-contrast-report.md` ✅

---

## ✅ Definition of Done

- [ ] 全域 Design Tokens 定義完整（顏色、間距、字型、過渡）
- [ ] 聊天介面動畫流暢（Fade-in/Slide-up, Focus scale）
- [ ] Avatar 閒置呼吸動畫與說話 Bounce 動畫完成
- [ ] 響應式佈局適配 Desktop/Tablet/Mobile
- [ ] 所有互動元素有 Focus ring 與 Hover effect
- [ ] 顏色對比度符合 WCAG AA 標準（≥4.5:1）
- [ ] 所有動畫支援 prefers-reduced-motion
- [ ] UI/UX Checklist 所有項目完成
- [ ] 視覺回歸測試通過（若有）
- [ ] User testing 平均分數 ≥4.0/5.0
- [ ] 在 Chrome, Edge, Safari, Firefox 測試通過
- [ ] Code review 通過
- [ ] 文件齊全（Design tokens, Accessibility guidelines）

---

## 📚 References

- [Framer Motion Documentation](https://www.framer.com/motion/)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [WCAG 2.1 Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- [MDN: prefers-reduced-motion](https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-reduced-motion)
- [WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/)
- [Google Web Fundamentals: Animations](https://developers.google.com/web/fundamentals/design-and-ux/animations)
- [Inclusive Components](https://inclusive-components.design/)

---

**Story 建立日期**: 2025-10-14
**最後更新**: 2025-10-14
**INVEST Score**: ⭐⭐⭐⭐⭐⭐ (6/6)
- ✅ Independent: 可獨立開發與測試
- ✅ Negotiable: 動畫參數、斷點可調整
- ✅ Valuable: 大幅提升產品專業度與使用者體驗
- ✅ Estimable: 7 小時預估時間合理
- ✅ Small: 範圍明確，可在一個 Sprint 內完成
- ✅ Testable: 可透過視覺回歸測試、手動測試與 User testing 驗證
