/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/knowledge/persona/route";
exports.ids = ["app/api/knowledge/persona/route"];
exports.modules = {

/***/ "(rsc)/./app/api/knowledge/persona/route.ts":
/*!********************************************!*\
  !*** ./app/api/knowledge/persona/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_knowledge_file_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/knowledge/file-manager */ \"(rsc)/./lib/knowledge/file-manager.ts\");\n/* harmony import */ var _lib_knowledge_validator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/knowledge/validator */ \"(rsc)/./lib/knowledge/validator.ts\");\n/**\r\n * Persona API Route\r\n * @description 處理 Persona 的讀取和更新操作\r\n */ \n\n\n// 使用 Node.js Runtime（需要 fs 模組）\nconst runtime = 'nodejs';\nconst PERSONA_FILENAME = 'persona.md';\n/**\r\n * GET /api/knowledge/persona\r\n * 讀取 Persona 定義\r\n */ async function GET(request) {\n    try {\n        console.log('[API] 📖 讀取 Persona...');\n        // 讀取檔案\n        const content = (0,_lib_knowledge_file_manager__WEBPACK_IMPORTED_MODULE_1__.readKnowledgeFile)(PERSONA_FILENAME);\n        const metadata = (0,_lib_knowledge_file_manager__WEBPACK_IMPORTED_MODULE_1__.getFileMetadata)(PERSONA_FILENAME);\n        // 分析結構\n        const validation = (0,_lib_knowledge_validator__WEBPACK_IMPORTED_MODULE_2__.validatePersona)(content);\n        const response = {\n            success: true,\n            data: {\n                content,\n                metadata,\n                structure: {\n                    sections: extractPersonaSections(content),\n                    completeness: validation.score || 0,\n                    consistency: calculateConsistency(content)\n                }\n            },\n            metadata: {\n                timestamp: new Date().toISOString()\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response);\n    } catch (error) {\n        console.error('[API] ❌ 讀取 Persona 失敗:', error);\n        const errorResponse = {\n            success: false,\n            error: {\n                code: 'READ_ERROR',\n                message: error.message || '讀取 Persona 失敗',\n                details: error\n            },\n            metadata: {\n                timestamp: new Date().toISOString()\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(errorResponse, {\n            status: 500\n        });\n    }\n}\n/**\r\n * POST /api/knowledge/persona\r\n * 更新 Persona 定義\r\n */ async function POST(request) {\n    try {\n        console.log('[API] ✏️  更新 Persona...');\n        // 解析請求\n        const body = await request.json();\n        const { content } = body;\n        if (!content || typeof content !== 'string') {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    code: 'INVALID_INPUT',\n                    message: 'content 欄位必須是非空字串'\n                }\n            }, {\n                status: 400\n            });\n        }\n        // 驗證內容\n        const validation = (0,_lib_knowledge_validator__WEBPACK_IMPORTED_MODULE_2__.validatePersona)(content);\n        if (!validation.valid) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    code: 'VALIDATION_ERROR',\n                    message: '內容驗證失敗',\n                    details: validation.errors\n                },\n                metadata: {\n                    warnings: validation.warnings\n                }\n            }, {\n                status: 400\n            });\n        }\n        // 寫入檔案\n        const metadata = (0,_lib_knowledge_file_manager__WEBPACK_IMPORTED_MODULE_1__.writeKnowledgeFile)(PERSONA_FILENAME, content);\n        console.log('[API] ✅ Persona 已更新');\n        const response = {\n            success: true,\n            data: {\n                metadata,\n                validation\n            },\n            metadata: {\n                timestamp: new Date().toISOString()\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response);\n    } catch (error) {\n        console.error('[API] ❌ 更新 Persona 失敗:', error);\n        const errorResponse = {\n            success: false,\n            error: {\n                code: 'WRITE_ERROR',\n                message: error.message || '更新 Persona 失敗',\n                details: error\n            },\n            metadata: {\n                timestamp: new Date().toISOString()\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(errorResponse, {\n            status: 500\n        });\n    }\n}\n// ============================================\n// 輔助函數\n// ============================================\n/**\r\n * 提取 Persona 章節\r\n */ function extractPersonaSections(content) {\n    const sections = [];\n    const requiredSections = [\n        '核心身份',\n        '溝通風格與語氣',\n        '決策原則',\n        '專業領域',\n        '互動模式',\n        '領導與管理哲學',\n        '個人信念與思維模型',\n        '輸出模板',\n        '詞彙與語氣規範',\n        '反問清單'\n    ];\n    requiredSections.forEach((sectionTitle)=>{\n        const regex = new RegExp(`##\\\\s*\\\\d*\\\\.?\\\\s*${sectionTitle}([\\\\s\\\\S]*?)(?=##|$)`, 'i');\n        const match = content.match(regex);\n        if (match) {\n            const sectionContent = match[1].trim();\n            const wordCount = (sectionContent.match(/[\\u4e00-\\u9fa5a-zA-Z]+/g) || []).length;\n            sections.push({\n                title: sectionTitle,\n                content: sectionContent,\n                wordCount,\n                isComplete: wordCount >= 100,\n                warnings: wordCount < 100 ? [\n                    '內容過短，建議補充更多細節'\n                ] : undefined\n            });\n        } else {\n            sections.push({\n                title: sectionTitle,\n                content: '',\n                wordCount: 0,\n                isComplete: false,\n                warnings: [\n                    '缺少此章節'\n                ]\n            });\n        }\n    });\n    return sections;\n}\n/**\r\n * 計算語氣一致性\r\n * @description 簡化版實作，實際可使用 NLP 分析\r\n */ function calculateConsistency(content) {\n    // 簡單啟發式規則：檢查常見用詞的一致性\n    const professionalTerms = [\n        '數據',\n        'ROI',\n        'KPI',\n        '商業價值',\n        '量化',\n        '分析'\n    ];\n    const casualTerms = [\n        '可能',\n        '也許',\n        '大概',\n        '隨便'\n    ];\n    const professionalCount = professionalTerms.filter((term)=>content.includes(term)).length;\n    const casualCount = casualTerms.filter((term)=>content.includes(term)).length;\n    // 專業用詞多 = 一致性高\n    const score = professionalCount > casualCount ? 85 : 65;\n    return Math.min(100, score + Math.random() * 10) // 加入隨機波動\n    ;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2tub3dsZWRnZS9wZXJzb25hL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOzs7Q0FHQyxHQUVzRDtBQUtsQjtBQUNzQjtBQUczRCwrQkFBK0I7QUFDeEIsTUFBTUssVUFBVSxTQUFRO0FBRS9CLE1BQU1DLG1CQUFtQjtBQUV6Qjs7O0NBR0MsR0FDTSxlQUFlQyxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0ZDLFFBQVFDLEdBQUcsQ0FBQztRQUVaLE9BQU87UUFDUCxNQUFNQyxVQUFVViw4RUFBaUJBLENBQUNLO1FBQ2xDLE1BQU1NLFdBQVdULDRFQUFlQSxDQUFDRztRQUVqQyxPQUFPO1FBQ1AsTUFBTU8sYUFBYVQseUVBQWVBLENBQUNPO1FBRW5DLE1BQU1HLFdBQXdDO1lBQzVDQyxTQUFTO1lBQ1RDLE1BQU07Z0JBQ0pMO2dCQUNBQztnQkFDQUssV0FBVztvQkFDVEMsVUFBVUMsdUJBQXVCUjtvQkFDakNTLGNBQWNQLFdBQVdRLEtBQUssSUFBSTtvQkFDbENDLGFBQWFDLHFCQUFxQlo7Z0JBQ3BDO1lBQ0Y7WUFDQUMsVUFBVTtnQkFDUlksV0FBVyxJQUFJQyxPQUFPQyxXQUFXO1lBQ25DO1FBQ0Y7UUFFQSxPQUFPMUIscURBQVlBLENBQUMyQixJQUFJLENBQUNiO0lBQzNCLEVBQUUsT0FBT2MsT0FBWTtRQUNuQm5CLFFBQVFtQixLQUFLLENBQUMsMEJBQTBCQTtRQUV4QyxNQUFNQyxnQkFBNkI7WUFDakNkLFNBQVM7WUFDVGEsT0FBTztnQkFDTEUsTUFBTTtnQkFDTkMsU0FBU0gsTUFBTUcsT0FBTyxJQUFJO2dCQUMxQkMsU0FBU0o7WUFDWDtZQUNBaEIsVUFBVTtnQkFDUlksV0FBVyxJQUFJQyxPQUFPQyxXQUFXO1lBQ25DO1FBQ0Y7UUFFQSxPQUFPMUIscURBQVlBLENBQUMyQixJQUFJLENBQUNFLGVBQWU7WUFBRUksUUFBUTtRQUFJO0lBQ3hEO0FBQ0Y7QUFFQTs7O0NBR0MsR0FDTSxlQUFlQyxLQUFLMUIs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O0lBQ3JCLE1BQU0wQyxvQkFBb0I7UUFDeEI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO0tBQ0Q7SUFDRCxNQUFNQyxjQUFjO1FBQUM7UUFBTTtRQUFNO1FBQU07S0FBSztJQUU1QyxNQUFNQyxvQkFBb0JGLGtCQUFrQkcsTUFBTSxDQUFDLENBQUNDLE9BQ2xEOUMsUUFBUStDLFFBQVEsQ0FBQ0QsT0FDakJULE1BQU07SUFDUixNQUFNVyxjQUFjTCxZQUFZRSxNQUFNLENBQUMsQ0FBQ0MsT0FBUzlDLFFBQVErQyxRQUFRLENBQUNELE9BQy9EVCxNQUFNO0lBRVQsZUFBZTtJQUNmLE1BQU0zQixRQUFRa0Msb0JBQW9CSSxjQUFjLEtBQUs7SUFFckQsT0FBT0MsS0FBS0MsR0FBRyxDQUFDLEtBQUt4QyxRQUFRdUMsS0FBS0UsTUFBTSxLQUFLLElBQUksU0FBUzs7QUFDNUQiLCJzb3VyY2VzIjpbIkM6XFxzbWFydC1haS1hdmF0YXItYWdlbnRcXGFwcFxcYXBpXFxrbm93bGVkZ2VcXHBlcnNvbmFcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBQZXJzb25hIEFQSSBSb3V0ZVxyXG4gKiBAZGVzY3JpcHRpb24g6JmV55CGIFBlcnNvbmEg55qE6K6A5Y+W5ZKM5pu05paw5pON5L2cXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xyXG5pbXBvcnQge1xyXG4gIHJlYWRLbm93bGVkZ2VGaWxlLFxyXG4gIHdyaXRlS25vd2xlZGdlRmlsZSxcclxuICBnZXRGaWxlTWV0YWRhdGEsXHJcbn0gZnJvbSAnQC9saWIva25vd2xlZGdlL2ZpbGUtbWFuYWdlcidcclxuaW1wb3J0IHsgdmFsaWRhdGVQZXJzb25hIH0gZnJvbSAnQC9saWIva25vd2xlZGdlL3ZhbGlkYXRvcidcclxuaW1wb3J0IHR5cGUgeyBBUElSZXNwb25zZSwgUGVyc29uYUNvbnRlbnQgfSBmcm9tICdAL3R5cGVzL2tub3dsZWRnZSdcclxuXHJcbi8vIOS9v+eUqCBOb2RlLmpzIFJ1bnRpbWXvvIjpnIDopoEgZnMg5qih57WE77yJXHJcbmV4cG9ydCBjb25zdCBydW50aW1lID0gJ25vZGVqcydcclxuXHJcbmNvbnN0IFBFUlNPTkFfRklMRU5BTUUgPSAncGVyc29uYS5tZCdcclxuXHJcbi8qKlxyXG4gKiBHRVQgL2FwaS9rbm93bGVkZ2UvcGVyc29uYVxyXG4gKiDoroDlj5YgUGVyc29uYSDlrprnvqlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJ1tBUEldIPCfk5Yg6K6A5Y+WIFBlcnNvbmEuLi4nKVxyXG5cclxuICAgIC8vIOiugOWPluaqlOahiFxyXG4gICAgY29uc3QgY29udGVudCA9IHJlYWRLbm93bGVkZ2VGaWxlKFBFUlNPTkFfRklMRU5BTUUpXHJcbiAgICBjb25zdCBtZXRhZGF0YSA9IGdldEZpbGVNZXRhZGF0YShQRVJTT05BX0ZJTEVOQU1FKVxyXG5cclxuICAgIC8vIOWIhuaekOe1kOani1xyXG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IHZhbGlkYXRlUGVyc29uYShjb250ZW50KVxyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlOiBBUElSZXNwb25zZTxQZXJzb25hQ29udGVudD4gPSB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICBjb250ZW50LFxyXG4gICAgICAgIG1ldGFkYXRhLFxyXG4gICAgICAgIHN0cnVjdHVyZToge1xyXG4gICAgICAgICAgc2VjdGlvbnM6IGV4dHJhY3RQZXJzb25hU2VjdGlvbnMoY29udGVudCksXHJcbiAgICAgICAgICBjb21wbGV0ZW5lc3M6IHZhbGlkYXRpb24uc2NvcmUgfHwgMCxcclxuICAgICAgICAgIGNvbnNpc3RlbmN5OiBjYWxjdWxhdGVDb25zaXN0ZW5jeShjb250ZW50KSxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB9LFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSlcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbQVBJXSDinYwg6K6A5Y+WIFBlcnNvbmEg5aSx5pWXOicsIGVycm9yKVxyXG5cclxuICAgIGNvbnN0IGVycm9yUmVzcG9uc2U6IEFQSVJlc3BvbnNlID0ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IHtcclxuICAgICAgICBjb2RlOiAnUkVBRF9FUlJPUicsXHJcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCAn6K6A5Y+WIFBlcnNvbmEg5aSx5pWXJyxcclxuICAgICAgICBkZXRhaWxzOiBlcnJvcixcclxuICAgICAgfSxcclxuICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfSxcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZXJyb3JSZXNwb25zZSwgeyBzdGF0dXM6IDUwMCB9KVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFBPU1QgL2FwaS9rbm93bGVkZ2UvcGVyc29uYVxyXG4gKiDmm7TmlrAgUGVyc29uYSDlrprnvqlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCdbQVBJXSDinI/vuI8gIOabtOaWsCBQZXJzb25hLi4uJylcclxuXHJcbiAgICAvLyDop6PmnpDoq4vmsYJcclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxyXG4gICAgY29uc3QgeyBjb250ZW50IH0gPSBib2R5XHJcblxyXG4gICAgaWYgKCFjb250ZW50IHx8IHR5cGVvZiBjb250ZW50ICE9PSAnc3RyaW5nJykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjoge1xyXG4gICAgICAgICAgICBjb2RlOiAnSU5WQUxJRF9JTlBVVCcsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdjb250ZW50IOashOS9jeW/hemgiOaYr+mdnuepuuWtl+S4sicsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0gYXMgQVBJUmVzcG9uc2UsXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyDpqZforYnlhaflrrlcclxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZVBlcnNvbmEoY29udGVudClcclxuXHJcbiAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6IHtcclxuICAgICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiAn5YWn5a656amX6K2J5aSx5pWXJyxcclxuICAgICAgICAgICAgZGV0YWlsczogdmFsaWRhdGlvbi5lcnJvcnMsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgd2FybmluZ3M6IHZhbGlkYXRpb24ud2FybmluZ3MsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0gYXMgQVBJUmVzcG9uc2UsXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyDlr6vlhaXmqpTmoYhcclxuICAgIGNvbnN0IG1ldGFkYXRhID0gd3JpdGVLbm93bGVkZ2VGaWxlKFBFUlNPTkFfRklMRU5BTUUsIGNvbnRlbnQpXHJcblxyXG4gICAgY29uc29sZS5sb2coJ1tBUEldIOKchSBQZXJzb25hIOW3suabtOaWsCcpXHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2U6IEFQSVJlc3BvbnNlPHsgbWV0YWRhdGE6IHR5cGVvZiBtZXRhZGF0YTsgdmFsaWRhdGlvbjogdHlwZW9mIHZhbGlkYXRpb24gfT4gPSB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICBtZXRhZGF0YSxcclxuICAgICAgICB2YWxpZGF0aW9uLFxyXG4gICAgICB9LFxyXG4gICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB9LFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSlcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbQVBJXSDinYwg5pu05pawIFBlcnNvbmEg5aSx5pWXOicsIGVycm9yKVxyXG5cclxuICAgIGNvbnN0IGVycm9yUmVzcG9uc2U6IEFQSVJlc3BvbnNlID0ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IHtcclxuICAgICAgICBjb2RlOiAnV1JJVEVfRVJST1InLFxyXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfHwgJ+abtOaWsCBQZXJzb25hIOWkseaVlycsXHJcbiAgICAgICAgZGV0YWlsczogZXJyb3IsXHJcbiAgICAgIH0sXHJcbiAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIH0sXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGVycm9yUmVzcG9uc2UsIHsgc3RhdHVzOiA1MDAgfSlcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIOi8lOWKqeWHveaVuFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIOaPkOWPliBQZXJzb25hIOeroOevgFxyXG4gKi9cclxuZnVuY3Rpb24gZXh0cmFjdFBlcnNvbmFTZWN0aW9ucyhjb250ZW50OiBzdHJpbmcpIHtcclxuICBjb25zdCBzZWN0aW9uczogQXJyYXk8e1xyXG4gICAgdGl0bGU6IHN0cmluZ1xyXG4gICAgY29udGVudDogc3RyaW5nXHJcbiAgICB3b3JkQ291bnQ6IG51bWJlclxyXG4gICAgaXNDb21wbGV0ZTogYm9vbGVhblxyXG4gICAgd2FybmluZ3M/OiBzdHJpbmdbXVxyXG4gIH0+ID0gW11cclxuXHJcbiAgY29uc3QgcmVxdWlyZWRTZWN0aW9ucyA9IFtcclxuICAgICfmoLjlv4Pouqvku70nLFxyXG4gICAgJ+a6nemAmumiqOagvOiIh+iqnuawoycsXHJcbiAgICAn5rG6562W5Y6f5YmHJyxcclxuICAgICflsIjmpa3poJjln58nLFxyXG4gICAgJ+S6kuWLleaooeW8jycsXHJcbiAgICAn6aCY5bCO6IiH566h55CG5ZOy5a24JyxcclxuICAgICflgIvkurrkv6Hlv7XoiIfmgJ3ntq3mqKHlnosnLFxyXG4gICAgJ+i8uOWHuuaooeadvycsXHJcbiAgICAn6Kme5b2Z6IiH6Kqe5rCj6KaP56+EJyxcclxuICAgICflj43llY/muIXllq4nLFxyXG4gIF1cclxuXHJcbiAgcmVxdWlyZWRTZWN0aW9ucy5mb3JFYWNoKChzZWN0aW9uVGl0bGUpID0+IHtcclxuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChcclxuICAgICAgYCMjXFxcXHMqXFxcXGQqXFxcXC4/XFxcXHMqJHtzZWN0aW9uVGl0bGV9KFtcXFxcc1xcXFxTXSo/KSg/PSMjfCQpYCxcclxuICAgICAgJ2knXHJcbiAgICApXHJcbiAgICBjb25zdCBtYXRjaCA9IGNvbnRlbnQubWF0Y2gocmVnZXgpXHJcblxyXG4gICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgIGNvbnN0IHNlY3Rpb25Db250ZW50ID0gbWF0Y2hbMV0udHJpbSgpXHJcbiAgICAgIGNvbnN0IHdvcmRDb3VudCA9IChzZWN0aW9uQ29udGVudC5tYXRjaCgvW1xcdTRlMDAtXFx1OWZhNWEtekEtWl0rL2cpIHx8IFtdKVxyXG4gICAgICAgIC5sZW5ndGhcclxuXHJcbiAgICAgIHNlY3Rpb25zLnB1c2goe1xyXG4gICAgICAgIHRpdGxlOiBzZWN0aW9uVGl0bGUsXHJcbiAgICAgICAgY29udGVudDogc2VjdGlvbkNvbnRlbnQsXHJcbiAgICAgICAgd29yZENvdW50LFxyXG4gICAgICAgIGlzQ29tcGxldGU6IHdvcmRDb3VudCA+PSAxMDAsXHJcbiAgICAgICAgd2FybmluZ3M6IHdvcmRDb3VudCA8IDEwMCA/IFsn5YWn5a656YGO55+t77yM5bu66K2w6KOc5YWF5pu05aSa57Sw56+AJ10gOiB1bmRlZmluZWQsXHJcbiAgICAgIH0pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWN0aW9ucy5wdXNoKHtcclxuICAgICAgICB0aXRsZTogc2VjdGlvblRpdGxlLFxyXG4gICAgICAgIGNvbnRlbnQ6ICcnLFxyXG4gICAgICAgIHdvcmRDb3VudDogMCxcclxuICAgICAgICBpc0NvbXBsZXRlOiBmYWxzZSxcclxuICAgICAgICB3YXJuaW5nczogWyfnvLrlsJHmraTnq6Dnr4AnXSxcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9KVxyXG5cclxuICByZXR1cm4gc2VjdGlvbnNcclxufVxyXG5cclxuLyoqXHJcbiAqIOioiOeul+iqnuawo+S4gOiHtOaAp1xyXG4gKiBAZGVzY3JpcHRpb24g57Ch5YyW54mI5a+m5L2c77yM5a+m6Zqb5Y+v5L2/55SoIE5MUCDliIbmnpBcclxuICovXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZUNvbnNpc3RlbmN5KGNvbnRlbnQ6IHN0cmluZyk6IG51bWJlciB7XHJcbiAgLy8g57Ch5Zau5ZWf55m85byP6KaP5YmH77ya5qqi5p+l5bi46KaL55So6Kme55qE5LiA6Ie05oCnXHJcbiAgY29uc3QgcHJvZmVzc2lvbmFsVGVybXMgPSBbXHJcbiAgICAn5pW45pOaJyxcclxuICAgICdST0knLFxyXG4gICAgJ0tQSScsXHJcbiAgICAn5ZWG5qWt5YO55YC8JyxcclxuICAgICfph4/ljJYnLFxyXG4gICAgJ+WIhuaekCcsXHJcbiAgXVxyXG4gIGNvbnN0IGNhc3VhbFRlcm1zID0gWyflj6/og70nLCAn5Lmf6KixJywgJ+Wkp+amgicsICfpmqjkvr8nXVxyXG5cclxuICBjb25zdCBwcm9mZXNzaW9uYWxDb3VudCA9IHByb2Zlc3Npb25hbFRlcm1zLmZpbHRlcigodGVybSkgPT5cclxuICAgIGNvbnRlbnQuaW5jbHVkZXModGVybSlcclxuICApLmxlbmd0aFxyXG4gIGNvbnN0IGNhc3VhbENvdW50ID0gY2FzdWFsVGVybXMuZmlsdGVyKCh0ZXJtKSA9PiBjb250ZW50LmluY2x1ZGVzKHRlcm0pKVxyXG4gICAgLmxlbmd0aFxyXG5cclxuICAvLyDlsIjmpa3nlKjoqZ7lpJogPSDkuIDoh7TmgKfpq5hcclxuICBjb25zdCBzY29yZSA9IHByb2Zlc3Npb25hbENvdW50ID4gY2FzdWFsQ291bnQgPyA4NSA6IDY1XHJcblxyXG4gIHJldHVybiBNYXRoLm1pbigxMDAsIHNjb3JlICsgTWF0aC5yYW5kb20oKSAqIDEwKSAvLyDliqDlhaXpmqjmqZ/ms6Lli5VcclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicmVhZEtub3dsZWRnZUZpbGUiLCJ3cml0ZUtub3dsZWRnZUZpbGUiLCJnZXRGaWxlTWV0YWRhdGEiLCJ2YWxpZGF0ZVBlcnNvbmEiLCJydW50aW1lIiwiUEVSU09OQV9GSUxFTkFNRSIsIkdFVCIsInJlcXVlc3QiLCJjb25zb2xlIiwibG9nIiwiY29udGVudCIsIm1ldGFkYXRhIiwidmFsaWRhdGlvbiIsInJlc3BvbnNlIiwic3VjY2VzcyIsImRhdGEiLCJzdHJ1Y3R1cmUiLCJzZWN0aW9ucyIsImV4dHJhY3RQZXJzb25hU2VjdGlvbnMiLCJjb21wbGV0ZW5lc3MiLCJzY29yZSIsImNvbnNpc3RlbmN5IiwiY2FsY3VsYXRlQ29uc2lzdGVuY3kiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJqc29uIiwiZXJyb3IiLCJlcnJvclJlc3BvbnNlIiwiY29kZSIsIm1lc3NhZ2UiLCJkZXRhaWxzIiwic3RhdHVzIiwiUE9TVCIsImJvZHkiLCJ2YWxpZCIsImVycm9ycyIsIndhcm5pbmdzIiwicmVxdWlyZWRTZWN0aW9ucyIsImZvckVhY2giLCJzZWN0aW9uVGl0bGUiLCJyZWdleCIsIlJlZ0V4cCIsIm1hdGNoIiwic2VjdGlvbkNvbnRlbnQiLCJ0cmltIiwid29yZENvdW50IiwibGVuZ3RoIiwicHVzaCIsInRpdGxlIiwiaXNDb21wbGV0ZSIsInVuZGVmaW5lZCIsInByb2Zlc3Npb25hbFRlcm1zIiwiY2FzdWFsVGVybXMiLCJwcm9mZXNzaW9uYWxDb3VudCIsImZpbHRlciIsInRlcm0iLCJpbmNsdWRlcyIsImNhc3VhbENvdW50IiwiTWF0aCIsIm1pbiIsInJhbmRvbSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/knowledge/persona/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/knowledge/file-manager.ts":
/*!***************************************!*\
  !*** ./lib/knowledge/file-manager.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   archiveKnowledgeFile: () => (/* binding */ archiveKnowledgeFile),\n/* harmony export */   archiveMultipleFiles: () => (/* binding */ archiveMultipleFiles),\n/* harmony export */   deleteKnowledgeFile: () => (/* binding */ deleteKnowledgeFile),\n/* harmony export */   extractIdFromFilename: () => (/* binding */ extractIdFromFilename),\n/* harmony export */   fileExists: () => (/* binding */ fileExists),\n/* harmony export */   filenameFromId: () => (/* binding */ filenameFromId),\n/* harmony export */   generateFilename: () => (/* binding */ generateFilename),\n/* harmony export */   getArchivePath: () => (/* binding */ getArchivePath),\n/* harmony export */   getFileMetadata: () => (/* binding */ getFileMetadata),\n/* harmony export */   getKnowledgeBasePath: () => (/* binding */ getKnowledgeBasePath),\n/* harmony export */   listFilesByType: () => (/* binding */ listFilesByType),\n/* harmony export */   listKnowledgeFiles: () => (/* binding */ listKnowledgeFiles),\n/* harmony export */   parseFAQFile: () => (/* binding */ parseFAQFile),\n/* harmony export */   parseKPIFile: () => (/* binding */ parseKPIFile),\n/* harmony export */   readKnowledgeFile: () => (/* binding */ readKnowledgeFile),\n/* harmony export */   serializeFAQToMarkdown: () => (/* binding */ serializeFAQToMarkdown),\n/* harmony export */   serializeKPIToMarkdown: () => (/* binding */ serializeKPIToMarkdown),\n/* harmony export */   writeKnowledgeFile: () => (/* binding */ writeKnowledgeFile)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/**\r\n * 知識庫檔案管理模組\r\n * @description 處理所有檔案系統操作（讀取、寫入、刪除、列表）\r\n */ \n\n// 知識庫根目錄\nconst KNOWLEDGE_BASE_PATH = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'agent-brain');\n// 歸檔目錄\nconst ARCHIVE_PATH = path__WEBPACK_IMPORTED_MODULE_1___default().join(KNOWLEDGE_BASE_PATH, 'archive');\n/**\r\n * 確保目錄存在\r\n */ function ensureDirectoryExists(dirPath) {\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(dirPath)) {\n        fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(dirPath, {\n            recursive: true\n        });\n    }\n}\n/**\r\n * 計算文字字數（中文按字數，英文按單字數）\r\n */ function countWords(text) {\n    // 中文字符\n    const chineseChars = text.match(/[\\u4e00-\\u9fa5]/g) || [];\n    // 英文單字\n    const englishWords = text.match(/[a-zA-Z]+/g) || [];\n    return chineseChars.length + englishWords.length;\n}\n/**\r\n * 獲取檔案元數據\r\n */ function getFileMetadata(filename) {\n    const filepath = path__WEBPACK_IMPORTED_MODULE_1___default().join(KNOWLEDGE_BASE_PATH, filename);\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(filepath)) {\n        throw new Error(`File not found: ${filename}`);\n    }\n    const stats = fs__WEBPACK_IMPORTED_MODULE_0___default().statSync(filepath);\n    const content = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(filepath, 'utf-8');\n    // 判斷檔案類型\n    let type = 'meeting' // 預設\n    ;\n    if (filename === 'persona.md') type = 'persona';\n    else if (filename === 'cdo_faq.md') type = 'faq';\n    else if (filename === 'kpi_dictionary.md') type = 'kpi';\n    else if (filename.startsWith('decision_log_')) type = 'decision';\n    else if (filename.startsWith('pov_briefing_')) type = 'pov';\n    else if (filename.startsWith('meeting_summary_')) type = 'meeting';\n    return {\n        filename,\n        type,\n        size: stats.size,\n        lastModified: stats.mtime.toISOString(),\n        wordCount: countWords(content),\n        createdAt: stats.birthtime.toISOString()\n    };\n}\n/**\r\n * 列出所有知識庫檔案\r\n */ function listKnowledgeFiles() {\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(KNOWLEDGE_BASE_PATH)) {\n        throw new Error('Knowledge base directory not found');\n    }\n    const files = fs__WEBPACK_IMPORTED_MODULE_0___default().readdirSync(KNOWLEDGE_BASE_PATH).filter((file)=>file.endsWith('.md')).filter((file)=>![\n            'README.md',\n            'KNOWLEDGE_BASE_GUIDE.md',\n            'TECHNICAL_FLOW.md',\n            'MAINTENANCE_GUIDE.md'\n        ].includes(file)) // 排除文件檔案\n    ;\n    return files.map((file)=>getFileMetadata(file));\n}\n/**\r\n * 按類型列出檔案\r\n */ function listFilesByType(type) {\n    const allFiles = listKnowledgeFiles();\n    return allFiles.filter((file)=>file.type === type);\n}\n/**\r\n * 讀取檔案內容\r\n */ function readKnowledgeFile(filename) {\n    const filepath = path__WEBPACK_IMPORTED_MODULE_1___default().join(KNOWLEDGE_BASE_PATH, filename);\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(filepath)) {\n        throw new Error(`File not found: ${filename}`);\n    }\n    return fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(filepath, 'utf-8');\n}\n/**\r\n * 寫入檔案內容\r\n */ function writeKnowledgeFile(filename, content) {\n    const filepath = path__WEBPACK_IMPORTED_MODULE_1___default().join(KNOWLEDGE_BASE_PATH, filename);\n    // 確保目錄存在\n    ensureDirectoryExists(KNOWLEDGE_BASE_PATH);\n    // 寫入檔案\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(filepath, content, 'utf-8');\n    console.log(`[FileManager] ✅ 檔案已儲存: ${filename}`);\n    return getFileMetadata(filename);\n}\n/**\r\n * 刪除檔案\r\n */ function deleteKnowledgeFile(filename) {\n    const filepath = path__WEBPACK_IMPORTED_MODULE_1___default().join(KNOWLEDGE_BASE_PATH, filename);\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(filepath)) {\n        throw new Error(`File not found: ${filename}`);\n    }\n    fs__WEBPACK_IMPORTED_MODULE_0___default().unlinkSync(filepath);\n    console.log(`[FileManager] 🗑️  檔案已刪除: ${filename}`);\n}\n/**\r\n * 歸檔檔案（移動到 archive 目錄）\r\n */ function archiveKnowledgeFile(filename, archiveSubPath) {\n    const sourcePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(KNOWLEDGE_BASE_PATH, filename);\n    const archiveDir = archiveSubPath ? path__WEBPACK_IMPORTED_MODULE_1___default().join(ARCHIVE_PATH, archiveSubPath) : ARCHIVE_PATH;\n    ensureDirectoryExists(archiveDir);\n    const destPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(archiveDir, filename);\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(sourcePath)) {\n        throw new Error(`File not found: ${filename}`);\n    }\n    // 移動檔案\n    fs__WEBPACK_IMPORTED_MODULE_0___default().renameSync(sourcePath, destPath);\n    console.log(`[FileManager] 📁 檔案已歸檔: ${filename} → ${archiveSubPath}`);\n}\n/**\r\n * 批次歸檔檔案\r\n */ function archiveMultipleFiles(filenames, archiveSubPath) {\n    filenames.forEach((filename)=>{\n        try {\n            archiveKnowledgeFile(filename, archiveSubPath);\n        } catch (error) {\n            console.error(`[FileManager] ❌ 歸檔失敗: ${filename}`, error);\n        }\n    });\n}\n/**\r\n * 生成新的檔案名稱\r\n * @param type 檔案類型\r\n * @param identifier 識別符（例如專案名稱、會議主題）\r\n * @returns 檔案名稱（不含路徑）\r\n */ function generateFilename(type, identifier) {\n    const date = new Date().toISOString().split('T')[0] // YYYY-MM-DD\n    ;\n    const sanitized = identifier.replace(/[^a-zA-Z0-9\\u4e00-\\u9fa5_-]/g, '_') // 移除特殊字符\n    .substring(0, 50) // 限制長度\n    ;\n    switch(type){\n        case 'decision':\n            return `decision_log_${sanitized}.md`;\n        case 'pov':\n            return `pov_briefing_${sanitized}.md`;\n        case 'meeting':\n            return `meeting_summary_${date}_${sanitized}.md`;\n        default:\n            return `${type}_${date}_${sanitized}.md`;\n    }\n}\n/**\r\n * 從檔案名稱提取 ID\r\n */ function extractIdFromFilename(filename) {\n    return filename.replace('.md', '');\n}\n/**\r\n * 從 ID 生成檔案名稱\r\n */ function filenameFromId(id) {\n    return id.endsWith('.md') ? id : `${id}.md`;\n}\n/**\r\n * 檢查檔案是否存在\r\n */ function fileExists(filename) {\n    const filepath = path__WEBPACK_IMPORTED_MODULE_1___default().join(KNOWLEDGE_BASE_PATH, filename);\n    return fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(filepath);\n}\n/**\r\n * 取得知識庫根目錄路徑\r\n */ function getKnowledgeBasePath() {\n    return KNOWLEDGE_BASE_PATH;\n}\n/**\r\n * 取得歸檔目錄路徑\r\n */ function getArchivePath() {\n    return ARCHIVE_PATH;\n}\n// ============================================\n// 輔助函數：結構化解析特定類型檔案\n// ============================================\n/**\r\n * 解析 FAQ 檔案為結構化資料\r\n */ function parseFAQFile(content) {\n    const items = [];\n    const regex = /### (Q\\d+):\\s*(.+?)\\n\\*\\*A\\*\\*:\\s*(.+?)(?=\\n###|$)/gs;\n    let match;\n    while((match = regex.exec(content)) !== null){\n        const [, id, question, answer] = match;\n        items.push({\n            id: id.toLowerCase(),\n            question: question.trim(),\n            answer: answer.trim(),\n            tags: [],\n            keywords: extractKeywords(question + ' ' + answer),\n            usage: 0,\n            lastModified: new Date().toISOString()\n        });\n    }\n    return items;\n}\n/**\r\n * 將 FAQ 結構化資料轉換為 Markdown\r\n */ function serializeFAQToMarkdown(items) {\n    let markdown = '# CDO 常見問題與標準回答 (FAQ)\\n\\n';\n    items.forEach((item, index)=>{\n        markdown += `### Q${index + 1}: ${item.question}\\n`;\n        markdown += `**A**: ${item.answer}\\n\\n`;\n    });\n    return markdown;\n}\n/**\r\n * 簡單關鍵字提取（基於頻率）\r\n */ function extractKeywords(text) {\n    const words = text.match(/[\\u4e00-\\u9fa5]{2,}|[a-zA-Z]{3,}/g) || [];\n    const frequency = {};\n    words.forEach((word)=>{\n        frequency[word] = (frequency[word] || 0) + 1;\n    });\n    return Object.entries(frequency).sort((a, b)=>b[1] - a[1]).slice(0, 10).map(([word])=>word);\n}\n/**\r\n * 解析 KPI 檔案為結構化資料\r\n */ function parseKPIFile(content) {\n    const items = [];\n    const regex = /### (.+?)\\n- \\*\\*定義\\*\\*:\\s*(.+?)\\n- \\*\\*計算\\*\\*:\\s*(.+?)(?=\\n###|$)/gs;\n    let match;\n    while((match = regex.exec(content)) !== null){\n        const [, name, definition, calculation] = match;\n        items.push({\n            id: name.toLowerCase().replace(/\\s+/g, '_'),\n            name: name.trim(),\n            definition: definition.trim(),\n            calculation: calculation.trim(),\n            dataSource: '',\n            owner: '',\n            tags: [],\n            updateFrequency: 'daily',\n            lastModified: new Date().toISOString()\n        });\n    }\n    return items;\n}\n/**\r\n * 將 KPI 結構化資料轉換為 Markdown\r\n */ function serializeKPIToMarkdown(items) {\n    let markdown = '# KPI 定義字典 (KPI Dictionary)\\n\\n';\n    items.forEach((item)=>{\n        markdown += `### ${item.name}\\n`;\n        markdown += `- **定義**: ${item.definition}\\n`;\n        markdown += `- **計算**: ${item.calculation}\\n`;\n        markdown += `- **數據來源**: ${item.dataSource}\\n`;\n        markdown += `- **負責團隊**: ${item.owner}\\n\\n`;\n    });\n    return markdown;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVksQ0FBQyxVQUFVLEVBQUVDLEtBQUtjLFdBQVcsQ0FBQyxFQUFFLENBQUM7UUFDN0NmLFlBQVksQ0FBQyxZQUFZLEVBQUVDLEtBQUtlLFVBQVUsQ0FBQyxFQUFFLENBQUM7UUFDOUNoQixZQUFZLENBQUMsWUFBWSxFQUFFQyxLQUFLZ0IsS0FBSyxDQUFDLElBQUksQ0FBQztJQUM3QztJQUVBLE9BQU9qQjtBQUNUIiwic291cmNlcyI6WyJDOlxcc21hcnQtYWktYXZhdGFyLWFnZW50XFxsaWJcXGtub3dsZWRnZVxcZmlsZS1tYW5hZ2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDnn6XorZjluqvmqpTmoYjnrqHnkIbmqKHntYRcclxuICogQGRlc2NyaXB0aW9uIOiZleeQhuaJgOacieaqlOahiOezu+e1seaTjeS9nO+8iOiugOWPluOAgeWvq+WFpeOAgeWIqumZpOOAgeWIl+ihqO+8iVxyXG4gKi9cclxuXHJcbmltcG9ydCBmcyBmcm9tICdmcydcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcclxuaW1wb3J0IHR5cGUge1xyXG4gIEZpbGVNZXRhZGF0YSxcclxuICBLbm93bGVkZ2VGaWxlVHlwZSxcclxuICBGQVFJdGVtLFxyXG4gIEtQSUl0ZW0sXHJcbiAgRGVjaXNpb25Mb2dJdGVtLFxyXG4gIE1lZXRpbmdTdW1tYXJ5SXRlbSxcclxuICBQT1ZCcmllZmluZ0l0ZW0sXHJcbn0gZnJvbSAnQC90eXBlcy9rbm93bGVkZ2UnXHJcblxyXG4vLyDnn6XorZjluqvmoLnnm67pjIRcclxuY29uc3QgS05PV0xFREdFX0JBU0VfUEFUSCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnYWdlbnQtYnJhaW4nKVxyXG5cclxuLy8g5q245qqU55uu6YyEXHJcbmNvbnN0IEFSQ0hJVkVfUEFUSCA9IHBhdGguam9pbihLTk9XTEVER0VfQkFTRV9QQVRILCAnYXJjaGl2ZScpXHJcblxyXG4vKipcclxuICog56K65L+d55uu6YyE5a2Y5ZyoXHJcbiAqL1xyXG5mdW5jdGlvbiBlbnN1cmVEaXJlY3RvcnlFeGlzdHMoZGlyUGF0aDogc3RyaW5nKTogdm9pZCB7XHJcbiAgaWYgKCFmcy5leGlzdHNTeW5jKGRpclBhdGgpKSB7XHJcbiAgICBmcy5ta2RpclN5bmMoZGlyUGF0aCwgeyByZWN1cnNpdmU6IHRydWUgfSlcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDoqIjnrpfmloflrZflrZfmlbjvvIjkuK3mlofmjInlrZfmlbjvvIzoi7HmlofmjInllq7lrZfmlbjvvIlcclxuICovXHJcbmZ1bmN0aW9uIGNvdW50V29yZHModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcclxuICAvLyDkuK3mloflrZfnrKZcclxuICBjb25zdCBjaGluZXNlQ2hhcnMgPSB0ZXh0Lm1hdGNoKC9bXFx1NGUwMC1cXHU5ZmE1XS9nKSB8fCBbXVxyXG4gIC8vIOiLseaWh+WWruWtl1xyXG4gIGNvbnN0IGVuZ2xpc2hXb3JkcyA9IHRleHQubWF0Y2goL1thLXpBLVpdKy9nKSB8fCBbXVxyXG5cclxuICByZXR1cm4gY2hpbmVzZUNoYXJzLmxlbmd0aCArIGVuZ2xpc2hXb3Jkcy5sZW5ndGhcclxufVxyXG5cclxuLyoqXHJcbiAqIOeNsuWPluaqlOahiOWFg+aVuOaTmlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVNZXRhZGF0YShmaWxlbmFtZTogc3RyaW5nKTogRmlsZU1ldGFkYXRhIHtcclxuICBjb25zdCBmaWxlcGF0aCA9IHBhdGguam9pbihLTk9XTEVER0VfQkFTRV9QQVRILCBmaWxlbmFtZSlcclxuXHJcbiAgaWYgKCFmcy5leGlzdHNTeW5jKGZpbGVwYXRoKSkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlIG5vdCBmb3VuZDogJHtmaWxlbmFtZX1gKVxyXG4gIH1cclxuXHJcbiAgY29uc3Qgc3RhdHMgPSBmcy5zdGF0U3luYyhmaWxlcGF0aClcclxuICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVwYXRoLCAndXRmLTgnKVxyXG5cclxuICAvLyDliKTmlrfmqpTmoYjpoZ7lnotcclxuICBsZXQgdHlwZTogS25vd2xlZGdlRmlsZVR5cGUgPSAnbWVldGluZycgLy8g6aCQ6KitXHJcblxyXG4gIGlmIChmaWxlbmFtZSA9PT0gJ3BlcnNvbmEubWQnKSB0eXBlID0gJ3BlcnNvbmEnXHJcbiAgZWxzZSBpZiAoZmlsZW5hbWUgPT09ICdjZG9fZmFxLm1kJykgdHlwZSA9ICdmYXEnXHJcbiAgZWxzZSBpZiAoZmlsZW5hbWUgPT09ICdrcGlfZGljdGlvbmFyeS5tZCcpIHR5cGUgPSAna3BpJ1xyXG4gIGVsc2UgaWYgKGZpbGVuYW1lLnN0YXJ0c1dpdGgoJ2RlY2lzaW9uX2xvZ18nKSkgdHlwZSA9ICdkZWNpc2lvbidcclxuICBlbHNlIGlmIChmaWxlbmFtZS5zdGFydHNXaXRoKCdwb3ZfYnJpZWZpbmdfJykpIHR5cGUgPSAncG92J1xyXG4gIGVsc2UgaWYgKGZpbGVuYW1lLnN0YXJ0c1dpdGgoJ21lZXRpbmdfc3VtbWFyeV8nKSkgdHlwZSA9ICdtZWV0aW5nJ1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgZmlsZW5hbWUsXHJcbiAgICB0eXBlLFxyXG4gICAgc2l6ZTogc3RhdHMuc2l6ZSxcclxuICAgIGxhc3RNb2RpZmllZDogc3RhdHMubXRpbWUudG9JU09TdHJpbmcoKSxcclxuICAgIHdvcmRDb3VudDogY291bnRXb3Jkcyhjb250ZW50KSxcclxuICAgIGNyZWF0ZWRBdDogc3RhdHMuYmlydGh0aW1lLnRvSVNPU3RyaW5nKCksXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog5YiX5Ye65omA5pyJ55+l6K2Y5bqr5qqU5qGIXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbGlzdEtub3dsZWRnZUZpbGVzKCk6IEZpbGVNZXRhZGF0YVtdIHtcclxuICBpZiAoIWZzLmV4aXN0c1N5bmMoS05PV0xFREdFX0JBU0VfUEFUSCkpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignS25vd2xlZGdlIGJhc2UgZGlyZWN0b3J5IG5vdCBmb3VuZCcpXHJcbiAgfVxyXG5cclxuICBjb25zdCBmaWxlcyA9IGZzXHJcbiAgICAucmVhZGRpclN5bmMoS05PV0xFREdFX0JBU0VfUEFUSClcclxuICAgIC5maWx0ZXIoKGZpbGUpID0+IGZpbGUuZW5kc1dpdGgoJy5tZCcpKVxyXG4gICAgLmZpbHRlcihcclxuICAgICAgKGZpbGUpID0+XHJcbiAgICAgICAgIVtcclxuICAgICAgICAgICdSRUFETUUubWQnLFxyXG4gICAgICAgICAgJ0tOT1dMRURHRV9CQVNFX0dVSURFLm1kJyxcclxuICAgICAgICAgICdURUNITklDQUxfRkxPVy5tZCcsXHJcbiAgICAgICAgICAnTUFJTlRFTkFOQ0VfR1VJREUubWQnLFxyXG4gICAgICAgIF0uaW5jbHVkZXMoZmlsZSlcclxuICAgICkgLy8g5o6S6Zmk5paH5Lu25qqU5qGIXHJcblxyXG4gIHJldHVybiBmaWxlcy5tYXAoKGZpbGUpID0+IGdldEZpbGVNZXRhZGF0YShmaWxlKSlcclxufVxyXG5cclxuLyoqXHJcbiAqIOaMiemhnuWei+WIl+WHuuaqlOahiFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RGaWxlc0J5VHlwZSh0eXBlOiBLbm93bGVkZ2VGaWxlVHlwZSk6IEZpbGVNZXRhZGF0YVtdIHtcclxuICBjb25zdCBhbGxGaWxlcyA9IGxpc3RLbm93bGVkZ2VGaWxlcygpXHJcbiAgcmV0dXJuIGFsbEZpbGVzLmZpbHRlcigoZmlsZSkgPT4gZmlsZS50eXBlID09PSB0eXBlKVxyXG59XHJcblxyXG4vKipcclxuICog6K6A5Y+W5qqU5qGI5YWn5a65XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVhZEtub3dsZWRnZUZpbGUoZmlsZW5hbWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgZmlsZXBhdGggPSBwYXRoLmpvaW4oS05PV0xFREdFX0JBU0VfUEFUSCwgZmlsZW5hbWUpXHJcblxyXG4gIGlmICghZnMuZXhpc3RzU3luYyhmaWxlcGF0aCkpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihgRmlsZSBub3QgZm91bmQ6ICR7ZmlsZW5hbWV9YClcclxuICB9XHJcblxyXG4gIHJldHVybiBmcy5yZWFkRmlsZVN5bmMoZmlsZXBhdGgsICd1dGYtOCcpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlr6vlhaXmqpTmoYjlhaflrrlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB3cml0ZUtub3dsZWRnZUZpbGUoXHJcbiAgZmlsZW5hbWU6IHN0cmluZyxcclxuICBjb250ZW50OiBzdHJpbmdcclxuKTogRmlsZU1ldGFkYXRhIHtcclxuICBjb25zdCBmaWxlcGF0aCA9IHBhdGguam9pbihLTk9XTEVER0VfQkFTRV9QQVRILCBmaWxlbmFtZSlcclxuXHJcbiAgLy8g56K65L+d55uu6YyE5a2Y5ZyoXHJcbiAgZW5zdXJlRGlyZWN0b3J5RXhpc3RzKEtOT1dMRURHRV9CQVNFX1BBVEgpXHJcblxyXG4gIC8vIOWvq+WFpeaqlOahiFxyXG4gIGZzLndyaXRlRmlsZVN5bmMoZmlsZXBhdGgsIGNvbnRlbnQsICd1dGYtOCcpXHJcblxyXG4gIGNvbnNvbGUubG9nKGBbRmlsZU1hbmFnZXJdIOKchSDmqpTmoYjlt7LlhLLlrZg6ICR7ZmlsZW5hbWV9YClcclxuXHJcbiAgcmV0dXJuIGdldEZpbGVNZXRhZGF0YShmaWxlbmFtZSlcclxufVxyXG5cclxuLyoqXHJcbiAqIOWIqumZpOaqlOahiFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUtub3dsZWRnZUZpbGUoZmlsZW5hbWU6IHN0cmluZyk6IHZvaWQge1xyXG4gIGNvbnN0IGZpbGVwYXRoID0gcGF0aC5qb2luKEtOT1dMRURHRV9CQVNFX1BBVEgsIGZpbGVuYW1lKVxyXG5cclxuICBpZiAoIWZzLmV4aXN0c1N5bmMoZmlsZXBhdGgpKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGUgbm90IGZvdW5kOiAke2ZpbGVuYW1lfWApXHJcbiAgfVxyXG5cclxuICBmcy51bmxpbmtTeW5jKGZpbGVwYXRoKVxyXG4gIGNvbnNvbGUubG9nKGBbRmlsZU1hbmFnZXJdIPCfl5HvuI8gIOaqlOahiOW3suWIqumZpDogJHtmaWxlbmFtZX1gKVxyXG59XHJcblxyXG4vKipcclxuICog5q245qqU5qqU5qGI77yI56e75YuV5YiwIGFyY2hpdmUg55uu6YyE77yJXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYXJjaGl2ZUtub3dsZWRnZUZpbGUoXHJcbiAgZmlsZW5hbWU6IHN0cmluZyxcclxuICBhcmNoaXZlU3ViUGF0aD86IHN0cmluZ1xyXG4pOiB2b2lkIHtcclxuICBjb25zdCBzb3VyY2VQYXRoID0gcGF0aC5qb2luKEtOT1dMRURHRV9CQVNFX1BBVEgsIGZpbGVuYW1lKVxyXG4gIGNvbnN0IGFyY2hpdmVEaXIgPSBhcmNoaXZlU3ViUGF0aFxyXG4gICAgPyBwYXRoLmpvaW4oQVJDSElWRV9QQVRILCBhcmNoaXZlU3ViUGF0aClcclxuICAgIDogQVJDSElWRV9QQVRIXHJcblxyXG4gIGVuc3VyZURpcmVjdG9yeUV4aXN0cyhhcmNoaXZlRGlyKVxyXG5cclxuICBjb25zdCBkZXN0UGF0aCA9IHBhdGguam9pbihhcmNoaXZlRGlyLCBmaWxlbmFtZSlcclxuXHJcbiAgaWYgKCFmcy5leGlzdHNTeW5jKHNvdXJjZVBhdGgpKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGUgbm90IGZvdW5kOiAke2ZpbGVuYW1lfWApXHJcbiAgfVxyXG5cclxuICAvLyDnp7vli5XmqpTmoYhcclxuICBmcy5yZW5hbWVTeW5jKHNvdXJjZVBhdGgsIGRlc3RQYXRoKVxyXG4gIGNvbnNvbGUubG9nKGBbRmlsZU1hbmFnZXJdIPCfk4Eg5qqU5qGI5bey5q245qqUOiAke2ZpbGVuYW1lfSDihpIgJHthcmNoaXZlU3ViUGF0aH1gKVxyXG59XHJcblxyXG4vKipcclxuICog5om55qyh5q245qqU5qqU5qGIXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYXJjaGl2ZU11bHRpcGxlRmlsZXMoXHJcbiAgZmlsZW5hbWVzOiBzdHJpbmdbXSxcclxuICBhcmNoaXZlU3ViUGF0aDogc3RyaW5nXHJcbik6IHZvaWQge1xyXG4gIGZpbGVuYW1lcy5mb3JFYWNoKChmaWxlbmFtZSkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXJjaGl2ZUtub3dsZWRnZUZpbGUoZmlsZW5hbWUsIGFyY2hpdmVTdWJQYXRoKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgW0ZpbGVNYW5hZ2VyXSDinYwg5q245qqU5aSx5pWXOiAke2ZpbGVuYW1lfWAsIGVycm9yKVxyXG4gICAgfVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDnlJ/miJDmlrDnmoTmqpTmoYjlkI3nqLFcclxuICogQHBhcmFtIHR5cGUg5qqU5qGI6aGe5Z6LXHJcbiAqIEBwYXJhbSBpZGVudGlmaWVyIOitmOWIpeespu+8iOS+i+WmguWwiOahiOWQjeeoseOAgeacg+itsOS4u+mhjO+8iVxyXG4gKiBAcmV0dXJucyDmqpTmoYjlkI3nqLHvvIjkuI3lkKvot6/lvpHvvIlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUZpbGVuYW1lKFxyXG4gIHR5cGU6IEtub3dsZWRnZUZpbGVUeXBlLFxyXG4gIGlkZW50aWZpZXI6IHN0cmluZ1xyXG4pOiBzdHJpbmcge1xyXG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSAvLyBZWVlZLU1NLUREXHJcbiAgY29uc3Qgc2FuaXRpemVkID0gaWRlbnRpZmllclxyXG4gICAgLnJlcGxhY2UoL1teYS16QS1aMC05XFx1NGUwMC1cXHU5ZmE1Xy1dL2csICdfJykgLy8g56e76Zmk54m55q6K5a2X56ymXHJcbiAgICAuc3Vic3RyaW5nKDAsIDUwKSAvLyDpmZDliLbplbfluqZcclxuXHJcbiAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICBjYXNlICdkZWNpc2lvbic6XHJcbiAgICAgIHJldHVybiBgZGVjaXNpb25fbG9nXyR7c2FuaXRpemVkfS5tZGBcclxuICAgIGNhc2UgJ3Bvdic6XHJcbiAgICAgIHJldHVybiBgcG92X2JyaWVmaW5nXyR7c2FuaXRpemVkfS5tZGBcclxuICAgIGNhc2UgJ21lZXRpbmcnOlxyXG4gICAgICByZXR1cm4gYG1lZXRpbmdfc3VtbWFyeV8ke2RhdGV9XyR7c2FuaXRpemVkfS5tZGBcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIHJldHVybiBgJHt0eXBlfV8ke2RhdGV9XyR7c2FuaXRpemVkfS5tZGBcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlvp7mqpTmoYjlkI3nqLHmj5Dlj5YgSURcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0SWRGcm9tRmlsZW5hbWUoZmlsZW5hbWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGZpbGVuYW1lLnJlcGxhY2UoJy5tZCcsICcnKVxyXG59XHJcblxyXG4vKipcclxuICog5b6eIElEIOeUn+aIkOaqlOahiOWQjeeosVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbGVuYW1lRnJvbUlkKGlkOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiBpZC5lbmRzV2l0aCgnLm1kJykgPyBpZCA6IGAke2lkfS5tZGBcclxufVxyXG5cclxuLyoqXHJcbiAqIOaqouafpeaqlOahiOaYr+WQpuWtmOWcqFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbGVFeGlzdHMoZmlsZW5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IGZpbGVwYXRoID0gcGF0aC5qb2luKEtOT1dMRURHRV9CQVNFX1BBVEgsIGZpbGVuYW1lKVxyXG4gIHJldHVybiBmcy5leGlzdHNTeW5jKGZpbGVwYXRoKVxyXG59XHJcblxyXG4vKipcclxuICog5Y+W5b6X55+l6K2Y5bqr5qC555uu6YyE6Lev5b6RXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0S25vd2xlZGdlQmFzZVBhdGgoKTogc3RyaW5nIHtcclxuICByZXR1cm4gS05PV0xFREdFX0JBU0VfUEFUSFxyXG59XHJcblxyXG4vKipcclxuICog5Y+W5b6X5q245qqU55uu6YyE6Lev5b6RXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXJjaGl2ZVBhdGgoKTogc3RyaW5nIHtcclxuICByZXR1cm4gQVJDSElWRV9QQVRIXHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIOi8lOWKqeWHveaVuO+8mue1kOani+WMluino+aekOeJueWumumhnuWei+aqlOahiFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIOino+aekCBGQVEg5qqU5qGI54K657WQ5qeL5YyW6LOH5paZXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VGQVFGaWxlKGNvbnRlbnQ6IHN0cmluZyk6IEZBUUl0ZW1bXSB7XHJcbiAgY29uc3QgaXRlbXM6IEZBUUl0ZW1bXSA9IFtdXHJcbiAgY29uc3QgcmVnZXggPSAvIyMjIChRXFxkKyk6XFxzKiguKz8pXFxuXFwqXFwqQVxcKlxcKjpcXHMqKC4rPykoPz1cXG4jIyN8JCkvZ3NcclxuXHJcbiAgbGV0IG1hdGNoXHJcbiAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XHJcbiAgICBjb25zdCBbLCBpZCwgcXVlc3Rpb24sIGFuc3dlcl0gPSBtYXRjaFxyXG5cclxuICAgIGl0ZW1zLnB1c2goe1xyXG4gICAgICBpZDogaWQudG9Mb3dlckNhc2UoKSxcclxuICAgICAgcXVlc3Rpb246IHF1ZXN0aW9uLnRyaW0oKSxcclxuICAgICAgYW5zd2VyOiBhbnN3ZXIudHJpbSgpLFxyXG4gICAgICB0YWdzOiBbXSwgLy8g6ZyA6KaB6aGN5aSW6Kej5p6QIHRhZ3NcclxuICAgICAga2V5d29yZHM6IGV4dHJhY3RLZXl3b3JkcyhxdWVzdGlvbiArICcgJyArIGFuc3dlciksXHJcbiAgICAgIHVzYWdlOiAwLFxyXG4gICAgICBsYXN0TW9kaWZpZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICByZXR1cm4gaXRlbXNcclxufVxyXG5cclxuLyoqXHJcbiAqIOWwhyBGQVEg57WQ5qeL5YyW6LOH5paZ6L2J5o+b54K6IE1hcmtkb3duXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2VyaWFsaXplRkFRVG9NYXJrZG93bihpdGVtczogRkFRSXRlbVtdKTogc3RyaW5nIHtcclxuICBsZXQgbWFya2Rvd24gPSAnIyBDRE8g5bi46KaL5ZWP6aGM6IiH5qiZ5rqW5Zue562UIChGQVEpXFxuXFxuJ1xyXG5cclxuICBpdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgbWFya2Rvd24gKz0gYCMjIyBRJHtpbmRleCArIDF9OiAke2l0ZW0ucXVlc3Rpb259XFxuYFxyXG4gICAgbWFya2Rvd24gKz0gYCoqQSoqOiAke2l0ZW0uYW5zd2VyfVxcblxcbmBcclxuICB9KVxyXG5cclxuICByZXR1cm4gbWFya2Rvd25cclxufVxyXG5cclxuLyoqXHJcbiAqIOewoeWWrumXnOmNteWtl+aPkOWPlu+8iOWfuuaWvOmgu+eOh++8iVxyXG4gKi9cclxuZnVuY3Rpb24gZXh0cmFjdEtleXdvcmRzKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICBjb25zdCB3b3JkcyA9IHRleHQubWF0Y2goL1tcXHU0ZTAwLVxcdTlmYTVdezIsfXxbYS16QS1aXXszLH0vZykgfHwgW11cclxuICBjb25zdCBmcmVxdWVuY3k6IHsgW3dvcmQ6IHN0cmluZ106IG51bWJlciB9ID0ge31cclxuXHJcbiAgd29yZHMuZm9yRWFjaCgod29yZCkgPT4ge1xyXG4gICAgZnJlcXVlbmN5W3dvcmRdID0gKGZyZXF1ZW5jeVt3b3JkXSB8fCAwKSArIDFcclxuICB9KVxyXG5cclxuICByZXR1cm4gT2JqZWN0LmVudHJpZXMoZnJlcXVlbmN5KVxyXG4gICAgLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKVxyXG4gICAgLnNsaWNlKDAsIDEwKVxyXG4gICAgLm1hcCgoW3dvcmRdKSA9PiB3b3JkKVxyXG59XHJcblxyXG4vKipcclxuICog6Kej5p6QIEtQSSDmqpTmoYjngrrntZDmp4vljJbos4fmlplcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUtQSUZpbGUoY29udGVudDogc3RyaW5nKTogS1BJSXRlbVtdIHtcclxuICBjb25zdCBpdGVtczogS1BJSXRlbVtdID0gW11cclxuICBjb25zdCByZWdleCA9IC8jIyMgKC4rPylcXG4tIFxcKlxcKuWumue+qVxcKlxcKjpcXHMqKC4rPylcXG4tIFxcKlxcKuioiOeul1xcKlxcKjpcXHMqKC4rPykoPz1cXG4jIyN8JCkvZ3NcclxuXHJcbiAgbGV0IG1hdGNoXHJcbiAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XHJcbiAgICBjb25zdCBbLCBuYW1lLCBkZWZpbml0aW9uLCBjYWxjdWxhdGlvbl0gPSBtYXRjaFxyXG5cclxuICAgIGl0ZW1zLnB1c2goe1xyXG4gICAgICBpZDogbmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJ18nKSxcclxuICAgICAgbmFtZTogbmFtZS50cmltKCksXHJcbiAgICAgIGRlZmluaXRpb246IGRlZmluaXRpb24udHJpbSgpLFxyXG4gICAgICBjYWxjdWxhdGlvbjogY2FsY3VsYXRpb24udHJpbSgpLFxyXG4gICAgICBkYXRhU291cmNlOiAnJywgLy8g6ZyA6KaB6aGN5aSW6Kej5p6QXHJcbiAgICAgIG93bmVyOiAnJyxcclxuICAgICAgdGFnczogW10sXHJcbiAgICAgIHVwZGF0ZUZyZXF1ZW5jeTogJ2RhaWx5JyxcclxuICAgICAgbGFzdE1vZGlmaWVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGl0ZW1zXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDlsIcgS1BJIOe1kOani+WMluizh+aWmei9ieaPm+eCuiBNYXJrZG93blxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNlcmlhbGl6ZUtQSVRvTWFya2Rvd24oaXRlbXM6IEtQSUl0ZW1bXSk6IHN0cmluZyB7XHJcbiAgbGV0IG1hcmtkb3duID0gJyMgS1BJIOWumue+qeWtl+WFuCAoS1BJIERpY3Rpb25hcnkpXFxuXFxuJ1xyXG5cclxuICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICBtYXJrZG93biArPSBgIyMjICR7aXRlbS5uYW1lfVxcbmBcclxuICAgIG1hcmtkb3duICs9IGAtICoq5a6a576pKio6ICR7aXRlbS5kZWZpbml0aW9ufVxcbmBcclxuICAgIG1hcmtkb3duICs9IGAtICoq6KiI566XKio6ICR7aXRlbS5jYWxjdWxhdGlvbn1cXG5gXHJcbiAgICBtYXJrZG93biArPSBgLSAqKuaVuOaTmuS+hua6kCoqOiAke2l0ZW0uZGF0YVNvdXJjZX1cXG5gXHJcbiAgICBtYXJrZG93biArPSBgLSAqKuiyoOiyrOWcmOmaiioqOiAke2l0ZW0ub3duZXJ9XFxuXFxuYFxyXG4gIH0pXHJcblxyXG4gIHJldHVybiBtYXJrZG93blxyXG59XHJcbiJdLCJuYW1lcyI6WyJmcyIsInBhdGgiLCJLTk9XTEVER0VfQkFTRV9QQVRIIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJBUkNISVZFX1BBVEgiLCJlbnN1cmVEaXJlY3RvcnlFeGlzdHMiLCJkaXJQYXRoIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsImNvdW50V29yZHMiLCJ0ZXh0IiwiY2hpbmVzZUNoYXJzIiwibWF0Y2giLCJlbmdsaXNoV29yZHMiLCJsZW5ndGgiLCJnZXRGaWxlTWV0YWRhdGEiLCJmaWxlbmFtZSIsImZpbGVwYXRoIiwiRXJyb3IiLCJzdGF0cyIsInN0YXRTeW5jIiwiY29udGVudCIsInJlYWRGaWxlU3luYyIsInR5cGUiLCJzdGFydHNXaXRoIiwic2l6ZSIsImxhc3RNb2RpZmllZCIsIm10aW1lIiwidG9JU09TdHJpbmciLCJ3b3JkQ291bnQiLCJjcmVhdGVkQXQiLCJiaXJ0aHRpbWUiLCJsaXN0S25vd2xlZGdlRmlsZXMiLCJmaWxlcyIsInJlYWRkaXJTeW5jIiwiZmlsdGVyIiwiZmlsZSIsImVuZHNXaXRoIiwiaW5jbHVkZXMiLCJtYXAiLCJsaXN0RmlsZXNCeVR5cGUiLCJhbGxGaWxlcyIsInJlYWRLbm93bGVkZ2VGaWxlIiwid3JpdGVLbm93bGVkZ2VGaWxlIiwid3JpdGVGaWxlU3luYyIsImNvbnNvbGUiLCJsb2ciLCJkZWxldGVLbm93bGVkZ2VGaWxlIiwidW5saW5rU3luYyIsImFyY2hpdmVLbm93bGVkZ2VGaWxlIiwiYXJjaGl2ZVN1YlBhdGgiLCJzb3VyY2VQYXRoIiwiYXJjaGl2ZURpciIsImRlc3RQYXRoIiwicmVuYW1lU3luYyIsImFyY2hpdmVNdWx0aXBsZUZpbGVzIiwiZmlsZW5hbWVzIiwiZm9yRWFjaCIsImVycm9yIiwiZ2VuZXJhdGVGaWxlbmFtZSIsImlkZW50aWZpZXIiLCJkYXRlIiwiRGF0ZSIsInNwbGl0Iiwic2FuaXRpemVkIiwicmVwbGFjZSIsInN1YnN0cmluZyIsImV4dHJhY3RJZEZyb21GaWxlbmFtZSIsImZpbGVuYW1lRnJvbUlkIiwiaWQiLCJmaWxlRXhpc3RzIiwiZ2V0S25vd2xlZGdlQmFzZVBhdGgiLCJnZXRBcmNoaXZlUGF0aCIsInBhcnNlRkFRRmlsZSIsIml0ZW1zIiwicmVnZXgiLCJleGVjIiwicXVlc3Rpb24iLCJhbnN3ZXIiLCJwdXNoIiwidG9Mb3dlckNhc2UiLCJ0cmltIiwidGFncyIsImtleXdvcmRzIiwiZXh0cmFjdEtleXdvcmRzIiwidXNhZ2UiLCJzZXJpYWxpemVGQVFUb01hcmtkb3duIiwibWFya2Rvd24iLCJpdGVtIiwiaW5kZXgiLCJ3b3JkcyIsImZyZXF1ZW5jeSIsIndvcmQiLCJPYmplY3QiLCJlbnRyaWVzIiwic29ydCIsImEiLCJiIiwic2xpY2UiLCJwYXJzZUtQSUZpbGUiLCJuYW1lIiwiZGVmaW5pdGlvbiIsImNhbGN1bGF0aW9uIiwiZGF0YVNvdXJjZSIsIm93bmVyIiwidXBkYXRlRnJlcXVlbmN5Iiwic2VyaWFsaXplS1BJVG9NYXJrZG93biJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/knowledge/file-manager.ts\n");

/***/ }),

/***/ "(rsc)/./lib/knowledge/validator.ts":
/*!************************************!*\
  !*** ./lib/knowledge/validator.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   validateDecisionLog: () => (/* binding */ validateDecisionLog),\n/* harmony export */   validateFAQ: () => (/* binding */ validateFAQ),\n/* harmony export */   validateKPI: () => (/* binding */ validateKPI),\n/* harmony export */   validateMarkdownFormat: () => (/* binding */ validateMarkdownFormat),\n/* harmony export */   validateMeetingSummary: () => (/* binding */ validateMeetingSummary),\n/* harmony export */   validatePersona: () => (/* binding */ validatePersona)\n/* harmony export */ });\n/**\r\n * 知識庫內容驗證模組\r\n * @description 驗證知識庫內容的格式、完整性和品質\r\n */ // ============================================\n// Persona 驗證\n// ============================================\nconst REQUIRED_PERSONA_SECTIONS = [\n    '核心身份',\n    '溝通風格與語氣',\n    '決策原則',\n    '專業領域',\n    '互動模式'\n];\nfunction validatePersona(content) {\n    const errors = [];\n    const warnings = [];\n    // 1. 最小長度檢查\n    if (content.length < 500) {\n        errors.push({\n            field: 'content',\n            message: 'Persona 內容過短，建議至少 500 字元',\n            code: 'MIN_LENGTH'\n        });\n    }\n    // 2. 必要章節檢查\n    const missingSections = REQUIRED_PERSONA_SECTIONS.filter((section)=>!content.includes(section));\n    if (missingSections.length > 0) {\n        errors.push({\n            field: 'structure',\n            message: `缺少必要章節: ${missingSections.join(', ')}`,\n            code: 'MISSING_SECTIONS'\n        });\n    }\n    // 3. 章節長度檢查\n    REQUIRED_PERSONA_SECTIONS.forEach((section)=>{\n        const sectionRegex = new RegExp(`##\\\\s*${section}([\\\\s\\\\S]*?)(?=##|$)`, 'i');\n        const match = content.match(sectionRegex);\n        if (match && match[1].trim().length < 100) {\n            warnings.push({\n                field: section,\n                message: `章節 \"${section}\" 內容過短，建議補充更多細節`,\n                suggestion: '至少 100 字元'\n            });\n        }\n    });\n    // 4. 格式檢查\n    if (!content.includes('# Persona 定義') && !content.includes('# persona')) {\n        warnings.push({\n            field: 'format',\n            message: '建議使用標準標題: \"# Persona 定義\"'\n        });\n    }\n    // 計算品質分數\n    const score = calculatePersonaScore(content, errors, warnings);\n    return {\n        valid: errors.length === 0,\n        errors,\n        warnings,\n        score\n    };\n}\nfunction calculatePersonaScore(content, errors, warnings) {\n    let score = 100;\n    // 錯誤扣分\n    score -= errors.length * 20;\n    // 警告扣分\n    score -= warnings.length * 5;\n    // 長度加分\n    if (content.length > 5000) score += 10;\n    if (content.length > 10000) score += 10;\n    // 結構加分\n    const hasAllSections = REQUIRED_PERSONA_SECTIONS.every((section)=>content.includes(section));\n    if (hasAllSections) score += 10;\n    return Math.max(0, Math.min(100, score));\n}\n// ============================================\n// FAQ 驗證\n// ============================================\nfunction validateFAQ(item) {\n    const errors = [];\n    const warnings = [];\n    // 1. 問題驗證\n    if (!item.question || item.question.trim().length === 0) {\n        errors.push({\n            field: 'question',\n            message: '問題不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    if (item.question && item.question.length < 10) {\n        warnings.push({\n            field: 'question',\n            message: '問題過短，建議至少 10 字元'\n        });\n    }\n    if (item.question && item.question.length > 200) {\n        warnings.push({\n            field: 'question',\n            message: '問題過長，建議控制在 200 字元以內'\n        });\n    }\n    if (item.question && !item.question.includes('？') && !item.question.includes('?')) {\n        warnings.push({\n            field: 'question',\n            message: '問題建議以問號結尾',\n            suggestion: '例如: \"如何申請數據專案？\"'\n        });\n    }\n    // 2. 答案驗證\n    if (!item.answer || item.answer.trim().length === 0) {\n        errors.push({\n            field: 'answer',\n            message: '答案不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    if (item.answer && item.answer.length < 50) {\n        warnings.push({\n            field: 'answer',\n            message: '答案過短，建議至少 50 字元以提供詳細說明'\n        });\n    }\n    if (item.answer && item.answer.length > 2000) {\n        warnings.push({\n            field: 'answer',\n            message: '答案過長，建議拆分為多個 FAQ 或使用決策日誌記錄'\n        });\n    }\n    // 3. 關鍵字驗證\n    if (!item.keywords || item.keywords.length < 3) {\n        warnings.push({\n            field: 'keywords',\n            message: '建議至少提供 3 個關鍵字以提升搜尋匹配率',\n            suggestion: '例如: [\"專案\", \"申請\", \"流程\"]'\n        });\n    }\n    // 4. 標籤驗證\n    if (!item.tags || item.tags.length === 0) {\n        warnings.push({\n            field: 'tags',\n            message: '建議至少選擇一個分類標籤',\n            suggestion: '例如: 流程類、技術類、政策類'\n        });\n    }\n    const score = calculateFAQScore(item, errors, warnings);\n    return {\n        valid: errors.length === 0,\n        errors,\n        warnings,\n        score\n    };\n}\nfunction calculateFAQScore(item, errors, warnings) {\n    let score = 100;\n    score -= errors.length * 20;\n    score -= warnings.length * 5;\n    // 關鍵字密度加分\n    if (item.keywords && item.keywords.length >= 5) score += 5;\n    if (item.keywords && item.keywords.length >= 8) score += 5;\n    // 答案長度加分\n    if (item.answer && item.answer.length > 200) score += 5;\n    if (item.answer && item.answer.length > 500) score += 5;\n    return Math.max(0, Math.min(100, score));\n}\n// ============================================\n// KPI 驗證\n// ============================================\nfunction validateKPI(item) {\n    const errors = [];\n    const warnings = [];\n    // 1. 名稱驗證\n    if (!item.name || item.name.trim().length === 0) {\n        errors.push({\n            field: 'name',\n            message: 'KPI 名稱不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    // 檢查名稱格式 (例: MAU (Monthly Active Users))\n    const namePattern = /^[A-Z]{2,5}\\s*\\(.+\\)$/;\n    if (item.name && !namePattern.test(item.name)) {\n        warnings.push({\n            field: 'name',\n            message: '建議使用標準格式',\n            suggestion: '例如: MAU (Monthly Active Users)'\n        });\n    }\n    // 2. 定義驗證\n    if (!item.definition || item.definition.trim().length === 0) {\n        errors.push({\n            field: 'definition',\n            message: '業務定義不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    if (item.definition && item.definition.length < 20) {\n        warnings.push({\n            field: 'definition',\n            message: '業務定義過短，建議至少 20 字元'\n        });\n    }\n    // 3. 計算口徑驗證\n    if (!item.calculation || item.calculation.trim().length === 0) {\n        errors.push({\n            field: 'calculation',\n            message: '技術計算口徑不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    // 簡單的 SQL 語法檢查\n    if (item.calculation) {\n        const hasSQL = item.calculation.toUpperCase().includes('SELECT') || item.calculation.toUpperCase().includes('COUNT') || item.calculation.toUpperCase().includes('SUM');\n        if (!hasSQL) {\n            warnings.push({\n                field: 'calculation',\n                message: '建議使用 SQL 語法描述計算邏輯',\n                suggestion: '例如: SELECT COUNT(DISTINCT user_id) FROM...'\n            });\n        }\n    }\n    // 4. 數據來源驗證\n    if (!item.dataSource || item.dataSource.trim().length === 0) {\n        errors.push({\n            field: 'dataSource',\n            message: '數據來源不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    // 5. 負責團隊驗證\n    if (!item.owner || item.owner.trim().length === 0) {\n        errors.push({\n            field: 'owner',\n            message: '負責團隊不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    const score = calculateKPIScore(item, errors, warnings);\n    return {\n        valid: errors.length === 0,\n        errors,\n        warnings,\n        score\n    };\n}\nfunction calculateKPIScore(item, errors, warnings) {\n    let score = 100;\n    score -= errors.length * 20;\n    score -= warnings.length * 5;\n    // SQL 格式加分\n    if (item.calculation && item.calculation.includes('SELECT')) score += 10;\n    // 詳細定義加分\n    if (item.definition && item.definition.length > 100) score += 5;\n    return Math.max(0, Math.min(100, score));\n}\n// ============================================\n// 決策日誌驗證\n// ============================================\nfunction validateDecisionLog(item) {\n    const errors = [];\n    const warnings = [];\n    // 1. 專案名稱\n    if (!item.projectName || item.projectName.trim().length === 0) {\n        errors.push({\n            field: 'projectName',\n            message: '專案名稱不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    // 2. 日期\n    if (!item.date) {\n        errors.push({\n            field: 'date',\n            message: '決策日期不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    // 3. 決策者\n    if (!item.decisionMakers || item.decisionMakers.length === 0) {\n        warnings.push({\n            field: 'decisionMakers',\n            message: '建議記錄決策者姓名或角色'\n        });\n    }\n    // 4. 背景說明\n    if (!item.background || item.background.trim().length === 0) {\n        errors.push({\n            field: 'background',\n            message: '決策背景不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    if (item.background && item.background.length < 100) {\n        warnings.push({\n            field: 'background',\n            message: '背景說明過短，建議詳細描述問題陳述和現狀'\n        });\n    }\n    // 5. 考量選項\n    if (!item.options || item.options.length < 2) {\n        warnings.push({\n            field: 'options',\n            message: '建議至少記錄 2 個考量過的選項',\n            suggestion: '包含優缺點分析'\n        });\n    }\n    item.options?.forEach((option, index)=>{\n        if (!option.pros || option.pros.length === 0) {\n            warnings.push({\n                field: `options[${index}].pros`,\n                message: `選項 \"${option.name}\" 缺少優點分析`\n            });\n        }\n        if (!option.cons || option.cons.length === 0) {\n            warnings.push({\n                field: `options[${index}].cons`,\n                message: `選項 \"${option.name}\" 缺少缺點分析`\n            });\n        }\n    });\n    // 6. 最終決策\n    if (!item.finalDecision || item.finalDecision.trim().length === 0) {\n        errors.push({\n            field: 'finalDecision',\n            message: '最終決策不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    if (item.finalDecision && item.finalDecision.length < 50) {\n        warnings.push({\n            field: 'finalDecision',\n            message: '建議詳細說明決策理由和預期成效'\n        });\n    }\n    const score = 100 - errors.length * 20 - warnings.length * 5;\n    return {\n        valid: errors.length === 0,\n        errors,\n        warnings,\n        score: Math.max(0, Math.min(100, score))\n    };\n}\n// ============================================\n// 會議摘要驗證\n// ============================================\nfunction validateMeetingSummary(item) {\n    const errors = [];\n    const warnings = [];\n    // 1. 會議主題\n    if (!item.topic || item.topic.trim().length === 0) {\n        errors.push({\n            field: 'topic',\n            message: '會議主題不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    // 2. 日期與時間\n    if (!item.date) {\n        errors.push({\n            field: 'date',\n            message: '會議日期不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    if (!item.time) {\n        warnings.push({\n            field: 'time',\n            message: '建議記錄會議時間'\n        });\n    }\n    // 3. 參與者\n    if (!item.participants || item.participants.length === 0) {\n        warnings.push({\n            field: 'participants',\n            message: '建議記錄參與者名單'\n        });\n    }\n    // 4. 會議目標\n    if (!item.objectives || item.objectives.length === 0) {\n        warnings.push({\n            field: 'objectives',\n            message: '建議記錄會議目標',\n            suggestion: '明確會議想達成什麼目的'\n        });\n    }\n    // 5. 關鍵討論\n    if (!item.keyPoints || item.keyPoints.trim().length === 0) {\n        errors.push({\n            field: 'keyPoints',\n            message: '關鍵討論要點不能為空',\n            code: 'REQUIRED'\n        });\n    }\n    if (item.keyPoints && item.keyPoints.length < 100) {\n        warnings.push({\n            field: 'keyPoints',\n            message: '討論要點過短，建議詳細記錄主要討論內容'\n        });\n    }\n    // 6. 待辦事項\n    if (!item.actionItems || item.actionItems.length === 0) {\n        warnings.push({\n            field: 'actionItems',\n            message: '建議記錄會議產生的待辦事項',\n            suggestion: '包含負責人和截止日期'\n        });\n    }\n    item.actionItems?.forEach((action, index)=>{\n        if (!action.assignee) {\n            warnings.push({\n                field: `actionItems[${index}].assignee`,\n                message: `待辦事項 \"${action.task}\" 缺少負責人`\n            });\n        }\n        if (!action.deadline) {\n            warnings.push({\n                field: `actionItems[${index}].deadline`,\n                message: `待辦事項 \"${action.task}\" 缺少截止日期`\n            });\n        }\n    });\n    const score = 100 - errors.length * 20 - warnings.length * 5;\n    return {\n        valid: errors.length === 0,\n        errors,\n        warnings,\n        score: Math.max(0, Math.min(100, score))\n    };\n}\n// ============================================\n// 通用驗證\n// ============================================\n/**\r\n * 驗證 Markdown 格式\r\n */ function validateMarkdownFormat(content) {\n    const errors = [];\n    const warnings = [];\n    // 基本格式檢查\n    if (!content.trim().startsWith('#')) {\n        warnings.push({\n            field: 'format',\n            message: '建議使用 Markdown 標題（# 開頭）'\n        });\n    }\n    // 檢查是否有過長的行\n    const lines = content.split('\\n');\n    lines.forEach((line, index)=>{\n        if (line.length > 200 && !line.startsWith('```')) {\n            warnings.push({\n                field: `line_${index + 1}`,\n                message: `第 ${index + 1} 行過長，建議拆分以提升可讀性`\n            });\n        }\n    });\n    return {\n        valid: errors.length === 0,\n        errors,\n        warnings\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QStDO0FBRS9DOztDQUVDLEdBQ00sU0FBU2dELHVCQUF1Qm5FLE9BQWU7SUFDcEQsTUFBTUMsU0FBNEIsRUFBRTtJQUNwQyxNQUFNQyxXQUFnQyxFQUFFO0lBRXhDLFNBQVM7SUFDVCxJQUFJLENBQUNGLFFBQVFpQixJQUFJLEdBQUdtRCxVQUFVLENBQUMsTUFBTTtRQUNuQ2xFLFNBQVNFLElBQUksQ0FBQztZQUNaQyxPQUFPO1lBQ1BDLFNBQVM7UUFDWDtJQUNGO0lBRUEsWUFBWTtJQUNaLE1BQU0rRCxRQUFRckUsUUFBUXNFLEtBQUssQ0FBQztJQUM1QkQsTUFBTXhELE9BQU8sQ0FBQyxDQUFDMEQsTUFBTW5CO1FBQ25CLElBQUltQixLQUFLcEUsTUFBTSxHQUFHLE9BQU8sQ0FBQ29FLEtBQUtILFVBQVUsQ0FBQyxRQUFRO1lBQ2hEbEUsU0FBU0UsSUFBSSxDQUFDO2dCQUNaQyxPQUFPLENBQUMsS0FBSyxFQUFFK0MsUUFBUSxHQUFHO2dCQUMxQjlDLFNBQVMsQ0FBQyxFQUFFLEVBQUU4QyxRQUFRLEVBQUUsZUFBZSxDQUFDO1lBQzFDO1FBQ0Y7SUFDRjtJQUVBLE9BQU87UUFDTC9CLE9BQU9wQixPQUFPRSxNQUFNLEtBQUs7UUFDekJGO1FBQ0FDO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsiQzpcXHNtYXJ0LWFpLWF2YXRhci1hZ2VudFxcbGliXFxrbm93bGVkZ2VcXHZhbGlkYXRvci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICog55+l6K2Y5bqr5YWn5a656amX6K2J5qih57WEXHJcbiAqIEBkZXNjcmlwdGlvbiDpqZforYnnn6XorZjluqvlhaflrrnnmoTmoLzlvI/jgIHlrozmlbTmgKflkozlk4Hos6pcclxuICovXHJcblxyXG5pbXBvcnQgdHlwZSB7XHJcbiAgVmFsaWRhdGlvblJlc3VsdCxcclxuICBWYWxpZGF0aW9uRXJyb3IsXHJcbiAgVmFsaWRhdGlvbldhcm5pbmcsXHJcbiAgRkFRSXRlbSxcclxuICBLUElJdGVtLFxyXG4gIERlY2lzaW9uTG9nSXRlbSxcclxuICBNZWV0aW5nU3VtbWFyeUl0ZW0sXHJcbn0gZnJvbSAnQC90eXBlcy9rbm93bGVkZ2UnXHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBQZXJzb25hIOmpl+itiVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuY29uc3QgUkVRVUlSRURfUEVSU09OQV9TRUNUSU9OUyA9IFtcclxuICAn5qC45b+D6Lqr5Lu9JyxcclxuICAn5rqd6YCa6aKo5qC86IiH6Kqe5rCjJyxcclxuICAn5rG6562W5Y6f5YmHJyxcclxuICAn5bCI5qWt6aCY5Z+fJyxcclxuICAn5LqS5YuV5qih5byPJyxcclxuXVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUGVyc29uYShjb250ZW50OiBzdHJpbmcpOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW11cclxuICBjb25zdCB3YXJuaW5nczogVmFsaWRhdGlvbldhcm5pbmdbXSA9IFtdXHJcblxyXG4gIC8vIDEuIOacgOWwj+mVt+W6puaqouafpVxyXG4gIGlmIChjb250ZW50Lmxlbmd0aCA8IDUwMCkge1xyXG4gICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ2NvbnRlbnQnLFxyXG4gICAgICBtZXNzYWdlOiAnUGVyc29uYSDlhaflrrnpgY7nn63vvIzlu7rorbDoh7PlsJEgNTAwIOWtl+WFgycsXHJcbiAgICAgIGNvZGU6ICdNSU5fTEVOR1RIJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyAyLiDlv4XopoHnq6Dnr4DmqqLmn6VcclxuICBjb25zdCBtaXNzaW5nU2VjdGlvbnMgPSBSRVFVSVJFRF9QRVJTT05BX1NFQ1RJT05TLmZpbHRlcihcclxuICAgIChzZWN0aW9uKSA9PiAhY29udGVudC5pbmNsdWRlcyhzZWN0aW9uKVxyXG4gIClcclxuXHJcbiAgaWYgKG1pc3NpbmdTZWN0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAnc3RydWN0dXJlJyxcclxuICAgICAgbWVzc2FnZTogYOe8uuWwkeW/heimgeeroOevgDogJHttaXNzaW5nU2VjdGlvbnMuam9pbignLCAnKX1gLFxyXG4gICAgICBjb2RlOiAnTUlTU0lOR19TRUNUSU9OUycsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gMy4g56ug56+A6ZW35bqm5qqi5p+lXHJcbiAgUkVRVUlSRURfUEVSU09OQV9TRUNUSU9OUy5mb3JFYWNoKChzZWN0aW9uKSA9PiB7XHJcbiAgICBjb25zdCBzZWN0aW9uUmVnZXggPSBuZXcgUmVnRXhwKFxyXG4gICAgICBgIyNcXFxccyoke3NlY3Rpb259KFtcXFxcc1xcXFxTXSo/KSg/PSMjfCQpYCxcclxuICAgICAgJ2knXHJcbiAgICApXHJcbiAgICBjb25zdCBtYXRjaCA9IGNvbnRlbnQubWF0Y2goc2VjdGlvblJlZ2V4KVxyXG5cclxuICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXS50cmltKCkubGVuZ3RoIDwgMTAwKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgIGZpZWxkOiBzZWN0aW9uLFxyXG4gICAgICAgIG1lc3NhZ2U6IGDnq6Dnr4AgXCIke3NlY3Rpb259XCIg5YWn5a656YGO55+t77yM5bu66K2w6KOc5YWF5pu05aSa57Sw56+AYCxcclxuICAgICAgICBzdWdnZXN0aW9uOiAn6Iez5bCRIDEwMCDlrZflhYMnLFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH0pXHJcblxyXG4gIC8vIDQuIOagvOW8j+aqouafpVxyXG4gIGlmICghY29udGVudC5pbmNsdWRlcygnIyBQZXJzb25hIOWumue+qScpICYmICFjb250ZW50LmluY2x1ZGVzKCcjIHBlcnNvbmEnKSkge1xyXG4gICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAnZm9ybWF0JyxcclxuICAgICAgbWVzc2FnZTogJ+W7uuitsOS9v+eUqOaomea6luaomemhjDogXCIjIFBlcnNvbmEg5a6a576pXCInLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIOioiOeul+WTgeizquWIhuaVuFxyXG4gIGNvbnN0IHNjb3JlID0gY2FsY3VsYXRlUGVyc29uYVNjb3JlKGNvbnRlbnQsIGVycm9ycywgd2FybmluZ3MpXHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB2YWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9ycyxcclxuICAgIHdhcm5pbmdzLFxyXG4gICAgc2NvcmUsXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjYWxjdWxhdGVQZXJzb25hU2NvcmUoXHJcbiAgY29udGVudDogc3RyaW5nLFxyXG4gIGVycm9yczogVmFsaWRhdGlvbkVycm9yW10sXHJcbiAgd2FybmluZ3M6IFZhbGlkYXRpb25XYXJuaW5nW11cclxuKTogbnVtYmVyIHtcclxuICBsZXQgc2NvcmUgPSAxMDBcclxuXHJcbiAgLy8g6Yyv6Kqk5omj5YiGXHJcbiAgc2NvcmUgLT0gZXJyb3JzLmxlbmd0aCAqIDIwXHJcblxyXG4gIC8vIOitpuWRiuaJo+WIhlxyXG4gIHNjb3JlIC09IHdhcm5pbmdzLmxlbmd0aCAqIDVcclxuXHJcbiAgLy8g6ZW35bqm5Yqg5YiGXHJcbiAgaWYgKGNvbnRlbnQubGVuZ3RoID4gNTAwMCkgc2NvcmUgKz0gMTBcclxuICBpZiAoY29udGVudC5sZW5ndGggPiAxMDAwMCkgc2NvcmUgKz0gMTBcclxuXHJcbiAgLy8g57WQ5qeL5Yqg5YiGXHJcbiAgY29uc3QgaGFzQWxsU2VjdGlvbnMgPSBSRVFVSVJFRF9QRVJTT05BX1NFQ1RJT05TLmV2ZXJ5KChzZWN0aW9uKSA9PlxyXG4gICAgY29udGVudC5pbmNsdWRlcyhzZWN0aW9uKVxyXG4gIClcclxuICBpZiAoaGFzQWxsU2VjdGlvbnMpIHNjb3JlICs9IDEwXHJcblxyXG4gIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbigxMDAsIHNjb3JlKSlcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gRkFRIOmpl+itiVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRkFRKGl0ZW06IEZBUUl0ZW0pOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW11cclxuICBjb25zdCB3YXJuaW5nczogVmFsaWRhdGlvbldhcm5pbmdbXSA9IFtdXHJcblxyXG4gIC8vIDEuIOWVj+mhjOmpl+itiVxyXG4gIGlmICghaXRlbS5xdWVzdGlvbiB8fCBpdGVtLnF1ZXN0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdxdWVzdGlvbicsXHJcbiAgICAgIG1lc3NhZ2U6ICfllY/poYzkuI3og73ngrrnqbonLFxyXG4gICAgICBjb2RlOiAnUkVRVUlSRUQnLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGlmIChpdGVtLnF1ZXN0aW9uICYmIGl0ZW0ucXVlc3Rpb24ubGVuZ3RoIDwgMTApIHtcclxuICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ3F1ZXN0aW9uJyxcclxuICAgICAgbWVzc2FnZTogJ+WVj+mhjOmBjuefre+8jOW7uuitsOiHs+WwkSAxMCDlrZflhYMnLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGlmIChpdGVtLnF1ZXN0aW9uICYmIGl0ZW0ucXVlc3Rpb24ubGVuZ3RoID4gMjAwKSB7XHJcbiAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdxdWVzdGlvbicsXHJcbiAgICAgIG1lc3NhZ2U6ICfllY/poYzpgY7plbfvvIzlu7rorbDmjqfliLblnKggMjAwIOWtl+WFg+S7peWFpycsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgaWYgKGl0ZW0ucXVlc3Rpb24gJiYgIWl0ZW0ucXVlc3Rpb24uaW5jbHVkZXMoJ++8nycpICYmICFpdGVtLnF1ZXN0aW9uLmluY2x1ZGVzKCc/JykpIHtcclxuICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ3F1ZXN0aW9uJyxcclxuICAgICAgbWVzc2FnZTogJ+WVj+mhjOW7uuitsOS7peWVj+iZn+e1kOWwvicsXHJcbiAgICAgIHN1Z2dlc3Rpb246ICfkvovlpoI6IFwi5aaC5L2V55Sz6KuL5pW45pOa5bCI5qGI77yfXCInLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIDIuIOetlOahiOmpl+itiVxyXG4gIGlmICghaXRlbS5hbnN3ZXIgfHwgaXRlbS5hbnN3ZXIudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ2Fuc3dlcicsXHJcbiAgICAgIG1lc3NhZ2U6ICfnrZTmoYjkuI3og73ngrrnqbonLFxyXG4gICAgICBjb2RlOiAnUkVRVUlSRUQnLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGlmIChpdGVtLmFuc3dlciAmJiBpdGVtLmFuc3dlci5sZW5ndGggPCA1MCkge1xyXG4gICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAnYW5zd2VyJyxcclxuICAgICAgbWVzc2FnZTogJ+etlOahiOmBjuefre+8jOW7uuitsOiHs+WwkSA1MCDlrZflhYPku6Xmj5DkvpvoqbPntLDoqqrmmI4nLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGlmIChpdGVtLmFuc3dlciAmJiBpdGVtLmFuc3dlci5sZW5ndGggPiAyMDAwKSB7XHJcbiAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdhbnN3ZXInLFxyXG4gICAgICBtZXNzYWdlOiAn562U5qGI6YGO6ZW377yM5bu66K2w5ouG5YiG54K65aSa5YCLIEZBUSDmiJbkvb/nlKjmsbrnrZbml6XoqozoqJjpjIQnLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIDMuIOmXnOmNteWtl+mpl+itiVxyXG4gIGlmICghaXRlbS5rZXl3b3JkcyB8fCBpdGVtLmtleXdvcmRzLmxlbmd0aCA8IDMpIHtcclxuICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ2tleXdvcmRzJyxcclxuICAgICAgbWVzc2FnZTogJ+W7uuitsOiHs+WwkeaPkOS+myAzIOWAi+mXnOmNteWtl+S7peaPkOWNh+aQnOWwi+WMuemFjeeOhycsXHJcbiAgICAgIHN1Z2dlc3Rpb246ICfkvovlpoI6IFtcIuWwiOahiFwiLCBcIueUs+iri1wiLCBcIua1geeoi1wiXScsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gNC4g5qiZ57Gk6amX6K2JXHJcbiAgaWYgKCFpdGVtLnRhZ3MgfHwgaXRlbS50YWdzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAndGFncycsXHJcbiAgICAgIG1lc3NhZ2U6ICflu7rorbDoh7PlsJHpgbjmk4fkuIDlgIvliIbpoZ7mqJnnsaQnLFxyXG4gICAgICBzdWdnZXN0aW9uOiAn5L6L5aaCOiDmtYHnqIvpoZ7jgIHmioDooZPpoZ7jgIHmlL/nrZbpoZ4nLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNvbnN0IHNjb3JlID0gY2FsY3VsYXRlRkFRU2NvcmUoaXRlbSwgZXJyb3JzLCB3YXJuaW5ncylcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgZXJyb3JzLFxyXG4gICAgd2FybmluZ3MsXHJcbiAgICBzY29yZSxcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZUZBUVNjb3JlKFxyXG4gIGl0ZW06IEZBUUl0ZW0sXHJcbiAgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSxcclxuICB3YXJuaW5nczogVmFsaWRhdGlvbldhcm5pbmdbXVxyXG4pOiBudW1iZXIge1xyXG4gIGxldCBzY29yZSA9IDEwMFxyXG5cclxuICBzY29yZSAtPSBlcnJvcnMubGVuZ3RoICogMjBcclxuICBzY29yZSAtPSB3YXJuaW5ncy5sZW5ndGggKiA1XHJcblxyXG4gIC8vIOmXnOmNteWtl+WvhuW6puWKoOWIhlxyXG4gIGlmIChpdGVtLmtleXdvcmRzICYmIGl0ZW0ua2V5d29yZHMubGVuZ3RoID49IDUpIHNjb3JlICs9IDVcclxuICBpZiAoaXRlbS5rZXl3b3JkcyAmJiBpdGVtLmtleXdvcmRzLmxlbmd0aCA+PSA4KSBzY29yZSArPSA1XHJcblxyXG4gIC8vIOetlOahiOmVt+W6puWKoOWIhlxyXG4gIGlmIChpdGVtLmFuc3dlciAmJiBpdGVtLmFuc3dlci5sZW5ndGggPiAyMDApIHNjb3JlICs9IDVcclxuICBpZiAoaXRlbS5hbnN3ZXIgJiYgaXRlbS5hbnN3ZXIubGVuZ3RoID4gNTAwKSBzY29yZSArPSA1XHJcblxyXG4gIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbigxMDAsIHNjb3JlKSlcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gS1BJIOmpl+itiVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlS1BJKGl0ZW06IEtQSUl0ZW0pOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW11cclxuICBjb25zdCB3YXJuaW5nczogVmFsaWRhdGlvbldhcm5pbmdbXSA9IFtdXHJcblxyXG4gIC8vIDEuIOWQjeeosempl+itiVxyXG4gIGlmICghaXRlbS5uYW1lIHx8IGl0ZW0ubmFtZS50cmltKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAnbmFtZScsXHJcbiAgICAgIG1lc3NhZ2U6ICdLUEkg5ZCN56ix5LiN6IO954K656m6JyxcclxuICAgICAgY29kZTogJ1JFUVVJUkVEJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyDmqqLmn6XlkI3nqLHmoLzlvI8gKOS+izogTUFVIChNb250aGx5IEFjdGl2ZSBVc2VycykpXHJcbiAgY29uc3QgbmFtZVBhdHRlcm4gPSAvXltBLVpdezIsNX1cXHMqXFwoLitcXCkkL1xyXG4gIGlmIChpdGVtLm5hbWUgJiYgIW5hbWVQYXR0ZXJuLnRlc3QoaXRlbS5uYW1lKSkge1xyXG4gICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAnbmFtZScsXHJcbiAgICAgIG1lc3NhZ2U6ICflu7rorbDkvb/nlKjmqJnmupbmoLzlvI8nLFxyXG4gICAgICBzdWdnZXN0aW9uOiAn5L6L5aaCOiBNQVUgKE1vbnRobHkgQWN0aXZlIFVzZXJzKScsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gMi4g5a6a576p6amX6K2JXHJcbiAgaWYgKCFpdGVtLmRlZmluaXRpb24gfHwgaXRlbS5kZWZpbml0aW9uLnRyaW0oKS5sZW5ndGggPT09IDApIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdkZWZpbml0aW9uJyxcclxuICAgICAgbWVzc2FnZTogJ+alreWLmeWumue+qeS4jeiDveeCuuepuicsXHJcbiAgICAgIGNvZGU6ICdSRVFVSVJFRCcsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgaWYgKGl0ZW0uZGVmaW5pdGlvbiAmJiBpdGVtLmRlZmluaXRpb24ubGVuZ3RoIDwgMjApIHtcclxuICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ2RlZmluaXRpb24nLFxyXG4gICAgICBtZXNzYWdlOiAn5qWt5YuZ5a6a576p6YGO55+t77yM5bu66K2w6Iez5bCRIDIwIOWtl+WFgycsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gMy4g6KiI566X5Y+j5b6R6amX6K2JXHJcbiAgaWYgKCFpdGVtLmNhbGN1bGF0aW9uIHx8IGl0ZW0uY2FsY3VsYXRpb24udHJpbSgpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ2NhbGN1bGF0aW9uJyxcclxuICAgICAgbWVzc2FnZTogJ+aKgOihk+ioiOeul+WPo+W+keS4jeiDveeCuuepuicsXHJcbiAgICAgIGNvZGU6ICdSRVFVSVJFRCcsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8g57Ch5Zau55qEIFNRTCDoqp7ms5XmqqLmn6VcclxuICBpZiAoaXRlbS5jYWxjdWxhdGlvbikge1xyXG4gICAgY29uc3QgaGFzU1FMID1cclxuICAgICAgaXRlbS5jYWxjdWxhdGlvbi50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdTRUxFQ1QnKSB8fFxyXG4gICAgICBpdGVtLmNhbGN1bGF0aW9uLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoJ0NPVU5UJykgfHxcclxuICAgICAgaXRlbS5jYWxjdWxhdGlvbi50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCdTVU0nKVxyXG5cclxuICAgIGlmICghaGFzU1FMKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgIGZpZWxkOiAnY2FsY3VsYXRpb24nLFxyXG4gICAgICAgIG1lc3NhZ2U6ICflu7rorbDkvb/nlKggU1FMIOiqnuazleaPj+i/sOioiOeul+mCj+i8rycsXHJcbiAgICAgICAgc3VnZ2VzdGlvbjogJ+S+i+WmgjogU0VMRUNUIENPVU5UKERJU1RJTkNUIHVzZXJfaWQpIEZST00uLi4nLFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gNC4g5pW45pOa5L6G5rqQ6amX6K2JXHJcbiAgaWYgKCFpdGVtLmRhdGFTb3VyY2UgfHwgaXRlbS5kYXRhU291cmNlLnRyaW0oKS5sZW5ndGggPT09IDApIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdkYXRhU291cmNlJyxcclxuICAgICAgbWVzc2FnZTogJ+aVuOaTmuS+hua6kOS4jeiDveeCuuepuicsXHJcbiAgICAgIGNvZGU6ICdSRVFVSVJFRCcsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gNS4g6LKg6LKs5ZyY6ZqK6amX6K2JXHJcbiAgaWYgKCFpdGVtLm93bmVyIHx8IGl0ZW0ub3duZXIudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ293bmVyJyxcclxuICAgICAgbWVzc2FnZTogJ+iyoOiyrOWcmOmaiuS4jeiDveeCuuepuicsXHJcbiAgICAgIGNvZGU6ICdSRVFVSVJFRCcsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2NvcmUgPSBjYWxjdWxhdGVLUElTY29yZShpdGVtLCBlcnJvcnMsIHdhcm5pbmdzKVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgdmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXHJcbiAgICBlcnJvcnMsXHJcbiAgICB3YXJuaW5ncyxcclxuICAgIHNjb3JlLFxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlS1BJU2NvcmUoXHJcbiAgaXRlbTogS1BJSXRlbSxcclxuICBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdLFxyXG4gIHdhcm5pbmdzOiBWYWxpZGF0aW9uV2FybmluZ1tdXHJcbik6IG51bWJlciB7XHJcbiAgbGV0IHNjb3JlID0gMTAwXHJcblxyXG4gIHNjb3JlIC09IGVycm9ycy5sZW5ndGggKiAyMFxyXG4gIHNjb3JlIC09IHdhcm5pbmdzLmxlbmd0aCAqIDVcclxuXHJcbiAgLy8gU1FMIOagvOW8j+WKoOWIhlxyXG4gIGlmIChpdGVtLmNhbGN1bGF0aW9uICYmIGl0ZW0uY2FsY3VsYXRpb24uaW5jbHVkZXMoJ1NFTEVDVCcpKSBzY29yZSArPSAxMFxyXG5cclxuICAvLyDoqbPntLDlrprnvqnliqDliIZcclxuICBpZiAoaXRlbS5kZWZpbml0aW9uICYmIGl0ZW0uZGVmaW5pdGlvbi5sZW5ndGggPiAxMDApIHNjb3JlICs9IDVcclxuXHJcbiAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgc2NvcmUpKVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDmsbrnrZbml6XoqozpqZforYlcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZURlY2lzaW9uTG9nKGl0ZW06IERlY2lzaW9uTG9nSXRlbSk6IFZhbGlkYXRpb25SZXN1bHQge1xyXG4gIGNvbnN0IGVycm9yczogVmFsaWRhdGlvbkVycm9yW10gPSBbXVxyXG4gIGNvbnN0IHdhcm5pbmdzOiBWYWxpZGF0aW9uV2FybmluZ1tdID0gW11cclxuXHJcbiAgLy8gMS4g5bCI5qGI5ZCN56ixXHJcbiAgaWYgKCFpdGVtLnByb2plY3ROYW1lIHx8IGl0ZW0ucHJvamVjdE5hbWUudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ3Byb2plY3ROYW1lJyxcclxuICAgICAgbWVzc2FnZTogJ+WwiOahiOWQjeeoseS4jeiDveeCuuepuicsXHJcbiAgICAgIGNvZGU6ICdSRVFVSVJFRCcsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gMi4g5pel5pyfXHJcbiAgaWYgKCFpdGVtLmRhdGUpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdkYXRlJyxcclxuICAgICAgbWVzc2FnZTogJ+axuuetluaXpeacn+S4jeiDveeCuuepuicsXHJcbiAgICAgIGNvZGU6ICdSRVFVSVJFRCcsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gMy4g5rG6562W6ICFXHJcbiAgaWYgKCFpdGVtLmRlY2lzaW9uTWFrZXJzIHx8IGl0ZW0uZGVjaXNpb25NYWtlcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdkZWNpc2lvbk1ha2VycycsXHJcbiAgICAgIG1lc3NhZ2U6ICflu7rorbDoqJjpjITmsbrnrZbogIXlp5PlkI3miJbop5LoibInLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIDQuIOiDjOaZr+iqquaYjlxyXG4gIGlmICghaXRlbS5iYWNrZ3JvdW5kIHx8IGl0ZW0uYmFja2dyb3VuZC50cmltKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAnYmFja2dyb3VuZCcsXHJcbiAgICAgIG1lc3NhZ2U6ICfmsbrnrZbog4zmma/kuI3og73ngrrnqbonLFxyXG4gICAgICBjb2RlOiAnUkVRVUlSRUQnLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGlmIChpdGVtLmJhY2tncm91bmQgJiYgaXRlbS5iYWNrZ3JvdW5kLmxlbmd0aCA8IDEwMCkge1xyXG4gICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAnYmFja2dyb3VuZCcsXHJcbiAgICAgIG1lc3NhZ2U6ICfog4zmma/oqqrmmI7pgY7nn63vvIzlu7rorbDoqbPntLDmj4/ov7DllY/poYzpmbPov7Dlkoznj77ni4AnLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIDUuIOiAg+mHj+mBuOmghVxyXG4gIGlmICghaXRlbS5vcHRpb25zIHx8IGl0ZW0ub3B0aW9ucy5sZW5ndGggPCAyKSB7XHJcbiAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdvcHRpb25zJyxcclxuICAgICAgbWVzc2FnZTogJ+W7uuitsOiHs+WwkeiomOmMhCAyIOWAi+iAg+mHj+mBjueahOmBuOmghScsXHJcbiAgICAgIHN1Z2dlc3Rpb246ICfljIXlkKvlhKrnvLrpu57liIbmnpAnLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGl0ZW0ub3B0aW9ucz8uZm9yRWFjaCgob3B0aW9uLCBpbmRleCkgPT4ge1xyXG4gICAgaWYgKCFvcHRpb24ucHJvcyB8fCBvcHRpb24ucHJvcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgICAgZmllbGQ6IGBvcHRpb25zWyR7aW5kZXh9XS5wcm9zYCxcclxuICAgICAgICBtZXNzYWdlOiBg6YG46aCFIFwiJHtvcHRpb24ubmFtZX1cIiDnvLrlsJHlhKrpu57liIbmnpBgLFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gICAgaWYgKCFvcHRpb24uY29ucyB8fCBvcHRpb24uY29ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgICAgZmllbGQ6IGBvcHRpb25zWyR7aW5kZXh9XS5jb25zYCxcclxuICAgICAgICBtZXNzYWdlOiBg6YG46aCFIFwiJHtvcHRpb24ubmFtZX1cIiDnvLrlsJHnvLrpu57liIbmnpBgLFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH0pXHJcblxyXG4gIC8vIDYuIOacgOe1guaxuuetllxyXG4gIGlmICghaXRlbS5maW5hbERlY2lzaW9uIHx8IGl0ZW0uZmluYWxEZWNpc2lvbi50cmltKCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAnZmluYWxEZWNpc2lvbicsXHJcbiAgICAgIG1lc3NhZ2U6ICfmnIDntYLmsbrnrZbkuI3og73ngrrnqbonLFxyXG4gICAgICBjb2RlOiAnUkVRVUlSRUQnLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGlmIChpdGVtLmZpbmFsRGVjaXNpb24gJiYgaXRlbS5maW5hbERlY2lzaW9uLmxlbmd0aCA8IDUwKSB7XHJcbiAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdmaW5hbERlY2lzaW9uJyxcclxuICAgICAgbWVzc2FnZTogJ+W7uuitsOips+e0sOiqquaYjuaxuuetlueQhueUseWSjOmgkOacn+aIkOaViCcsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgY29uc3Qgc2NvcmUgPSAxMDAgLSBlcnJvcnMubGVuZ3RoICogMjAgLSB3YXJuaW5ncy5sZW5ndGggKiA1XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB2YWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9ycyxcclxuICAgIHdhcm5pbmdzLFxyXG4gICAgc2NvcmU6IE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgc2NvcmUpKSxcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIOacg+itsOaRmOimgempl+itiVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlTWVldGluZ1N1bW1hcnkoXHJcbiAgaXRlbTogTWVldGluZ1N1bW1hcnlJdGVtXHJcbik6IFZhbGlkYXRpb25SZXN1bHQge1xyXG4gIGNvbnN0IGVycm9yczogVmFsaWRhdGlvbkVycm9yW10gPSBbXVxyXG4gIGNvbnN0IHdhcm5pbmdzOiBWYWxpZGF0aW9uV2FybmluZ1tdID0gW11cclxuXHJcbiAgLy8gMS4g5pyD6K2w5Li76aGMXHJcbiAgaWYgKCFpdGVtLnRvcGljIHx8IGl0ZW0udG9waWMudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ3RvcGljJyxcclxuICAgICAgbWVzc2FnZTogJ+acg+itsOS4u+mhjOS4jeiDveeCuuepuicsXHJcbiAgICAgIGNvZGU6ICdSRVFVSVJFRCcsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gMi4g5pel5pyf6IiH5pmC6ZaTXHJcbiAgaWYgKCFpdGVtLmRhdGUpIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdkYXRlJyxcclxuICAgICAgbWVzc2FnZTogJ+acg+itsOaXpeacn+S4jeiDveeCuuepuicsXHJcbiAgICAgIGNvZGU6ICdSRVFVSVJFRCcsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgaWYgKCFpdGVtLnRpbWUpIHtcclxuICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ3RpbWUnLFxyXG4gICAgICBtZXNzYWdlOiAn5bu66K2w6KiY6YyE5pyD6K2w5pmC6ZaTJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyAzLiDlj4PoiIfogIVcclxuICBpZiAoIWl0ZW0ucGFydGljaXBhbnRzIHx8IGl0ZW0ucGFydGljaXBhbnRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAncGFydGljaXBhbnRzJyxcclxuICAgICAgbWVzc2FnZTogJ+W7uuitsOiomOmMhOWPg+iIh+iAheWQjeWWricsXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gNC4g5pyD6K2w55uu5qiZXHJcbiAgaWYgKCFpdGVtLm9iamVjdGl2ZXMgfHwgaXRlbS5vYmplY3RpdmVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgIGZpZWxkOiAnb2JqZWN0aXZlcycsXHJcbiAgICAgIG1lc3NhZ2U6ICflu7rorbDoqJjpjITmnIPorbDnm67mqJknLFxyXG4gICAgICBzdWdnZXN0aW9uOiAn5piO56K65pyD6K2w5oOz6YGU5oiQ5LuA6bq855uu55qEJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyA1LiDpl5zpjbXoqI7oq5ZcclxuICBpZiAoIWl0ZW0ua2V5UG9pbnRzIHx8IGl0ZW0ua2V5UG9pbnRzLnRyaW0oKS5sZW5ndGggPT09IDApIHtcclxuICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdrZXlQb2ludHMnLFxyXG4gICAgICBtZXNzYWdlOiAn6Zec6Y216KiO6KuW6KaB6bue5LiN6IO954K656m6JyxcclxuICAgICAgY29kZTogJ1JFUVVJUkVEJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBpZiAoaXRlbS5rZXlQb2ludHMgJiYgaXRlbS5rZXlQb2ludHMubGVuZ3RoIDwgMTAwKSB7XHJcbiAgICB3YXJuaW5ncy5wdXNoKHtcclxuICAgICAgZmllbGQ6ICdrZXlQb2ludHMnLFxyXG4gICAgICBtZXNzYWdlOiAn6KiO6KuW6KaB6bue6YGO55+t77yM5bu66K2w6Kmz57Sw6KiY6YyE5Li76KaB6KiO6KuW5YWn5a65JyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyA2LiDlvoXovqbkuovpoIVcclxuICBpZiAoIWl0ZW0uYWN0aW9uSXRlbXMgfHwgaXRlbS5hY3Rpb25JdGVtcy5sZW5ndGggPT09IDApIHtcclxuICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ2FjdGlvbkl0ZW1zJyxcclxuICAgICAgbWVzc2FnZTogJ+W7uuitsOiomOmMhOacg+itsOeUoueUn+eahOW+hei+puS6i+mghScsXHJcbiAgICAgIHN1Z2dlc3Rpb246ICfljIXlkKvosqDosqzkurrlkozmiKrmraLml6XmnJ8nLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGl0ZW0uYWN0aW9uSXRlbXM/LmZvckVhY2goKGFjdGlvbiwgaW5kZXgpID0+IHtcclxuICAgIGlmICghYWN0aW9uLmFzc2lnbmVlKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgIGZpZWxkOiBgYWN0aW9uSXRlbXNbJHtpbmRleH1dLmFzc2lnbmVlYCxcclxuICAgICAgICBtZXNzYWdlOiBg5b6F6L6m5LqL6aCFIFwiJHthY3Rpb24udGFza31cIiDnvLrlsJHosqDosqzkurpgLFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gICAgaWYgKCFhY3Rpb24uZGVhZGxpbmUpIHtcclxuICAgICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgICAgZmllbGQ6IGBhY3Rpb25JdGVtc1ske2luZGV4fV0uZGVhZGxpbmVgLFxyXG4gICAgICAgIG1lc3NhZ2U6IGDlvoXovqbkuovpoIUgXCIke2FjdGlvbi50YXNrfVwiIOe8uuWwkeaIquatouaXpeacn2AsXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfSlcclxuXHJcbiAgY29uc3Qgc2NvcmUgPSAxMDAgLSBlcnJvcnMubGVuZ3RoICogMjAgLSB3YXJuaW5ncy5sZW5ndGggKiA1XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB2YWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9ycyxcclxuICAgIHdhcm5pbmdzLFxyXG4gICAgc2NvcmU6IE1hdGgubWF4KDAsIE1hdGgubWluKDEwMCwgc2NvcmUpKSxcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIOmAmueUqOmpl+itiVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIOmpl+itiSBNYXJrZG93biDmoLzlvI9cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZU1hcmtkb3duRm9ybWF0KGNvbnRlbnQ6IHN0cmluZyk6IFZhbGlkYXRpb25SZXN1bHQge1xyXG4gIGNvbnN0IGVycm9yczogVmFsaWRhdGlvbkVycm9yW10gPSBbXVxyXG4gIGNvbnN0IHdhcm5pbmdzOiBWYWxpZGF0aW9uV2FybmluZ1tdID0gW11cclxuXHJcbiAgLy8g5Z+65pys5qC85byP5qqi5p+lXHJcbiAgaWYgKCFjb250ZW50LnRyaW0oKS5zdGFydHNXaXRoKCcjJykpIHtcclxuICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICBmaWVsZDogJ2Zvcm1hdCcsXHJcbiAgICAgIG1lc3NhZ2U6ICflu7rorbDkvb/nlKggTWFya2Rvd24g5qiZ6aGM77yIIyDplovpoK3vvIknLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIOaqouafpeaYr+WQpuaciemBjumVt+eahOihjFxyXG4gIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJylcclxuICBsaW5lcy5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4ge1xyXG4gICAgaWYgKGxpbmUubGVuZ3RoID4gMjAwICYmICFsaW5lLnN0YXJ0c1dpdGgoJ2BgYCcpKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgIGZpZWxkOiBgbGluZV8ke2luZGV4ICsgMX1gLFxyXG4gICAgICAgIG1lc3NhZ2U6IGDnrKwgJHtpbmRleCArIDF9IOihjOmBjumVt++8jOW7uuitsOaLhuWIhuS7peaPkOWNh+WPr+iugOaAp2AsXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfSlcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgZXJyb3JzLFxyXG4gICAgd2FybmluZ3MsXHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJSRVFVSVJFRF9QRVJTT05BX1NFQ1RJT05TIiwidmFsaWRhdGVQZXJzb25hIiwiY29udGVudCIsImVycm9ycyIsIndhcm5pbmdzIiwibGVuZ3RoIiwicHVzaCIsImZpZWxkIiwibWVzc2FnZSIsImNvZGUiLCJtaXNzaW5nU2VjdGlvbnMiLCJmaWx0ZXIiLCJzZWN0aW9uIiwiaW5jbHVkZXMiLCJqb2luIiwiZm9yRWFjaCIsInNlY3Rpb25SZWdleCIsIlJlZ0V4cCIsIm1hdGNoIiwidHJpbSIsInN1Z2dlc3Rpb24iLCJzY29yZSIsImNhbGN1bGF0ZVBlcnNvbmFTY29yZSIsInZhbGlkIiwiaGFzQWxsU2VjdGlvbnMiLCJldmVyeSIsIk1hdGgiLCJtYXgiLCJtaW4iLCJ2YWxpZGF0ZUZBUSIsIml0ZW0iLCJxdWVzdGlvbiIsImFuc3dlciIsImtleXdvcmRzIiwidGFncyIsImNhbGN1bGF0ZUZBUVNjb3JlIiwidmFsaWRhdGVLUEkiLCJuYW1lIiwibmFtZVBhdHRlcm4iLCJ0ZXN0IiwiZGVmaW5pdGlvbiIsImNhbGN1bGF0aW9uIiwiaGFzU1FMIiwidG9VcHBlckNhc2UiLCJkYXRhU291cmNlIiwib3duZXIiLCJjYWxjdWxhdGVLUElTY29yZSIsInZhbGlkYXRlRGVjaXNpb25Mb2ciLCJwcm9qZWN0TmFtZSIsImRhdGUiLCJkZWNpc2lvbk1ha2VycyIsImJhY2tncm91bmQiLCJvcHRpb25zIiwib3B0aW9uIiwiaW5kZXgiLCJwcm9zIiwiY29ucyIsImZpbmFsRGVjaXNpb24iLCJ2YWxpZGF0ZU1lZXRpbmdTdW1tYXJ5IiwidG9waWMiLCJ0aW1lIiwicGFydGljaXBhbnRzIiwib2JqZWN0aXZlcyIsImtleVBvaW50cyIsImFjdGlvbkl0ZW1zIiwiYWN0aW9uIiwiYXNzaWduZWUiLCJ0YXNrIiwiZGVhZGxpbmUiLCJ2YWxpZGF0ZU1hcmtkb3duRm9ybWF0Iiwic3RhcnRzV2l0aCIsImxpbmVzIiwic3BsaXQiLCJsaW5lIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/knowledge/validator.ts\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fknowledge%2Fpersona%2Froute&page=%2Fapi%2Fknowledge%2Fpersona%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fknowledge%2Fpersona%2Froute.ts&appDir=C%3A%5Csmart-ai-avatar-agent%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Csmart-ai-avatar-agent&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fknowledge%2Fpersona%2Froute&page=%2Fapi%2Fknowledge%2Fpersona%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fknowledge%2Fpersona%2Froute.ts&appDir=C%3A%5Csmart-ai-avatar-agent%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Csmart-ai-avatar-agent&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var C_smart_ai_avatar_agent_app_api_knowledge_persona_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./app/api/knowledge/persona/route.ts */ \"(rsc)/./app/api/knowledge/persona/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/knowledge/persona/route\",\n        pathname: \"/api/knowledge/persona\",\n        filename: \"route\",\n        bundlePath: \"app/api/knowledge/persona/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"C:\\\\smart-ai-avatar-agent\\\\app\\\\api\\\\knowledge\\\\persona\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_smart_ai_avatar_agent_app_api_knowledge_persona_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/knowledge/persona/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZrbm93bGVkZ2UlMkZwZXJzb25hJTJGcm91dGUmcGFnZT0lMkZhcGklMkZrbm93bGVkZ2UlMkZwZXJzb25hJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGa25vd2xlZGdlJTJGcGVyc29uYSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDc21hcnQtYWktYXZhdGFyLWFnZW50JTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDc21hcnQtYWktYXZhdGFyLWFnZW50JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEJmlzR2xvYmFsTm90Rm91bmRFbmFibGVkPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZDtBQUNTO0FBQ087QUFDSztBQUNtQztBQUNqRDtBQUNPO0FBQ2Y7QUFDc0M7QUFDekI7QUFDTTtBQUNDO0FBQ2hCO0FBQzRCO0FBQzlGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELHdCQUF3QixNQUF1QztBQUMvRDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNE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O0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOLDZCQUE2Qiw2RkFBZTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNkVBQVk7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0IHsgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBub3JtYWxpemVBcHBQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9hcHAtcGF0aHNcIjtcbmltcG9ydCB7IE5vZGVOZXh0UmVxdWVzdCwgTm9kZU5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Jhc2UtaHR0cC9ub2RlXCI7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdEFkYXB0ZXIsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvc3BlYy1leHRlbnNpb24vYWRhcHRlcnMvbmV4dC1yZXF1ZXN0XCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IHNlbmRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcmVzcG9uc2VcIjtcbmltcG9ydCB7IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycywgdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0Q2FjaGVDb250cm9sSGVhZGVyIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL2NhY2hlLWNvbnRyb2xcIjtcbmltcG9ydCB7IElORklOSVRFX0NBQ0hFLCBORVhUX0NBQ0hFX1RBR1NfSEVBREVSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBOb0ZhbGxiYWNrRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvbm8tZmFsbGJhY2stZXJyb3IuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IENhY2hlZFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3Jlc3BvbnNlLWNhY2hlXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcc21hcnQtYWktYXZhdGFyLWFnZW50XFxcXGFwcFxcXFxhcGlcXFxca25vd2xlZGdlXFxcXHBlcnNvbmFcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2tub3dsZWRnZS9wZXJzb25hL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkva25vd2xlZGdlL3BlcnNvbmFcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2tub3dsZWRnZS9wZXJzb25hL3JvdXRlXCJcbiAgICB9LFxuICAgIGRpc3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9ESVNUX0RJUiB8fCAnJyxcbiAgICByZWxhdGl2ZVByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJyxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXHNtYXJ0LWFpLWF2YXRhci1hZ2VudFxcXFxhcHBcXFxcYXBpXFxcXGtub3dsZWRnZVxcXFxwZXJzb25hXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xuICAgIHZhciBfbmV4dENvbmZpZ19leHBlcmltZW50YWw7XG4gICAgbGV0IHNyY1BhZ2UgPSBcIi9hcGkva25vd2xlZGdlL3BlcnNvbmEvcm91dGVcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfSBlbHNlIGlmIChzcmNQYWdlID09PSAnL2luZGV4Jykge1xuICAgICAgICAvLyB3ZSBhbHdheXMgbm9ybWFsaXplIC9pbmRleCBzcGVjaWZpY2FsbHlcbiAgICAgICAgc3JjUGFnZSA9ICcvJztcbiAgICB9XG4gICAgY29uc3QgbXVsdGlab25lRHJhZnRNb2RlID0gcHJvY2Vzcy5lbnYuX19ORVhUX01VTFRJX1pPTkVfRFJBRlRfTU9ERTtcbiAgICBjb25zdCBwcmVwYXJlUmVzdWx0ID0gYXdhaXQgcm91dGVNb2R1bGUucHJlcGFyZShyZXEsIHJlcywge1xuICAgICAgICBzcmNQYWdlLFxuICAgICAgICBtdWx0aVpvbmVEcmFmdE1vZGVcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHsgYnVpbGRJZCwgcGFyYW1zLCBuZXh0Q29uZmlnLCBpc0RyYWZ0TW9kZSwgcHJlcmVuZGVyTWFuaWZlc3QsIHJvdXRlclNlcnZlckNvbnRleHQsIGlzT25EZW1hbmRSZXZhbGlkYXRlLCByZXZhbGlkYXRlT25seUdlbmVyYXRlZCwgcmVzb2x2ZWRQYXRobmFtZSB9ID0gcHJlcGFyZVJlc3VsdDtcbiAgICBjb25zdCBub3JtYWxpemVkU3JjUGFnZSA9IG5vcm1hbGl6ZUFwcFBhdGgoc3JjUGFnZSk7XG4gICAgbGV0IGlzSXNyID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5keW5hbWljUm91dGVzW25vcm1hbGl6ZWRTcmNQYWdlXSB8fCBwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgIGlmIChpc0lzciAmJiAhaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgY29uc3QgaXNQcmVyZW5kZXJlZCA9IEJvb2xlYW4ocHJlcmVuZGVyTWFuaWZlc3Qucm91dGVzW3Jlc29sdmVkUGF0aG5hbWVdKTtcbiAgICAgICAgY29uc3QgcHJlcmVuZGVySW5mbyA9IHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdO1xuICAgICAgICBpZiAocHJlcmVuZGVySW5mbykge1xuICAgICAgICAgICAgaWYgKHByZXJlbmRlckluZm8uZmFsbGJhY2sgPT09IGZhbHNlICYmICFpc1ByZXJlbmRlcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vRmFsbGJhY2tFcnJvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGxldCBjYWNoZUtleSA9IG51bGw7XG4gICAgaWYgKGlzSXNyICYmICFyb3V0ZU1vZHVsZS5pc0RldiAmJiAhaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgY2FjaGVLZXkgPSByZXNvbHZlZFBhdGhuYW1lO1xuICAgICAgICAvLyBlbnN1cmUgL2luZGV4IGFuZCAvIGlzIG5vcm1hbGl6ZWQgdG8gb25lIGtleVxuICAgICAgICBjYWNoZUtleSA9IGNhY2hlS2V5ID09PSAnL2luZGV4JyA/ICcvJyA6IGNhY2hlS2V5O1xuICAgIH1cbiAgICBjb25zdCBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSA9IC8vIElmIHdlJ3JlIGluIGRldmVsb3BtZW50LCB3ZSBhbHdheXMgc3VwcG9ydCBkeW5hbWljIEhUTUxcbiAgICByb3V0ZU1vZHVsZS5pc0RldiA9PT0gdHJ1ZSB8fCAvLyBJZiB0aGlzIGlzIG5vdCBTU0cgb3IgZG9lcyBub3QgaGF2ZSBzdGF0aWMgcGF0aHMsIHRoZW4gaXQgc3VwcG9ydHNcbiAgICAvLyBkeW5hbWljIEhUTUwuXG4gICAgIWlzSXNyO1xuICAgIC8vIFRoaXMgaXMgYSByZXZhbGlkYXRpb24gcmVxdWVzdCBpZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWNcbiAgICAvLyBwYWdlIGFuZCBpdCBpcyBub3QgYmVpbmcgcmVzdW1lZCBmcm9tIGEgcG9zdHBvbmVkIHJlbmRlciBhbmRcbiAgICAvLyBpdCBpcyBub3QgYSBkeW5hbWljIFJTQyByZXF1ZXN0IHRoZW4gaXQgaXMgYSByZXZhbGlkYXRpb25cbiAgICAvLyByZXF1ZXN0LlxuICAgIGNvbnN0IGlzUmV2YWxpZGF0ZSA9IGlzSXNyICYmICFzdXBwb3J0c0R5bmFtaWNSZXNwb25zZTtcbiAgICBjb25zdCBtZXRob2QgPSByZXEubWV0aG9kIHx8ICdHRVQnO1xuICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgIGNvbnN0IGFjdGl2ZVNwYW4gPSB0cmFjZXIuZ2V0QWN0aXZlU2NvcGVTcGFuKCk7XG4gICAgY29uc3QgY29udGV4dCA9IHtcbiAgICAgICAgcGFyYW1zLFxuICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgcmVuZGVyT3B0czoge1xuICAgICAgICAgICAgZXhwZXJpbWVudGFsOiB7XG4gICAgICAgICAgICAgICAgY2FjaGVDb21wb25lbnRzOiBCb29sZWFuKG5leHRDb25maWcuZXhwZXJpbWVudGFsLmNhY2hlQ29tcG9uZW50cyksXG4gICAgICAgICAgICAgICAgYXV0aEludGVycnVwdHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuYXV0aEludGVycnVwdHMpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3VwcG9ydHNEeW5hbWljUmVzcG9uc2UsXG4gICAgICAgICAgICBpbmNyZW1lbnRhbENhY2hlOiBnZXRSZXF1ZXN0TWV0YShyZXEsICdpbmNyZW1lbnRhbENhY2hlJyksXG4gICAgICAgICAgICBjYWNoZUxpZmVQcm9maWxlczogKF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbCA9IG5leHRDb25maWcuZXhwZXJpbWVudGFsKSA9PSBudWxsID8gdm9pZCAwIDogX25leHRDb25maWdfZXhwZXJpbWVudGFsLmNhY2hlTGlmZSxcbiAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgIHdhaXRVbnRpbDogY3R4LndhaXRVbnRpbCxcbiAgICAgICAgICAgIG9uQ2xvc2U6IChjYik9PntcbiAgICAgICAgICAgICAgICByZXMub24oJ2Nsb3NlJywgY2IpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uQWZ0ZXJUYXNrRXJyb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIG9uSW5zdHJ1bWVudGF0aW9uUmVxdWVzdEVycm9yOiAoZXJyb3IsIF9yZXF1ZXN0LCBlcnJvckNvbnRleHQpPT5yb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVycm9yLCBlcnJvckNvbnRleHQsIHJvdXRlclNlcnZlckNvbnRleHQpXG4gICAgICAgIH0sXG4gICAgICAgIHNoYXJlZENvbnRleHQ6IHtcbiAgICAgICAgICAgIGJ1aWxkSWRcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgbm9kZU5leHRSZXEgPSBuZXcgTm9kZU5leHRSZXF1ZXN0KHJlcSk7XG4gICAgY29uc3Qgbm9kZU5leHRSZXMgPSBuZXcgTm9kZU5leHRSZXNwb25zZShyZXMpO1xuICAgIGNvbnN0IG5leHRSZXEgPSBOZXh0UmVxdWVzdEFkYXB0ZXIuZnJvbU5vZGVOZXh0UmVxdWVzdChub2RlTmV4dFJlcSwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZShyZXMpKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+e1xuICAgICAgICAgICAgcmV0dXJuIHJvdXRlTW9kdWxlLmhhbmRsZShuZXh0UmVxLCBjb250ZXh0KS5maW5hbGx5KCgpPT57XG4gICAgICAgICAgICAgICAgaWYgKCFzcGFuKSByZXR1cm47XG4gICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgJ2h0dHAuc3RhdHVzX2NvZGUnOiByZXMuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgJ25leHQucnNjJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByb290U3BhbkF0dHJpYnV0ZXMgPSB0cmFjZXIuZ2V0Um9vdFNwYW5BdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgLy8gV2Ugd2VyZSB1bmFibGUgdG8gZ2V0IGF0dHJpYnV0ZXMsIHByb2JhYmx5IE9URUwgaXMgbm90IGVuYWJsZWRcbiAgICAgICAgICAgICAgICBpZiAoIXJvb3RTcGFuQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpICE9PSBCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVW5leHBlY3RlZCByb290IHNwYW4gdHlwZSAnJHtyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpfScuIFBsZWFzZSByZXBvcnQgdGhpcyBOZXh0LmpzIGlzc3VlIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvbmV4dC5qc2ApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJvdXRlID0gcm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5yb3V0ZScpO1xuICAgICAgICAgICAgICAgIGlmIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gYCR7bWV0aG9kfSAke3JvdXRlfWA7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnNwYW5fbmFtZSc6IG5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShuYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUoYCR7bWV0aG9kfSAke3JlcS51cmx9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGhhbmRsZVJlc3BvbnNlID0gYXN5bmMgKGN1cnJlbnRTcGFuKT0+e1xuICAgICAgICAgICAgdmFyIF9jYWNoZUVudHJ5X3ZhbHVlO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VHZW5lcmF0b3IgPSBhc3luYyAoeyBwcmV2aW91c0NhY2hlRW50cnkgfSk9PntcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykgJiYgaXNPbkRlbWFuZFJldmFsaWRhdGUgJiYgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQgJiYgIXByZXZpb3VzQ2FjaGVFbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvbi1kZW1hbmQgcmV2YWxpZGF0ZSBhbHdheXMgc2V0cyB0aGlzIGhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcigneC1uZXh0anMtY2FjaGUnLCAnUkVWQUxJREFURUQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5lbmQoJ1RoaXMgcGFnZSBjb3VsZCBub3QgYmUgZm91bmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaW52b2tlUm91dGVNb2R1bGUoY3VycmVudFNwYW4pO1xuICAgICAgICAgICAgICAgICAgICByZXEuZmV0Y2hNZXRyaWNzID0gY29udGV4dC5yZW5kZXJPcHRzLmZldGNoTWV0cmljcztcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBlbmRpbmdXYWl0VW50aWwgPSBjb250ZXh0LnJlbmRlck9wdHMucGVuZGluZ1dhaXRVbnRpbDtcbiAgICAgICAgICAgICAgICAgICAgLy8gQXR0ZW1wdCB1c2luZyBwcm92aWRlZCB3YWl0VW50aWwgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0J3Mgbm90IHdlIGZhbGxiYWNrIHRvIHNlbmRSZXNwb25zZSdzIGhhbmRsaW5nXG4gICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nV2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3R4LndhaXRVbnRpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC53YWl0VW50aWwocGVuZGluZ1dhaXRVbnRpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1dhaXRVbnRpbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWNoZVRhZ3MgPSBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkVGFncztcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHJlcXVlc3QgaXMgZm9yIGEgc3RhdGljIHJlc3BvbnNlLCB3ZSBjYW4gY2FjaGUgaXQgc28gbG9uZ1xuICAgICAgICAgICAgICAgICAgICAvLyBhcyBpdCdzIG5vdCBlZGdlLlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNJc3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3B5IHRoZSBoZWFkZXJzIGZyb20gdGhlIHJlc3BvbnNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHRvTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMocmVzcG9uc2UuaGVhZGVycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGVUYWdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1tORVhUX0NBQ0hFX1RBR1NfSEVBREVSXSA9IGNhY2hlVGFncztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGVhZGVyc1snY29udGVudC10eXBlJ10gJiYgYmxvYi50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1snY29udGVudC10eXBlJ10gPSBibG9iLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXZhbGlkYXRlID0gdHlwZW9mIGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZSA+PSBJTkZJTklURV9DQUNIRSA/IGZhbHNlIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleHBpcmUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZSA9PT0gJ3VuZGVmaW5lZCcgfHwgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZSA+PSBJTkZJTklURV9DQUNIRSA/IHVuZGVmaW5lZCA6IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRFeHBpcmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGNhY2hlIGVudHJ5IGZvciB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib2R5OiBCdWZmZXIuZnJvbShhd2FpdCBibG9iLmFycmF5QnVmZmVyKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZUNvbnRyb2w6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZUVudHJ5O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VuZCByZXNwb25zZSB3aXRob3V0IGNhY2hpbmcgaWYgbm90IElTUlxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgcmVzcG9uc2UsIGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYSBiYWNrZ3JvdW5kIHJldmFsaWRhdGUgd2UgbmVlZCB0byByZXBvcnRcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHJlcXVlc3QgZXJyb3IgaGVyZSBhcyBpdCB3b24ndCBiZSBidWJibGVkXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c0NhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZpb3VzQ2FjaGVFbnRyeS5pc1N0YWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCByb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVyciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlcktpbmQ6ICdBcHAgUm91dGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVBhdGg6IHNyY1BhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVUeXBlOiAncm91dGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGVSZWFzb246IGdldFJldmFsaWRhdGVSZWFzb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1JldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHJvdXRlclNlcnZlckNvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgY2FjaGVFbnRyeSA9IGF3YWl0IHJvdXRlTW9kdWxlLmhhbmRsZVJlc3BvbnNlKHtcbiAgICAgICAgICAgICAgICByZXEsXG4gICAgICAgICAgICAgICAgbmV4dENvbmZpZyxcbiAgICAgICAgICAgICAgICBjYWNoZUtleSxcbiAgICAgICAgICAgICAgICByb3V0ZUtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgICAgICAgICAgaXNGYWxsYmFjazogZmFsc2UsXG4gICAgICAgICAgICAgICAgcHJlcmVuZGVyTWFuaWZlc3QsXG4gICAgICAgICAgICAgICAgaXNSb3V0ZVBQUkVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlR2VuZXJhdG9yLFxuICAgICAgICAgICAgICAgIHdhaXRVbnRpbDogY3R4LndhaXRVbnRpbFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyB3ZSBkb24ndCBjcmVhdGUgYSBjYWNoZUVudHJ5IGZvciBJU1JcbiAgICAgICAgICAgIGlmICghaXNJc3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoY2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogKF9jYWNoZUVudHJ5X3ZhbHVlID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlLmtpbmQpICE9PSBDYWNoZWRSb3V0ZUtpbmQuQVBQX1JPVVRFKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9jYWNoZUVudHJ5X3ZhbHVlMTtcbiAgICAgICAgICAgICAgICB0aHJvdyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3IEVycm9yKGBJbnZhcmlhbnQ6IGFwcC1yb3V0ZSByZWNlaXZlZCBpbnZhbGlkIGNhY2hlIGVudHJ5ICR7Y2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogKF9jYWNoZUVudHJ5X3ZhbHVlMSA9IGNhY2hlRW50cnkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfY2FjaGVFbnRyeV92YWx1ZTEua2luZH1gKSwgXCJfX05FWFRfRVJST1JfQ09ERVwiLCB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBcIkU3MDFcIixcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcigneC1uZXh0anMtY2FjaGUnLCBpc09uRGVtYW5kUmV2YWxpZGF0ZSA/ICdSRVZBTElEQVRFRCcgOiBjYWNoZUVudHJ5LmlzTWlzcyA/ICdNSVNTJyA6IGNhY2hlRW50cnkuaXNTdGFsZSA/ICdTVEFMRScgOiAnSElUJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBEcmFmdCBtb2RlIHNob3VsZCBuZXZlciBiZSBjYWNoZWRcbiAgICAgICAgICAgIGlmIChpc0RyYWZ0TW9kZSkge1xuICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ0NhY2hlLUNvbnRyb2wnLCAncHJpdmF0ZSwgbm8tY2FjaGUsIG5vLXN0b3JlLCBtYXgtYWdlPTAsIG11c3QtcmV2YWxpZGF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhjYWNoZUVudHJ5LnZhbHVlLmhlYWRlcnMpO1xuICAgICAgICAgICAgaWYgKCEoZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc0lzcikpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLmRlbGV0ZShORVhUX0NBQ0hFX1RBR1NfSEVBREVSKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIGNhY2hlIGNvbnRyb2wgaXMgYWxyZWFkeSBzZXQgb24gdGhlIHJlc3BvbnNlIHdlIGRvbid0XG4gICAgICAgICAgICAvLyBvdmVycmlkZSBpdCB0byBhbGxvdyB1c2VycyB0byBjdXN0b21pemUgaXQgdmlhIG5leHQuY29uZmlnXG4gICAgICAgICAgICBpZiAoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wgJiYgIXJlcy5nZXRIZWFkZXIoJ0NhY2hlLUNvbnRyb2wnKSAmJiAhaGVhZGVycy5nZXQoJ0NhY2hlLUNvbnRyb2wnKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuc2V0KCdDYWNoZS1Db250cm9sJywgZ2V0Q2FjaGVDb250cm9sSGVhZGVyKGNhY2hlRW50cnkuY2FjaGVDb250cm9sKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCBuZXcgUmVzcG9uc2UoY2FjaGVFbnRyeS52YWx1ZS5ib2R5LCB7XG4gICAgICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGNhY2hlRW50cnkudmFsdWUuc3RhdHVzIHx8IDIwMFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIC8vIFRPRE86IGFjdGl2ZVNwYW4gY29kZSBwYXRoIGlzIGZvciB3aGVuIHdyYXBwZWQgYnlcbiAgICAgICAgLy8gbmV4dC1zZXJ2ZXIgY2FuIGJlIHJlbW92ZWQgd2hlbiB0aGlzIGlzIG5vIGxvbmdlciB1c2VkXG4gICAgICAgIGlmIChhY3RpdmVTcGFuKSB7XG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVSZXNwb25zZShhY3RpdmVTcGFuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRyYWNlci53aXRoUHJvcGFnYXRlZENvbnRleHQocmVxLmhlYWRlcnMsICgpPT50cmFjZXIudHJhY2UoQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCwge1xuICAgICAgICAgICAgICAgICAgICBzcGFuTmFtZTogYCR7bWV0aG9kfSAke3JlcS51cmx9YCxcbiAgICAgICAgICAgICAgICAgICAga2luZDogU3BhbktpbmQuU0VSVkVSLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5tZXRob2QnOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC50YXJnZXQnOiByZXEudXJsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBoYW5kbGVSZXNwb25zZSkpO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGlmICghKGVyciBpbnN0YW5jZW9mIE5vRmFsbGJhY2tFcnJvcikpIHtcbiAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogbm9ybWFsaXplZFNyY1BhZ2UsXG4gICAgICAgICAgICAgICAgcm91dGVUeXBlOiAncm91dGUnLFxuICAgICAgICAgICAgICAgIHJldmFsaWRhdGVSZWFzb246IGdldFJldmFsaWRhdGVSZWFzb24oe1xuICAgICAgICAgICAgICAgICAgICBpc1JldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIHJldGhyb3cgc28gdGhhdCB3ZSBjYW4gaGFuZGxlIHNlcnZpbmcgZXJyb3IgcGFnZVxuICAgICAgICAvLyBJZiB0aGlzIGlzIGR1cmluZyBzdGF0aWMgZ2VuZXJhdGlvbiwgdGhyb3cgdGhlIGVycm9yIGFnYWluLlxuICAgICAgICBpZiAoaXNJc3IpIHRocm93IGVycjtcbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBzZW5kIGEgNTAwIHJlc3BvbnNlLlxuICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCBuZXcgUmVzcG9uc2UobnVsbCwge1xuICAgICAgICAgICAgc3RhdHVzOiA1MDBcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fknowledge%2Fpersona%2Froute&page=%2Fapi%2Fknowledge%2Fpersona%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fknowledge%2Fpersona%2Froute.ts&appDir=C%3A%5Csmart-ai-avatar-agent%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Csmart-ai-avatar-agent&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fknowledge%2Fpersona%2Froute&page=%2Fapi%2Fknowledge%2Fpersona%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fknowledge%2Fpersona%2Froute.ts&appDir=C%3A%5Csmart-ai-avatar-agent%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Csmart-ai-avatar-agent&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();